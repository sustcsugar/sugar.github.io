#数字电路 #STA #仿真
# 静态时序分析 STA static time analysis
## 一、概述
静态时序分析（ static timing analysis,STA）是分析、调试并确认一个门级系统设计时序性能的比较彻底的方法。

在门级电路设计过程中，为得到一个最佳的电路设计，在结构逻辑、电路布局布线等方面，时序分析起着关键性的作用。静态时序分析既要检验门级电路的最大延迟、以保证电路在指定的频率下能够满足**建立时间**的要求，同时又要检验门级电路的最小延迟、以满足**保持时间**的需求。芯片的设计只有通过了静态时序分析才能真正完成，甚至在从逻辑综合开始后的每一个设计步骤的结果都需要满足或部分满足时序的要求。

**作用**：静态时序分析是大规模集成电路设计中非常重要的一个环节，它能验证设计在时序上的正确性，并决定设计是否能够在要求的工作频率下运行。
## 二、基本概念
### 固定参数
1. launch edge: 第一级寄存器数据变化的时钟边沿， 时序分析的起点
2. latch edge：  
### 时钟特性
1. 时钟周期


3. 时钟占空比


5. 时钟转换时间
	> 时钟在不同电平转换时需要的时间

	![[Pasted image 20201115002801.png]]

4. 时钟延迟
	> 定义为从**时钟源**输出口->**时序单元**输入口的传播时间
	
	![[Pasted image 20201115002834.png]]


7. 时钟偏斜 clk skew
	> 时钟信号需要提供整个电路的时序单元，因此时钟线非常长，构成分布式RC网络。
	**时钟偏移**是指同一个时钟源到达**不同的寄存器**之间的时间差值，可分为正偏移和负偏移。
	计算方法：$T_{skew} = T_{clk2} - T_{clk1}$
	
	 ![[Pasted image 20201115003054.png]]
	
1. 时钟抖动
	

### 扇入、扇出


## 三、静态时序分析的优缺点
### 优点
1. 执行速度快
2. 不需要测试向量
3. 测试覆盖率广，对于有时序路径的时序电路，测试覆盖率近乎达到100%
4. 能够完成动态分析所不能实现的复杂分析
	1. 最大最小延迟路径分析
	2. 建立时间保持时间的分析
	3. 时钟信号质量分析
	4. 报告不满足时序约束的路径
	5. 。。。
### 缺点
1. 不能验证功能
2. 只能验证同步时序电路，对于含有较多异步电路的设计，需要使用门机动态仿真来实现
3. 不能分析设计中的特殊路径，如：多周期路径、非正常路径、多时钟分配关系等等。这类路径需要手动通过时序约束文件来指导静态时序分析。

## 四 静态时序分析的基本方法
### 时序图
静态时序分析中,数字逻辑电路首先转换成时序图的形式,再基于时序图计算**路径延迟的总和**,如果所以的路径都满足时许约束和规范,那么就认为设计满足时序约束规范.

![[Pasted image 20201115151437.png]]
### 时序分析策略
1. 基于路径的时序分析策略
	基于时序图找到**起点**->**终点**的所有路径进行时序分析.
	特点: 能够**独立精确**的计算出每条时序路径,但是随着设计规模的增加,这种分析策略需要基于单元延时和连线延时等诸多信息来计算所有时许路径,会怎加计算量和运行时间.
	主流的时序分析工具一般是基于该分析策略的 如PrimeTime
	![[Pasted image 20201115151910.png]]
1. 基于模块的时序分析策略
	基于时序图,找到从起点到终点到所有路径,只对该路径下延迟最严重的节点进行计算.
	![[Pasted image 20201115152642.png]]
	
### 时序路径延时的计算方法
1. 组合逻辑之间的路径延时计算方法

	逻辑路径的延时=**逻辑门**延时+**信号线**延时
	![[Pasted image 20201115153449.png]]
1. 时序逻辑之间的路径延时计算方法
	**逻辑门**延时+**信号线**延时
	但是需要分别计算时序逻辑单元的**时钟信号路径延时** & **数据信号的路径延时**
	![[Pasted image 20201115153632.png]]
	
### 时序路径的分析方法
1. 建立时间分析 setup time check
	**建立时间** : 在时钟捕获信号有效沿到来之前,数据信号必须提前达到稳定状态的时间
	建立时间的分析是为了验证**时序路径中**时钟与信号的时序关系,是否满足终止点时序单元**建立时间**的要求
	![[Pasted image 20201115154349.png]]
	![[Pasted image 20201115154401.png]]
1. 保持时间分析 hold time check
	**保持时间**: 始终有效沿到来之后,数据仍要保持稳定的时间
	保持时间的分析是为了验证**时序路径中**时钟与信号的时序关系,是否满足终止点时序单元**保持时间**的要求
	![[Pasted image 20201115154349.png]]
	![[Pasted image 20201115155119.png]]
	
### 时序路径的分析模式
1. 最快路径
	传播延时计算中, 调用最快工艺参数的路径.分为最快时钟路径和最快数据路径
1. 最慢路径
	传播延时计算中, 调用最慢工艺参数的路径.分为最慢时钟路径和最慢数据路径
	
#### 单一分析模式

#### 最好-最坏分析模式

#### 芯片变化相关分析模式


### 时序优化
解决时序收敛问题是STA中的主要工作. 可以通过自动和手动方式完成物理上和时序上的优化工作.
优化的时序类型分为:建立时间\\保持时间\\时序设计规则三种
#### 基本方法
1. 优化建立时间和时序设计规则的基本方法
	1. **改变单元位置**:
		不合理的单元物理位置会使信号线过长导致线负载和线延时变大,影响时序收敛.
		![[Pasted image 20201115160702.png]]![[Pasted image 20201115160708.png]]
		
	1. **改变单元大小**:
		标准单元库提供了多种驱动能力的单元. 在相同激励和负载的情况下,其延时和驱动能力近似成线性关系. 因此把负载过大导致的延时恶化的单元,调整为驱动能力更大的同类型单元,可以有效的改善时序性能.
		
	1. 插入缓冲技术
		![[Pasted image 20201115161140.png]]
	1. 删除缓冲单元
		如果设计中存在插入缓冲器单元不合理的情况，那么可以通过删除导致降低时序性能的缓冲单元，来达到优化时序性能的目的。
		
	1. 重分配负载
		通过插入缓冲单元,重新分扇出负载来达到优化时序的目的
		![[Pasted image 20201115161332.png]]
		
1. 优化保持时间基本方法
优化保持时间的方法相对简单，主要是**插入延时单元**（ delay cell）的方法。由于延时单元具有相对较长的单元本征延时的特点，通过插入延时单元来显著增加时序路径整体延时来达到满足建立时间要求的目的。

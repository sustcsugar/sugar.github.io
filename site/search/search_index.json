{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"welcome to sugar's page 1. \u8bf4\u660e \u8bb0\u5f55\u4e00\u4e0b\u81ea\u5df1\u7684\u5b66\u4e60\u7b14\u8bb0\u603b\u7ed3\u548c\u5fc3\u5f97, \u7528\u4e8e\u968f\u65f6\u7ffb\u9605\u5b66\u4e60 2. \u5b66\u4e60\u7ecf\u5386 \u7b14\u8005\u76ee\u524d\u4e3a\u5357\u65b9\u67d0\u5c0f\u6e14\u6751\u5927\u5b66\u7684\u7814\u7a76\u751f\u5728\u8bfb\u5b66\u751f 3. \u7814\u7a76\u65b9\u5411 3.1 IC\u8bbe\u8ba1 \u4e3b\u8981\u7814\u7a76\u65b9\u5411\u4e3a \u4f20\u7edf\u56fe\u50cf\u5904\u7406 \u7b97\u6cd5,\u540e\u7eed\u4f1a\u7814\u7a76\u673a\u5668\u5b66\u4e60\u7684\u56fe\u50cf\u5904\u7406\u7b97\u6cd5. \u6570\u5b57\u96c6\u6210\u7535\u8def\u8bbe\u8ba1 , ASIC\u524d\u540e\u7aef\u548cFPGA\u5747\u6709\u6240\u6d89\u730e. \u8fd1\u671f\u5728\u5b66\u4e60\u7814\u7a76 ISP \u76f8\u5173\u7684\u4e00\u4e9b\u5de5\u4f5c. \u7b80\u5355\u603b\u7ebf: I2C , SPI . \u6709\u5173\u603b\u7ebf\u7684\u7814\u7a76\u5b66\u4e60: AMBA , PVCI \u7b49. PCIE,HDMI,MIPI\u6709\u673a\u4f1a\u8981\u5b66\u4e60. 3.2 IC\u6d4b\u8bd5 UVM\u6b63\u5728\u5b66\u4e60 SystemVerilog\u6b63\u5728\u5b66\u4e60 3.3 EDA\u5de5\u5177 \u5b66\u4e60\u4f7f\u7528\u5168\u5957 \u524d\u540e\u7aef \u8bbe\u8ba1\u6d41\u7a0b\u4ee5\u53ca\u76f8\u5173\u7684EDA\u5de5\u5177. \u4eceDC\u7efc\u5408\u5230\u6700\u7ec8tapout\u5168\u6d41\u7a0b\u8bbe\u8ba1. \u5168\u5b9a\u5236\u7535\u8defIC\u8bbe\u8ba1, K\u5e93(character library)\u5168\u81ea\u52a8\u5316\u811a\u672c\u73af\u5883\u642d\u5efa: \u96c6\u6210\u7535\u8def\u8bbe\u8ba1\u4eff\u771f\u52a0\u901f, \u5e15\u62c9\u4e01\u4f7f\u7528 . 3.4 \u8ba1\u7b97\u673a\u77e5\u8bc6 python\u4e3a\u4e3b\u8981\u7f16\u5199\u8bed\u8a00,\u505a\u4e00\u4e9b\u56fe\u50cf\u5904\u7406\u7b97\u6cd5\u9a8c\u8bc1,\u81ea\u52a8\u5316\u811a\u672c,\u5206\u6790\u65e5\u5fd7log\u7b49. bash\u811a\u672c\u5b66\u4e60 Makefile\u811a\u672c,\u7528\u6765\u81ea\u52a8\u5316\u7f16\u8bd1\u4eff\u771f. VIM\u4e3a\u4e3b\u8981\u7f16\u8f91\u5668,\u6298\u817eVIM\u7684\u914d\u7f6e\u4ee5\u53ca\u811a\u672c. 3.5 \u4e1a\u4f59\u7814\u7a76 \u611f\u5174\u8da3\u7684\u65b9\u5411\u6709 web\u4ee5\u53ca\u4eba\u5de5\u667a\u80fd . \u5e73\u65f6\u559c\u6b22\u6298\u817e\u4e00\u4e9b\u670d\u52a1\u5668\u76f8\u5173\u7684\u4e1c\u897f, \u5305\u62ec \u7f51\u7ad9\u642d\u5efa , \u670d\u52a1\u5668\u642d\u5efa\u8fd0\u7ef4 , docker \u7b49. 4. KPM \u77e5\u8bc6\u7ba1\u7406\u4f7f\u7528\u8fc7OneNote, Notion, Typora, TiddlyWiki, \u601d\u6e90\u7b14\u8bb0\u7b49, \u6700\u540e\u5b9a\u5c45\u5728Obsidian. \u4f7f\u7528obsidian\u8fdb\u884c\u77e5\u8bc6\u7684\u6536\u96c6,\u8fc7\u6ee4,\u603b\u7ed3\u4ee5\u53ca\u65e5\u7a0b\u7ba1\u7406, \u6700\u540e\u8f93\u51fa\u6587\u7ae0publish\u5230\u6b64\u7f51\u7ad9\u4e0a\u7528\u4e8e\u968f\u65f6\u968f\u5730\u7684\u67e5\u9605\u5b66\u4e60\u548c\u590d\u4e60.","title":"welcome to sugar's page"},{"location":"#welcome-to-sugars-page","text":"","title":"welcome to sugar's page"},{"location":"#1","text":"\u8bb0\u5f55\u4e00\u4e0b\u81ea\u5df1\u7684\u5b66\u4e60\u7b14\u8bb0\u603b\u7ed3\u548c\u5fc3\u5f97, \u7528\u4e8e\u968f\u65f6\u7ffb\u9605\u5b66\u4e60","title":"1. \u8bf4\u660e"},{"location":"#2","text":"\u7b14\u8005\u76ee\u524d\u4e3a\u5357\u65b9\u67d0\u5c0f\u6e14\u6751\u5927\u5b66\u7684\u7814\u7a76\u751f\u5728\u8bfb\u5b66\u751f","title":"2. \u5b66\u4e60\u7ecf\u5386"},{"location":"#3","text":"","title":"3. \u7814\u7a76\u65b9\u5411"},{"location":"#31-ic","text":"\u4e3b\u8981\u7814\u7a76\u65b9\u5411\u4e3a \u4f20\u7edf\u56fe\u50cf\u5904\u7406 \u7b97\u6cd5,\u540e\u7eed\u4f1a\u7814\u7a76\u673a\u5668\u5b66\u4e60\u7684\u56fe\u50cf\u5904\u7406\u7b97\u6cd5. \u6570\u5b57\u96c6\u6210\u7535\u8def\u8bbe\u8ba1 , ASIC\u524d\u540e\u7aef\u548cFPGA\u5747\u6709\u6240\u6d89\u730e. \u8fd1\u671f\u5728\u5b66\u4e60\u7814\u7a76 ISP \u76f8\u5173\u7684\u4e00\u4e9b\u5de5\u4f5c. \u7b80\u5355\u603b\u7ebf: I2C , SPI . \u6709\u5173\u603b\u7ebf\u7684\u7814\u7a76\u5b66\u4e60: AMBA , PVCI \u7b49. PCIE,HDMI,MIPI\u6709\u673a\u4f1a\u8981\u5b66\u4e60.","title":"3.1 IC\u8bbe\u8ba1"},{"location":"#32-ic","text":"UVM\u6b63\u5728\u5b66\u4e60 SystemVerilog\u6b63\u5728\u5b66\u4e60","title":"3.2 IC\u6d4b\u8bd5"},{"location":"#33-eda","text":"\u5b66\u4e60\u4f7f\u7528\u5168\u5957 \u524d\u540e\u7aef \u8bbe\u8ba1\u6d41\u7a0b\u4ee5\u53ca\u76f8\u5173\u7684EDA\u5de5\u5177. \u4eceDC\u7efc\u5408\u5230\u6700\u7ec8tapout\u5168\u6d41\u7a0b\u8bbe\u8ba1. \u5168\u5b9a\u5236\u7535\u8defIC\u8bbe\u8ba1, K\u5e93(character library)\u5168\u81ea\u52a8\u5316\u811a\u672c\u73af\u5883\u642d\u5efa: \u96c6\u6210\u7535\u8def\u8bbe\u8ba1\u4eff\u771f\u52a0\u901f, \u5e15\u62c9\u4e01\u4f7f\u7528 .","title":"3.3 EDA\u5de5\u5177"},{"location":"#34","text":"python\u4e3a\u4e3b\u8981\u7f16\u5199\u8bed\u8a00,\u505a\u4e00\u4e9b\u56fe\u50cf\u5904\u7406\u7b97\u6cd5\u9a8c\u8bc1,\u81ea\u52a8\u5316\u811a\u672c,\u5206\u6790\u65e5\u5fd7log\u7b49. bash\u811a\u672c\u5b66\u4e60 Makefile\u811a\u672c,\u7528\u6765\u81ea\u52a8\u5316\u7f16\u8bd1\u4eff\u771f. VIM\u4e3a\u4e3b\u8981\u7f16\u8f91\u5668,\u6298\u817eVIM\u7684\u914d\u7f6e\u4ee5\u53ca\u811a\u672c.","title":"3.4 \u8ba1\u7b97\u673a\u77e5\u8bc6"},{"location":"#35","text":"\u611f\u5174\u8da3\u7684\u65b9\u5411\u6709 web\u4ee5\u53ca\u4eba\u5de5\u667a\u80fd . \u5e73\u65f6\u559c\u6b22\u6298\u817e\u4e00\u4e9b\u670d\u52a1\u5668\u76f8\u5173\u7684\u4e1c\u897f, \u5305\u62ec \u7f51\u7ad9\u642d\u5efa , \u670d\u52a1\u5668\u642d\u5efa\u8fd0\u7ef4 , docker \u7b49.","title":"3.5 \u4e1a\u4f59\u7814\u7a76"},{"location":"#4-kpm","text":"\u77e5\u8bc6\u7ba1\u7406\u4f7f\u7528\u8fc7OneNote, Notion, Typora, TiddlyWiki, \u601d\u6e90\u7b14\u8bb0\u7b49, \u6700\u540e\u5b9a\u5c45\u5728Obsidian. \u4f7f\u7528obsidian\u8fdb\u884c\u77e5\u8bc6\u7684\u6536\u96c6,\u8fc7\u6ee4,\u603b\u7ed3\u4ee5\u53ca\u65e5\u7a0b\u7ba1\u7406, \u6700\u540e\u8f93\u51fa\u6587\u7ae0publish\u5230\u6b64\u7f51\u7ad9\u4e0a\u7528\u4e8e\u968f\u65f6\u968f\u5730\u7684\u67e5\u9605\u5b66\u4e60\u548c\u590d\u4e60.","title":"4. KPM"},{"location":"IC-design/jpeg_decoder/","text":"\u4f5c\u8005: sugar \u8f6c\u8f7d\u8bf7\u8054\u7cfb\u4f5c\u8005(1144392179@qq.com),\u5e76\u8bf4\u660e\u51fa\u5904! \u6682\u65f6\u6ca1\u65f6\u95f4\u6574\u7406\u8be5\u90e8\u5206\u5185\u5bb9\uff0c\u5148\u5360\u4e2a\u5751\u3002 jpeg_encoder\u548cjpeg_decoder\u662f\u76f8\u5bf9\u590d\u6742\u7684\u7535\u8def\u8bbe\u8ba1\u65b9\u6848\uff0c\u6db5\u76d6\u4e86\u7b97\u6cd5\u3001\u7f16\u7801\u3001\u4ee5\u53ca\u9ad8\u6548\u7684\u7535\u8def\u8bbe\u8ba1\u65b9\u6848\uff0c\u53ef\u4ee5\u5f53\u4f5c\u4e00\u4e2a\u7ecf\u5178\u7684\u7535\u8def\u8bbe\u8ba1\u6a21\u578b\u6765\u5b66\u4e60\u3002 \u5176\u4e2d\u4f7f\u7528\u7684\u591a\u4e2a\u72b6\u6001\u673a\uff0c\u4ee5\u53ca\u6876\u5f62\u5bc4\u5b58\u5668\uff0c\u79fb\u4f4d\u5bc4\u5b58\u5668\u548c\u5fae\u5206\u5dee\u5206\u7b97\u6570\u8ba1\u7b97\u7535\u8def\u3002","title":"Jpeg decoder"},{"location":"bus/I2C/","text":"\u4f5c\u8005: sugar \u8f6c\u8f7d\u8bf7\u8054\u7cfb\u4f5c\u8005(1144392179@qq.com),\u5e76\u8bf4\u660e\u51fa\u5904! \u672c\u6587\u7531 \u7b80\u60a6 SimpRead \u8f6c\u7801\uff0c \u539f\u6587\u5730\u5740 blog.csdn.net \u80cc\u666f I\u00b2C \uff08 Inter-Integrated Circuit \uff09\uff0c\u4e2d\u6587\u5e94\u8be5\u53eb \u96c6\u6210\u7535\u8def\u603b\u7ebf \uff0c\u5b83\u662f\u4e00\u79cd \u4e32\u884c\u901a\u4fe1 \u603b\u7ebf\uff0c\u4f7f\u7528\u591a\u4e3b\u4ece\u67b6\u6784\uff0c\u662f\u7531\u98de\u5229\u6d66\u516c\u53f8\u5728 1980 \u5e74\u4ee3\u521d\u8bbe\u8ba1\u7684\uff0c\u65b9\u4fbf\u4e86\u4e3b\u677f\u3001\u5d4c\u5165\u5f0f\u7cfb\u7edf\u6216\u624b\u673a\u4e0e\u5468\u8fb9\u8bbe\u5907\u7ec4\u4ef6\u4e4b\u95f4\u7684\u901a\u8baf\u3002\u7531\u4e8e\u5176\u7b80\u5355\u6027\uff0c\u5b83\u88ab\u5e7f\u6cdb\u7528\u4e8e\u5fae\u63a7\u5236\u5668\u4e0e\u4f20\u611f\u5668\u9635\u5217\uff0c\u663e\u793a\u5668\uff0cIoT \u8bbe\u5907\uff0cEEPROM \u7b49\u4e4b\u95f4\u7684\u901a\u4fe1\u3002 I\u00b2C \u6700\u91cd\u8981\u7684\u529f\u80fd\u5305\u62ec\uff1a \u53ea\u9700\u8981\u4e24\u6761\u603b\u7ebf\uff1b \u6240\u6709\u7ec4\u4ef6\u4e4b\u95f4\u90fd\u5b58\u5728\u7b80\u5355\u7684\u4e3b / \u4ece\u5173\u7cfb\uff0c\u8fde\u63a5\u5230\u603b\u7ebf\u7684\u6bcf\u4e2a\u8bbe\u5907\u5747\u53ef\u901a\u8fc7\u552f\u4e00\u5730\u5740\u8fdb\u884c\u8f6f\u4ef6\u5bfb\u5740\uff1b I\u00b2C \u662f\u771f\u6b63\u7684\u591a\u4e3b\u8bbe\u5907\u603b\u7ebf\uff0c\u53ef\u63d0\u4f9b\u4ef2\u88c1\u548c\u51b2\u7a81\u68c0\u6d4b\uff1b \u4f20\u8f93\u901f\u5ea6\uff1b \u6807\u51c6\u6a21\u5f0f\uff1aStandard Mode = 100 Kbps \u5feb\u901f\u6a21\u5f0f\uff1aFast Mode = 400 Kbps \u9ad8\u901f\u6a21\u5f0f\uff1a High speed mode = 3.4 Mbps \u8d85\u5feb\u901f\u6a21\u5f0f\uff1a Ultra fast mode = 5 Mbps \u6700\u5927\u4e3b\u8bbe\u5907\u6570\uff1a\u65e0\u9650\u5236\uff1b \u6700\u5927\u4ece\u673a\u6570\uff1a\u7406\u8bba\u4e0a\u662f 127\uff1b \u4ee5\u4e0a\u662f I\u00b2C \u7684\u4e00\u4e9b\u91cd\u8981\u7279\u70b9\uff0c\u4e0b\u9762\u4f1a\u8fdb\u4e00\u6b65\u5bf9 I\u00b2C \u8fdb\u884c\u4ecb\u7ecd\u3002 \u786c\u4ef6\u5c42 I\u00b2C \u534f\u8bae\u4ec5\u9700\u8981\u4e00\u4e2a SDA \u548c SCL \u5f15\u811a\u3002SDA \u662f \u4e32\u884c\u6570\u636e\u7ebf\u7684 \u7f29\u5199\uff0c\u800c SCL \u662f \u4e32\u884c\u65f6\u949f\u7ebf\u7684 \u7f29\u5199\u3002\u8fd9\u4e24\u6761\u6570\u636e\u7ebf\u9700\u8981\u63a5\u4e0a\u62c9\u7535\u963b\u3002 \u8bbe\u5907\u95f4\u7684\u8fde\u63a5\u5982\u4e0b\u6240\u793a\uff1a \u4f7f\u7528 I\u00b2C\uff0c\u53ef\u4ee5\u5c06\u591a\u4e2a\u4ece\u673a\uff08 Slave \uff09\u8fde\u63a5\u5230\u5355\u4e2a\u4e3b\u8bbe\u5907\uff08 Master \uff09\uff0c\u5e76\u4e14\u8fd8\u53ef\u4ee5\u6709\u591a\u4e2a\u4e3b\u8bbe\u5907\uff08 Master \uff09\u63a7\u5236\u4e00\u4e2a\u6216\u591a\u4e2a\u4ece\u673a\uff08 Slave \uff09\u3002 \u5047\u5982\u5e0c\u671b\u6709\u591a\u4e2a\u5fae\u63a7\u5236\u5668\uff08 MCU \uff09\u5c06\u6570\u636e\u8bb0\u5f55\u5230\u5355\u4e2a\u5b58\u50a8\u5361\u6216\u5c06\u6587\u672c\u663e\u793a\u5230\u5355\u4e2a LCD \u65f6\uff0c\u8fd9\u4e2a\u529f\u80fd\u5c31\u975e\u5e38\u6709\u7528\u3002 I\u00b2C \u603b\u7ebf\uff08 SDA \uff0c SCL \uff09\u5185\u90e8\u90fd\u4f7f\u7528\u6f0f\u6781\u5f00\u8def\u9a71\u52a8\u5668\uff08\u5f00\u6f0f\u9a71\u52a8\uff09\uff0c\u56e0\u6b64 SDA \u548c SCL \u53ef\u4ee5\u88ab\u62c9\u4f4e\u4e3a\u4f4e\u7535\u5e73\uff0c\u4f46\u662f\u4e0d\u80fd\u88ab\u9a71\u52a8\u4e3a\u9ad8\u7535\u5e73 \uff0c\u6240\u4ee5\u6bcf\u6761\u7ebf\u4e0a\u90fd\u8981\u4f7f\u7528\u4e00\u4e2a\u4e0a\u62c9\u7535\u963b\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5c06\u5176\u4fdd\u6301\u5728\u9ad8\u7535\u5e73\uff1b \u4e0a \u62c9\u7535\u963b\u7684 \u503c\u53d6\u51b3\u4e8e\u8bb8\u591a\u56e0\u7d20\u3002 \u5fb7\u5dde\u4eea\u5668 TI \u5efa\u8bae \u4f7f\u7528\u4ee5\u4e0b\u516c\u5f0f\u6765\u8ba1\u7b97\u6b63\u786e\u7684\u4e0a\u62c9\u7535\u963b\u503c\uff1a $$ R_p(min)=\\cfrac{V_{DD}-V_{OL}(max)}{I_{OL}} $$ $$ R p ( m i n ) =\\cfrac{t_r}{0.8473xC_b} $$ \u5176\u4e2d $V_{OL}$\u662f\u903b\u8f91\u4f4e\u7535\u538b\uff1b $I_{OL}$\u662f\u903b\u8f91\u4f4e\u7535\u6d41\uff1b $t_r$\u662f\u4fe1\u53f7\u7684\u6700\u5927\u4e0a\u5347\u65f6\u95f4\uff1b $C_b$\u662f\u603b\u7ebf\uff08\u7535\u7ebf\uff09\u7535\u5bb9\uff1b \u5177\u4f53\u5982\u4e0b\u6240\u793a\uff1a \u4ece\u4e0a\u8868\u53ef\u77e5\uff0c\u4f7f\u7528 I2C \u8bbe\u5907\u5fc5\u987b\u5728 3 mA\u7684\u704c\u7535\u6d41\u4e0b\u5de5\u4f5c\uff0c \u8fd9\u91cc\u4e0d\u96be\u53d1\u73b0\u9700\u8981\u5728\u505a\u9009\u578b\u9700\u8981\u6ee1\u8db3\u51e0\u4e2a\u6761\u4ef6\uff1b \u704c\u7535\u6d41 \u6700\u5927\u503c\u4e3a 3 mA\uff1b \u53e6\u5916 I2C \u603b\u7ebf\u89c4\u8303\u548c\u7528\u6237\u624b\u518c\u8fd8\u4e3a\u4f4e\u7535\u5e73\u8f93\u51fa\u7535\u538b $V_{OL}$ \u8bbe\u7f6e\u4e86\u6700\u5927\u503c\u4e3a 0.4V $$R_p(min) = \\cfrac{VCC - 0.4V}{3mA}$$ \u6240\u4ee5\u6839\u636e\u4e0a\u8ff0\u516c\u5f0f\u53ef\u4ee5\u8ba1\u7b97\uff0c\u5bf9\u4e8e 5V \u7684\u7535\u6e90\uff0c\u6bcf\u4e2a\u4e0a\u62c9\u7535\u963b\u5fc5\u987b\u81f3\u5c11\u5177\u6709 1.53k\u03a9\uff0c\u800c\u5bf9\u4e8e 3.3V \u7684\u7535\u6e90\uff0c\u6bcf\u4e2a\u7535\u963b\u5fc5\u987b\u81f3\u5c11\u5177\u6709 967\u03a9\u3002 \u5982\u679c\u89c9\u5f97\u8ba1\u7b97\u7535\u963b\u503c\u6bd4\u8f83\u9ebb\u70e6\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 \u5178\u578b\u503c 4.7k\u03a9 \u3002 \u4e0a\u8ff0\u63a8\u5bfc\u8fc7\u7a0b\u53ef\u4ee5\u53c2\u8003 TI \u7684\u6587\u6863\u300aI2C Bus Pullup Resistor Calculation\u300b https://www.ti.com/lit/an/slva689/slva689.pdf \u6700\u7ec8\u5728\u8c03\u8bd5\u7684\u65f6\u5019\uff0c\u5f53\u6211\u4eec\u6d4b\u91cf SDA \u6216 SCL \u4fe1\u53f7\u5e76\u4e14\u903b\u8f91 LOW \u4e0a\u7684\u7535\u538b\u9ad8\u4e8e 0.4V \u65f6\uff0c\u6211\u4eec\u5c31\u77e5\u9053\u53ef\u4ee5\u77e5\u9053\u704c\u7535\u6d41\u592a\u9ad8\u4e86\uff1b \u5f53\u7136\uff0c\u8fd9\u5e76\u4e0d\u610f\u5473\u7740\u6bcf\u5f53\u704c\u7535\u6d41\u8d85\u8fc7 3mA \u65f6\uff0c\u8bbe\u5907\u5c31\u4f1a\u7acb\u5373\u505c\u6b62\u5de5\u4f5c\u3002\u4f46\u662f\uff0c\u5728\u64cd\u4f5c\u8d85\u51fa\u5176\u89c4\u683c\u7684\u8bbe\u5907\u65f6\uff0c\u5e94\u59cb\u7ec8\u5c0f\u5fc3\uff0c\u56e0\u4e3a\u5b83\u53ef\u80fd\u5bfc\u81f4\u901a\u4fe1\u6545\u969c\uff0c\u7f29\u77ed\u5176\u4f7f\u7528\u5bff\u547d\u751a\u81f3\u751a\u81f3\u6c38\u4e45\u635f\u574f\u8bbe\u5907\u3002 \u6570\u636e\u4f20\u8f93\u534f\u8bae \u4e3b\u8bbe\u5907\u548c\u4ece\u8bbe\u5907\u8fdb\u884c\u6570\u636e\u4f20\u8f93\u65f6\u9075\u5faa\u4ee5\u4e0b\u534f\u8bae\u683c\u5f0f\u3002\u6570\u636e\u901a\u8fc7\u4e00\u6761 SDA \u6570\u636e\u7ebf\u5728\u4e3b\u8bbe\u5907\u548c\u4ece\u8bbe\u5907\u4e4b\u95f4\u4f20\u8f93 0 \u548c 1 \u7684\u4e32\u884c\u6570\u636e\u3002\u4e32\u884c\u6570\u636e\u5e8f\u5217\u7684\u7ed3\u6784\u53ef\u4ee5\u5206\u4e3a\uff0c\u5f00\u59cb\u6761\u4ef6\uff0c\u5730\u5740\u4f4d\uff0c\u8bfb\u5199\u4f4d\uff0c\u5e94\u7b54\u4f4d\uff0c\u6570\u636e\u4f4d\uff0c\u505c\u6b62\u6761\u4ef6\uff0c\u5177\u4f53\u5982\u4e0b\u6240\u793a\uff1b \u5f00\u59cb\u6761\u4ef6 \u5f53\u4e3b\u8bbe\u5907\u51b3\u5b9a\u5f00\u59cb\u901a\u8baf\u65f6\uff0c\u9700\u8981\u53d1\u9001\u5f00\u59cb\u4fe1\u53f7\uff0c\u9700\u8981\u6267\u884c\u4ee5\u4e0b\u52a8\u4f5c\uff1b \u5148\u5c06 SDA \u7ebf\u4ece\u9ad8\u538b\u7535\u5e73\u5207\u6362\u5230\u4f4e\u538b\u7535\u5e73\uff1b \u7136\u540e\u5c06 SCL \u4ece\u9ad8\u7535\u5e73\u5207\u6362\u5230\u4f4e\u7535\u5e73\uff1b \u5728\u4e3b\u8bbe\u5907\u53d1\u9001 \u5f00\u59cb\u6761\u4ef6 \u4fe1\u53f7\u4e4b\u540e\uff0c\u6240\u6709\u4ece\u673a\u5373\u4f7f\u5904\u4e8e\u7761\u7720\u6a21\u5f0f\u4e5f\u5c06 \u53d8\u4e3a\u6d3b\u52a8\u72b6\u6001 \uff0c\u5e76 \u7b49\u5f85\u63a5\u6536\u5730\u5740\u4f4d \u3002 \u5177\u4f53\u5982\u4e0b\u56fe\u6240\u793a\uff1b \u5730\u5740\u4f4d \u901a\u5e38\u5730\u5740\u4f4d\u5360 7 \u4f4d\u6570\u636e\uff0c\u4e3b\u8bbe\u5907\u5982\u679c\u9700\u8981\u5411\u4ece\u673a\u53d1\u9001 / \u63a5\u6536\u6570\u636e\uff0c\u9996\u5148\u8981\u53d1\u9001\u5bf9\u5e94\u4ece\u673a\u7684\u5730\u5740\uff0c\u7136\u540e\u4f1a\u5339\u914d\u603b\u7ebf\u4e0a\u6302\u8f7d\u7684\u4ece\u673a\u7684\u5730\u5740\uff1b I2C \u8fd8\u652f\u6301 10 \u4f4d\u5bfb\u5740\uff1b \u8bfb\u5199\u4f4d \u8be5\u4f4d\u6307\u5b9a\u6570\u636e\u4f20\u8f93\u7684\u65b9\u5411\uff1b \u5982\u679c\u4e3b\u8bbe\u5907\u9700\u8981\u5c06\u6570\u636e\u53d1\u9001\u5230\u4ece\u8bbe\u5907\uff0c\u5219\u8be5\u4f4d\u8bbe\u7f6e\u4e3a 0 \uff1b \u5982\u679c\u4e3b\u8bbe\u5907\u9700\u8981\u5f80\u4ece\u8bbe\u5907\u63a5\u6536\u6570\u636e\uff0c\u5219\u5c06\u5176\u8bbe\u7f6e\u4e3a 1 \u3002 ACK / NACK \u4e3b\u673a\u6bcf\u6b21\u53d1\u9001\u5b8c\u6570\u636e\u4e4b\u540e\u4f1a\u7b49\u5f85\u4ece\u8bbe\u5907\u7684\u5e94\u7b54\u4fe1\u53f7 ACK \uff1b \u5728\u7b2c 9 \u4e2a\u65f6\u949f\u4fe1\u53f7\uff0c\u5982\u679c\u4ece\u8bbe\u5907\u53d1\u9001\u5e94\u7b54\u4fe1\u53f7 ACK \uff0c\u5219 SDA \u4f1a\u88ab\u62c9\u4f4e\uff1b \u82e5\u6ca1\u6709\u5e94\u7b54\u4fe1\u53f7 NACK \uff0c\u5219 SDA \u4f1a\u8f93\u51fa\u4e3a\u9ad8\u7535\u5e73\uff0c\u8fd9\u8fc7\u7a0b\u4f1a\u5f15\u8d77\u4e3b\u8bbe\u5907\u53d1\u751f\u91cd\u542f\u6216\u8005\u505c\u6b62\uff1b \u6570\u636e\u5757 \u4f20\u8f93\u7684\u6570\u636e\u603b\u5171\u6709 8 \u4f4d\uff0c\u7531\u53d1\u9001\u65b9\u8bbe\u7f6e\uff0c\u5b83\u9700\u8981\u5c06\u6570\u636e\u4f4d\u4f20\u8f93\u5230\u63a5\u6536\u65b9\u3002 \u53d1\u9001\u4e4b\u540e\u4f1a\u7d27\u8ddf\u4e00\u4e2a ACK / NACK \u4f4d\uff0c\u5982\u679c\u63a5\u6536\u5668\u6210\u529f\u63a5\u6536\u5230\u6570\u636e\uff0c\u5219\u8bbe\u7f6e\u4e3a 0\u3002\u5426\u5219\uff0c\u5b83\u4fdd\u6301\u903b\u8f91 \u201c1\u201d\u3002 \u91cd\u590d\u53d1\u9001\uff0c\u76f4\u5230\u6570\u636e\u5b8c\u5168\u4f20\u8f93\u4e3a\u6b62\u3002 \u505c\u6b62\u6761\u4ef6 \u5f53\u4e3b\u8bbe\u5907\u51b3\u5b9a\u7ed3\u675f\u901a\u8baf\u65f6\uff0c\u9700\u8981\u53d1\u9001\u5f00\u59cb\u4fe1\u53f7\uff0c\u9700\u8981\u6267\u884c\u4ee5\u4e0b\u52a8\u4f5c\uff1b \u5148\u5c06 SDA \u7ebf\u4ece\u4f4e\u7535\u538b\u7535\u5e73\u5207\u6362\u5230\u9ad8\u7535\u538b\u7535\u5e73\uff1b \u518d\u5c06 SCL \u7ebf\u4ece\u9ad8\u7535\u5e73\u62c9\u5230\u4f4e\u7535\u5e73\uff1b \u5177\u4f53\u5982\u4e0b\u56fe\u6240\u793a\uff1b \u5b9e\u9645\u4e0a\u5982\u4f55\u5de5\u4f5c\uff1f \u7b2c\u4e00\u6b65\uff1a\u8d77\u59cb\u6761\u4ef6 \u4e3b\u8bbe\u5907\u901a\u8fc7\u5c06 SDA \u7ebf\u4ece\u9ad8\u7535\u5e73\u5207\u6362\u5230\u4f4e\u7535\u5e73\uff0c\u518d\u5c06 SCL \u7ebf\u4ece\u9ad8\u7535\u5e73\u5207\u6362\u5230\u4f4e\u7535\u5e73\uff0c\u6765\u5411\u6bcf\u4e2a\u8fde\u63a5\u7684\u4ece\u673a\u53d1\u9001\u542f\u52a8\u6761\u4ef6 \uff1a \u7b2c\u4e8c\u6b65\uff1a\u53d1\u9001\u4ece\u8bbe\u5907\u5730\u5740 \u4e3b\u8bbe\u5907\u5411\u6bcf\u4e2a\u4ece\u673a\u53d1\u9001\u8981\u4e0e\u4e4b\u901a\u4fe1\u7684\u4ece\u673a\u7684 7 \u4f4d\u6216 10 \u4f4d\u5730\u5740\uff0c\u4ee5\u53ca\u76f8\u5e94\u7684 \u8bfb / \u5199\u4f4d \uff1b \u7b2c\u4e09\u6b65\uff1a\u63a5\u6536\u5e94\u7b54 \u6bcf\u4e2a\u4ece\u8bbe\u5907\u5c06\u4e3b\u8bbe\u5907\u53d1\u9001\u7684\u5730\u5740\u4e0e\u5176\u81ea\u5df1\u7684\u5730\u5740\u8fdb\u884c\u6bd4\u8f83\u3002\u5982\u679c\u5730\u5740\u5339\u914d\uff0c\u5219\u4ece\u8bbe\u5907\u901a\u8fc7 \u5c06 SDA \u7ebf\u62c9\u4f4e\u4e00\u4f4d\u4ee5\u8868\u793a\u8fd4\u56de\u4e00\u4e2a ACK \u4f4d \uff1b \u5982\u679c\u6765\u81ea\u4e3b\u8bbe\u5907\u7684\u5730\u5740\u4e0e\u4ece\u673a\u81ea\u8eab\u7684\u5730\u5740\u4e0d\u5339\u914d\uff0c\u5219 \u4ece\u8bbe\u5907\u5c06 SDA \u7ebf\u62c9\u9ad8\uff0c\u8868\u793a\u8fd4\u56de\u4e00\u4e2a NACK \u4f4d \uff1b \u7b2c\u56db\u6b65\uff1a\u6536\u53d1\u6570\u636e \u4e3b\u8bbe\u5907\u53d1\u9001\u6216\u63a5\u6536\u6570\u636e\u5230\u4ece\u8bbe\u5907\uff1b \u7b2c\u4e94\u6b65\uff1a\u63a5\u6536\u5e94\u7b54 \u5728\u4f20\u8f93\u5b8c\u6bcf\u4e2a\u6570\u636e\u5e27\u540e\uff0c\u63a5\u6536\u8bbe\u5907\u5c06\u53e6\u4e00\u4e2a ACK \u4f4d\u8fd4\u56de\u7ed9\u53d1\u9001\u65b9\uff0c\u4ee5\u786e\u8ba4\u5df2\u6210\u529f\u63a5\u6536\u5230\u8be5\u5e27\uff1a \u7b2c\u516d\u6b65\uff1a\u505c\u6b62\u901a\u4fe1 \u4e3a\u4e86\u505c\u6b62\u6570\u636e\u4f20\u8f93\uff0c\u4e3b\u8bbe\u5907\u5c06 SCL \u5207\u6362\u4e3a\u9ad8\u7535\u5e73\uff0c\u7136\u540e\u518d\u5c06 SDA \u5207\u6362\u4e3a\u9ad8\u7535\u5e73\uff0c\u4ece\u800c\u5411\u4ece\u673a\u53d1\u9001\u505c\u6b62\u6761\u4ef6\uff1b \u5355\u4e2a\u4e3b\u8bbe\u5907\u8fde\u63a5\u591a\u4e2a\u4ece\u673a I2C \u603b\u7ebf\u4e0a\u7684\u4e3b\u8bbe\u5907\u4f7f\u7528 7 \u4f4d\u5730\u5740\u5bf9\u4ece\u8bbe\u5907\u8fdb\u884c\u5bfb\u5740\uff0c\u53ef\u4ee5\u4f7f\u7528 128\uff08 2 7 2^7 27\uff09\u4e2a\u4ece\u673a\u5730\u5740\u3002 \u8bf7\u4f7f\u7528 4.7K \u4e0a\u62c9\u7535\u963b\u5c06 SDA \u548c SCL \u7ebf\u8fde\u63a5\u5230 Vcc\uff1b \u591a\u4e2a\u4e3b\u8bbe\u5907\u8fde\u63a5\u591a\u4e2a\u4ece\u673a \u591a\u4e2a\u4e3b\u8bbe\u5907\u53ef\u4ee5\u8fde\u63a5\u5230\u4e00\u4e2a\u6216\u591a\u4e2a\u4ece\u673a\uff1b \u5f53\u4e24\u4e2a\u4e3b\u8bbe\u5907\u8bd5\u56fe\u901a\u8fc7 SDA \u7ebf\u8def\u540c\u65f6\u53d1\u9001\u6216\u63a5\u6536\u6570\u636e\u65f6\uff0c\u540c\u4e00\u7cfb\u7edf\u4e2d\u7684\u591a\u4e2a\u4e3b\u8bbe\u5907\u5c31\u4f1a\u51fa\u73b0\u95ee\u9898\u3002 \u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c \u6bcf\u4e2a\u4e3b\u8bbe\u5907\u90fd\u9700\u8981\u5728\u53d1\u9001\u6d88\u606f\u4e4b\u524d\u68c0\u6d4b SDA \u7ebf\u662f\u4f4e\u7535\u5e73\u8fd8\u662f\u9ad8\u7535\u5e73 \uff1b \u5982\u679c SDA \u7ebf\u4e3a\u4f4e\u7535\u5e73\uff0c\u5219\u610f\u5473\u7740\u53e6\u4e00\u4e2a\u4e3b\u8bbe\u5907\u53ef\u4ee5\u63a7\u5236\u603b\u7ebf\uff0c\u5e76\u4e14\u4e3b\u8bbe\u5907\u5e94\u7b49\u5f85\u53d1\u9001\u6d88\u606f\u3002 \u5982\u679c SDA \u7ebf\u4e3a\u9ad8\u7535\u5e73\uff0c\u5219\u53ef\u4ee5\u5b89\u5168\u5730\u53d1\u9001\u6d88\u606f\u3002 \u8981\u5c06\u591a\u4e2a\u4e3b\u8bbe\u5907\u8fde\u63a5\u5230\u591a\u4e2a\u4ece\u673a\uff0c\u8bf7\u4f7f\u7528\u4e0b\u56fe\uff0c\u5176\u4e2d 4.7K \u4e0a\u62c9\u7535\u963b\u5c06 SDA \u548c SCL \u7ebf\u8fde\u63a5\u5230 Vcc\uff1a \u5982\u4f55\u7f16\u7a0b\uff1f Talk is cheap. Show me the code. \u53c2\u8003\u4e86 STM32 \u7684 HAL \u5e93\u4e2d I2C \u9a71\u52a8\uff0c\u4e3b\u8bbe\u5907\u53d1\u9001\u51fd\u6570 HAL_I2C_Master_Transmit() \u5177\u4f53\u5982\u4e0b\uff1a /** * @brief Transmits in master mode an amount of data in blocking mode. * @param hi2c Pointer to a I2C_HandleTypeDef structure that contains * the configuration information for the specified I2C. * @param DevAddress Target device address: The device 7 bits address value * in datasheet must be shifted to the left before calling the interface * @param pData Pointer to data buffer * @param Size Amount of data to be sent * @param Timeout Timeout duration * @retval HAL status */ HAL_StatusTypeDef HAL_I2C_Master_Transmit(I2C_HandleTypeDef *hi2c, uint16_t DevAddress, uint8_t *pData, uint16_t Size, uint32_t Timeout){ uint32_t tickstart = 0x00U; /* Init tickstart for timeout management*/ tickstart = HAL_GetTick(); if(hi2c->State == HAL_I2C_STATE_READY){ /* Wait until BUSY flag is reset */ if(I2C_WaitOnFlagUntilTimeout(hi2c, I2C_FLAG_BUSY, SET, I2C_TIMEOUT_BUSY_FLAG, tickstart) != HAL_OK){ return HAL_BUSY; } /* Process Locked */ __HAL_LOCK(hi2c); /* Check if the I2C is already enabled */ if((hi2c->Instance->CR1 & I2C_CR1_PE) != I2C_CR1_PE){ /* Enable I2C peripheral */ __HAL_I2C_ENABLE(hi2c); } /* Disable Pos */ hi2c->Instance->CR1 &= ~I2C_CR1_POS; hi2c->State = HAL_I2C_STATE_BUSY_TX; hi2c->Mode = HAL_I2C_MODE_MASTER; hi2c->ErrorCode = HAL_I2C_ERROR_NONE; /* Prepare transfer parameters */ hi2c->pBuffPtr = pData; hi2c->XferCount = Size; hi2c->XferOptions = I2C_NO_OPTION_FRAME; hi2c->XferSize = hi2c->XferCount; /* Send Slave Address */ if(I2C_MasterRequestWrite(hi2c, DevAddress, Timeout, tickstart) != HAL_OK){ if(hi2c->ErrorCode == HAL_I2C_ERROR_AF){ /* Process Unlocked */ __HAL_UNLOCK(hi2c); return HAL_ERROR; }else{ /* Process Unlocked */ __HAL_UNLOCK(hi2c); return HAL_TIMEOUT; } } /* Clear ADDR flag */ __HAL_I2C_CLEAR_ADDRFLAG(hi2c); while(hi2c->XferSize > 0U){ /* Wait until TXE flag is set */ if(I2C_WaitOnTXEFlagUntilTimeout(hi2c, Timeout, tickstart) != HAL_OK){ if(hi2c->ErrorCode == HAL_I2C_ERROR_AF){ /* Generate Stop */ hi2c->Instance->CR1 |= I2C_CR1_STOP; return HAL_ERROR; }else{ return HAL_TIMEOUT; } } /* Write data to DR */ hi2c->Instance->DR = (*hi2c->pBuffPtr++); hi2c->XferCount--; hi2c->XferSize--; if((__HAL_I2C_GET_FLAG(hi2c, I2C_FLAG_BTF) == SET) && (hi2c->XferSize != 0U)){ /* Write data to DR */ hi2c->Instance->DR = (*hi2c->pBuffPtr++); hi2c->XferCount--; hi2c->XferSize--; } /* Wait until BTF flag is set */ if(I2C_WaitOnBTFFlagUntilTimeout(hi2c, Timeout, tickstart) != HAL_OK){ if(hi2c->ErrorCode == HAL_I2C_ERROR_AF){ /* Generate Stop */ hi2c->Instance->CR1 |= I2C_CR1_STOP; return HAL_ERROR; }else{ return HAL_TIMEOUT; } } } /* Generate Stop */ hi2c->Instance->CR1 |= I2C_CR1_STOP; hi2c->State = HAL_I2C_STATE_READY; hi2c->Mode = HAL_I2C_MODE_NONE; /* Process Unlocked */ __HAL_UNLOCK(hi2c); return HAL_OK; }else{ return HAL_BUSY; } } \u603b\u7ed3 \u672c\u6587\u4e3b\u8981\u4ecb\u7ecd I2C \u7684\u5165\u95e8\u57fa\u7840\u77e5\u8bc6\uff0c\u4ece I2C \u534f\u8bae\u7684\u786c\u4ef6\u5c42\uff0c\u534f\u8bae\u5c42\u8fdb\u884c\u4e86\u7b80\u5355\u4ecb\u7ecd\uff1b\u4f5c\u8005\u80fd\u529b\u6709\u9650\uff0c\u96be\u514d\u5b58\u5728\u9519\u8bef\u548c\u7eb0\u6f0f\uff0c\u8bf7\u5927\u4f6c\u4e0d\u541d\u8d50\u6559\u3002","title":"I2C"},{"location":"bus/I2C/#_1","text":"I\u00b2C \uff08 Inter-Integrated Circuit \uff09\uff0c\u4e2d\u6587\u5e94\u8be5\u53eb \u96c6\u6210\u7535\u8def\u603b\u7ebf \uff0c\u5b83\u662f\u4e00\u79cd \u4e32\u884c\u901a\u4fe1 \u603b\u7ebf\uff0c\u4f7f\u7528\u591a\u4e3b\u4ece\u67b6\u6784\uff0c\u662f\u7531\u98de\u5229\u6d66\u516c\u53f8\u5728 1980 \u5e74\u4ee3\u521d\u8bbe\u8ba1\u7684\uff0c\u65b9\u4fbf\u4e86\u4e3b\u677f\u3001\u5d4c\u5165\u5f0f\u7cfb\u7edf\u6216\u624b\u673a\u4e0e\u5468\u8fb9\u8bbe\u5907\u7ec4\u4ef6\u4e4b\u95f4\u7684\u901a\u8baf\u3002\u7531\u4e8e\u5176\u7b80\u5355\u6027\uff0c\u5b83\u88ab\u5e7f\u6cdb\u7528\u4e8e\u5fae\u63a7\u5236\u5668\u4e0e\u4f20\u611f\u5668\u9635\u5217\uff0c\u663e\u793a\u5668\uff0cIoT \u8bbe\u5907\uff0cEEPROM \u7b49\u4e4b\u95f4\u7684\u901a\u4fe1\u3002 I\u00b2C \u6700\u91cd\u8981\u7684\u529f\u80fd\u5305\u62ec\uff1a \u53ea\u9700\u8981\u4e24\u6761\u603b\u7ebf\uff1b \u6240\u6709\u7ec4\u4ef6\u4e4b\u95f4\u90fd\u5b58\u5728\u7b80\u5355\u7684\u4e3b / \u4ece\u5173\u7cfb\uff0c\u8fde\u63a5\u5230\u603b\u7ebf\u7684\u6bcf\u4e2a\u8bbe\u5907\u5747\u53ef\u901a\u8fc7\u552f\u4e00\u5730\u5740\u8fdb\u884c\u8f6f\u4ef6\u5bfb\u5740\uff1b I\u00b2C \u662f\u771f\u6b63\u7684\u591a\u4e3b\u8bbe\u5907\u603b\u7ebf\uff0c\u53ef\u63d0\u4f9b\u4ef2\u88c1\u548c\u51b2\u7a81\u68c0\u6d4b\uff1b \u4f20\u8f93\u901f\u5ea6\uff1b \u6807\u51c6\u6a21\u5f0f\uff1aStandard Mode = 100 Kbps \u5feb\u901f\u6a21\u5f0f\uff1aFast Mode = 400 Kbps \u9ad8\u901f\u6a21\u5f0f\uff1a High speed mode = 3.4 Mbps \u8d85\u5feb\u901f\u6a21\u5f0f\uff1a Ultra fast mode = 5 Mbps \u6700\u5927\u4e3b\u8bbe\u5907\u6570\uff1a\u65e0\u9650\u5236\uff1b \u6700\u5927\u4ece\u673a\u6570\uff1a\u7406\u8bba\u4e0a\u662f 127\uff1b \u4ee5\u4e0a\u662f I\u00b2C \u7684\u4e00\u4e9b\u91cd\u8981\u7279\u70b9\uff0c\u4e0b\u9762\u4f1a\u8fdb\u4e00\u6b65\u5bf9 I\u00b2C \u8fdb\u884c\u4ecb\u7ecd\u3002","title":"\u80cc\u666f"},{"location":"bus/I2C/#_2","text":"I\u00b2C \u534f\u8bae\u4ec5\u9700\u8981\u4e00\u4e2a SDA \u548c SCL \u5f15\u811a\u3002SDA \u662f \u4e32\u884c\u6570\u636e\u7ebf\u7684 \u7f29\u5199\uff0c\u800c SCL \u662f \u4e32\u884c\u65f6\u949f\u7ebf\u7684 \u7f29\u5199\u3002\u8fd9\u4e24\u6761\u6570\u636e\u7ebf\u9700\u8981\u63a5\u4e0a\u62c9\u7535\u963b\u3002 \u8bbe\u5907\u95f4\u7684\u8fde\u63a5\u5982\u4e0b\u6240\u793a\uff1a \u4f7f\u7528 I\u00b2C\uff0c\u53ef\u4ee5\u5c06\u591a\u4e2a\u4ece\u673a\uff08 Slave \uff09\u8fde\u63a5\u5230\u5355\u4e2a\u4e3b\u8bbe\u5907\uff08 Master \uff09\uff0c\u5e76\u4e14\u8fd8\u53ef\u4ee5\u6709\u591a\u4e2a\u4e3b\u8bbe\u5907\uff08 Master \uff09\u63a7\u5236\u4e00\u4e2a\u6216\u591a\u4e2a\u4ece\u673a\uff08 Slave \uff09\u3002 \u5047\u5982\u5e0c\u671b\u6709\u591a\u4e2a\u5fae\u63a7\u5236\u5668\uff08 MCU \uff09\u5c06\u6570\u636e\u8bb0\u5f55\u5230\u5355\u4e2a\u5b58\u50a8\u5361\u6216\u5c06\u6587\u672c\u663e\u793a\u5230\u5355\u4e2a LCD \u65f6\uff0c\u8fd9\u4e2a\u529f\u80fd\u5c31\u975e\u5e38\u6709\u7528\u3002 I\u00b2C \u603b\u7ebf\uff08 SDA \uff0c SCL \uff09\u5185\u90e8\u90fd\u4f7f\u7528\u6f0f\u6781\u5f00\u8def\u9a71\u52a8\u5668\uff08\u5f00\u6f0f\u9a71\u52a8\uff09\uff0c\u56e0\u6b64 SDA \u548c SCL \u53ef\u4ee5\u88ab\u62c9\u4f4e\u4e3a\u4f4e\u7535\u5e73\uff0c\u4f46\u662f\u4e0d\u80fd\u88ab\u9a71\u52a8\u4e3a\u9ad8\u7535\u5e73 \uff0c\u6240\u4ee5\u6bcf\u6761\u7ebf\u4e0a\u90fd\u8981\u4f7f\u7528\u4e00\u4e2a\u4e0a\u62c9\u7535\u963b\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5c06\u5176\u4fdd\u6301\u5728\u9ad8\u7535\u5e73\uff1b \u4e0a \u62c9\u7535\u963b\u7684 \u503c\u53d6\u51b3\u4e8e\u8bb8\u591a\u56e0\u7d20\u3002 \u5fb7\u5dde\u4eea\u5668 TI \u5efa\u8bae \u4f7f\u7528\u4ee5\u4e0b\u516c\u5f0f\u6765\u8ba1\u7b97\u6b63\u786e\u7684\u4e0a\u62c9\u7535\u963b\u503c\uff1a $$ R_p(min)=\\cfrac{V_{DD}-V_{OL}(max)}{I_{OL}} $$ $$ R p ( m i n ) =\\cfrac{t_r}{0.8473xC_b} $$ \u5176\u4e2d $V_{OL}$\u662f\u903b\u8f91\u4f4e\u7535\u538b\uff1b $I_{OL}$\u662f\u903b\u8f91\u4f4e\u7535\u6d41\uff1b $t_r$\u662f\u4fe1\u53f7\u7684\u6700\u5927\u4e0a\u5347\u65f6\u95f4\uff1b $C_b$\u662f\u603b\u7ebf\uff08\u7535\u7ebf\uff09\u7535\u5bb9\uff1b \u5177\u4f53\u5982\u4e0b\u6240\u793a\uff1a \u4ece\u4e0a\u8868\u53ef\u77e5\uff0c\u4f7f\u7528 I2C \u8bbe\u5907\u5fc5\u987b\u5728 3 mA\u7684\u704c\u7535\u6d41\u4e0b\u5de5\u4f5c\uff0c \u8fd9\u91cc\u4e0d\u96be\u53d1\u73b0\u9700\u8981\u5728\u505a\u9009\u578b\u9700\u8981\u6ee1\u8db3\u51e0\u4e2a\u6761\u4ef6\uff1b \u704c\u7535\u6d41 \u6700\u5927\u503c\u4e3a 3 mA\uff1b \u53e6\u5916 I2C \u603b\u7ebf\u89c4\u8303\u548c\u7528\u6237\u624b\u518c\u8fd8\u4e3a\u4f4e\u7535\u5e73\u8f93\u51fa\u7535\u538b $V_{OL}$ \u8bbe\u7f6e\u4e86\u6700\u5927\u503c\u4e3a 0.4V $$R_p(min) = \\cfrac{VCC - 0.4V}{3mA}$$ \u6240\u4ee5\u6839\u636e\u4e0a\u8ff0\u516c\u5f0f\u53ef\u4ee5\u8ba1\u7b97\uff0c\u5bf9\u4e8e 5V \u7684\u7535\u6e90\uff0c\u6bcf\u4e2a\u4e0a\u62c9\u7535\u963b\u5fc5\u987b\u81f3\u5c11\u5177\u6709 1.53k\u03a9\uff0c\u800c\u5bf9\u4e8e 3.3V \u7684\u7535\u6e90\uff0c\u6bcf\u4e2a\u7535\u963b\u5fc5\u987b\u81f3\u5c11\u5177\u6709 967\u03a9\u3002 \u5982\u679c\u89c9\u5f97\u8ba1\u7b97\u7535\u963b\u503c\u6bd4\u8f83\u9ebb\u70e6\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 \u5178\u578b\u503c 4.7k\u03a9 \u3002 \u4e0a\u8ff0\u63a8\u5bfc\u8fc7\u7a0b\u53ef\u4ee5\u53c2\u8003 TI \u7684\u6587\u6863\u300aI2C Bus Pullup Resistor Calculation\u300b https://www.ti.com/lit/an/slva689/slva689.pdf \u6700\u7ec8\u5728\u8c03\u8bd5\u7684\u65f6\u5019\uff0c\u5f53\u6211\u4eec\u6d4b\u91cf SDA \u6216 SCL \u4fe1\u53f7\u5e76\u4e14\u903b\u8f91 LOW \u4e0a\u7684\u7535\u538b\u9ad8\u4e8e 0.4V \u65f6\uff0c\u6211\u4eec\u5c31\u77e5\u9053\u53ef\u4ee5\u77e5\u9053\u704c\u7535\u6d41\u592a\u9ad8\u4e86\uff1b \u5f53\u7136\uff0c\u8fd9\u5e76\u4e0d\u610f\u5473\u7740\u6bcf\u5f53\u704c\u7535\u6d41\u8d85\u8fc7 3mA \u65f6\uff0c\u8bbe\u5907\u5c31\u4f1a\u7acb\u5373\u505c\u6b62\u5de5\u4f5c\u3002\u4f46\u662f\uff0c\u5728\u64cd\u4f5c\u8d85\u51fa\u5176\u89c4\u683c\u7684\u8bbe\u5907\u65f6\uff0c\u5e94\u59cb\u7ec8\u5c0f\u5fc3\uff0c\u56e0\u4e3a\u5b83\u53ef\u80fd\u5bfc\u81f4\u901a\u4fe1\u6545\u969c\uff0c\u7f29\u77ed\u5176\u4f7f\u7528\u5bff\u547d\u751a\u81f3\u751a\u81f3\u6c38\u4e45\u635f\u574f\u8bbe\u5907\u3002","title":"\u786c\u4ef6\u5c42"},{"location":"bus/I2C/#_3","text":"\u4e3b\u8bbe\u5907\u548c\u4ece\u8bbe\u5907\u8fdb\u884c\u6570\u636e\u4f20\u8f93\u65f6\u9075\u5faa\u4ee5\u4e0b\u534f\u8bae\u683c\u5f0f\u3002\u6570\u636e\u901a\u8fc7\u4e00\u6761 SDA \u6570\u636e\u7ebf\u5728\u4e3b\u8bbe\u5907\u548c\u4ece\u8bbe\u5907\u4e4b\u95f4\u4f20\u8f93 0 \u548c 1 \u7684\u4e32\u884c\u6570\u636e\u3002\u4e32\u884c\u6570\u636e\u5e8f\u5217\u7684\u7ed3\u6784\u53ef\u4ee5\u5206\u4e3a\uff0c\u5f00\u59cb\u6761\u4ef6\uff0c\u5730\u5740\u4f4d\uff0c\u8bfb\u5199\u4f4d\uff0c\u5e94\u7b54\u4f4d\uff0c\u6570\u636e\u4f4d\uff0c\u505c\u6b62\u6761\u4ef6\uff0c\u5177\u4f53\u5982\u4e0b\u6240\u793a\uff1b \u5f00\u59cb\u6761\u4ef6 \u5f53\u4e3b\u8bbe\u5907\u51b3\u5b9a\u5f00\u59cb\u901a\u8baf\u65f6\uff0c\u9700\u8981\u53d1\u9001\u5f00\u59cb\u4fe1\u53f7\uff0c\u9700\u8981\u6267\u884c\u4ee5\u4e0b\u52a8\u4f5c\uff1b \u5148\u5c06 SDA \u7ebf\u4ece\u9ad8\u538b\u7535\u5e73\u5207\u6362\u5230\u4f4e\u538b\u7535\u5e73\uff1b \u7136\u540e\u5c06 SCL \u4ece\u9ad8\u7535\u5e73\u5207\u6362\u5230\u4f4e\u7535\u5e73\uff1b \u5728\u4e3b\u8bbe\u5907\u53d1\u9001 \u5f00\u59cb\u6761\u4ef6 \u4fe1\u53f7\u4e4b\u540e\uff0c\u6240\u6709\u4ece\u673a\u5373\u4f7f\u5904\u4e8e\u7761\u7720\u6a21\u5f0f\u4e5f\u5c06 \u53d8\u4e3a\u6d3b\u52a8\u72b6\u6001 \uff0c\u5e76 \u7b49\u5f85\u63a5\u6536\u5730\u5740\u4f4d \u3002 \u5177\u4f53\u5982\u4e0b\u56fe\u6240\u793a\uff1b \u5730\u5740\u4f4d \u901a\u5e38\u5730\u5740\u4f4d\u5360 7 \u4f4d\u6570\u636e\uff0c\u4e3b\u8bbe\u5907\u5982\u679c\u9700\u8981\u5411\u4ece\u673a\u53d1\u9001 / \u63a5\u6536\u6570\u636e\uff0c\u9996\u5148\u8981\u53d1\u9001\u5bf9\u5e94\u4ece\u673a\u7684\u5730\u5740\uff0c\u7136\u540e\u4f1a\u5339\u914d\u603b\u7ebf\u4e0a\u6302\u8f7d\u7684\u4ece\u673a\u7684\u5730\u5740\uff1b I2C \u8fd8\u652f\u6301 10 \u4f4d\u5bfb\u5740\uff1b \u8bfb\u5199\u4f4d \u8be5\u4f4d\u6307\u5b9a\u6570\u636e\u4f20\u8f93\u7684\u65b9\u5411\uff1b \u5982\u679c\u4e3b\u8bbe\u5907\u9700\u8981\u5c06\u6570\u636e\u53d1\u9001\u5230\u4ece\u8bbe\u5907\uff0c\u5219\u8be5\u4f4d\u8bbe\u7f6e\u4e3a 0 \uff1b \u5982\u679c\u4e3b\u8bbe\u5907\u9700\u8981\u5f80\u4ece\u8bbe\u5907\u63a5\u6536\u6570\u636e\uff0c\u5219\u5c06\u5176\u8bbe\u7f6e\u4e3a 1 \u3002 ACK / NACK \u4e3b\u673a\u6bcf\u6b21\u53d1\u9001\u5b8c\u6570\u636e\u4e4b\u540e\u4f1a\u7b49\u5f85\u4ece\u8bbe\u5907\u7684\u5e94\u7b54\u4fe1\u53f7 ACK \uff1b \u5728\u7b2c 9 \u4e2a\u65f6\u949f\u4fe1\u53f7\uff0c\u5982\u679c\u4ece\u8bbe\u5907\u53d1\u9001\u5e94\u7b54\u4fe1\u53f7 ACK \uff0c\u5219 SDA \u4f1a\u88ab\u62c9\u4f4e\uff1b \u82e5\u6ca1\u6709\u5e94\u7b54\u4fe1\u53f7 NACK \uff0c\u5219 SDA \u4f1a\u8f93\u51fa\u4e3a\u9ad8\u7535\u5e73\uff0c\u8fd9\u8fc7\u7a0b\u4f1a\u5f15\u8d77\u4e3b\u8bbe\u5907\u53d1\u751f\u91cd\u542f\u6216\u8005\u505c\u6b62\uff1b \u6570\u636e\u5757 \u4f20\u8f93\u7684\u6570\u636e\u603b\u5171\u6709 8 \u4f4d\uff0c\u7531\u53d1\u9001\u65b9\u8bbe\u7f6e\uff0c\u5b83\u9700\u8981\u5c06\u6570\u636e\u4f4d\u4f20\u8f93\u5230\u63a5\u6536\u65b9\u3002 \u53d1\u9001\u4e4b\u540e\u4f1a\u7d27\u8ddf\u4e00\u4e2a ACK / NACK \u4f4d\uff0c\u5982\u679c\u63a5\u6536\u5668\u6210\u529f\u63a5\u6536\u5230\u6570\u636e\uff0c\u5219\u8bbe\u7f6e\u4e3a 0\u3002\u5426\u5219\uff0c\u5b83\u4fdd\u6301\u903b\u8f91 \u201c1\u201d\u3002 \u91cd\u590d\u53d1\u9001\uff0c\u76f4\u5230\u6570\u636e\u5b8c\u5168\u4f20\u8f93\u4e3a\u6b62\u3002 \u505c\u6b62\u6761\u4ef6 \u5f53\u4e3b\u8bbe\u5907\u51b3\u5b9a\u7ed3\u675f\u901a\u8baf\u65f6\uff0c\u9700\u8981\u53d1\u9001\u5f00\u59cb\u4fe1\u53f7\uff0c\u9700\u8981\u6267\u884c\u4ee5\u4e0b\u52a8\u4f5c\uff1b \u5148\u5c06 SDA \u7ebf\u4ece\u4f4e\u7535\u538b\u7535\u5e73\u5207\u6362\u5230\u9ad8\u7535\u538b\u7535\u5e73\uff1b \u518d\u5c06 SCL \u7ebf\u4ece\u9ad8\u7535\u5e73\u62c9\u5230\u4f4e\u7535\u5e73\uff1b \u5177\u4f53\u5982\u4e0b\u56fe\u6240\u793a\uff1b","title":"\u6570\u636e\u4f20\u8f93\u534f\u8bae"},{"location":"bus/I2C/#_4","text":"\u7b2c\u4e00\u6b65\uff1a\u8d77\u59cb\u6761\u4ef6 \u4e3b\u8bbe\u5907\u901a\u8fc7\u5c06 SDA \u7ebf\u4ece\u9ad8\u7535\u5e73\u5207\u6362\u5230\u4f4e\u7535\u5e73\uff0c\u518d\u5c06 SCL \u7ebf\u4ece\u9ad8\u7535\u5e73\u5207\u6362\u5230\u4f4e\u7535\u5e73\uff0c\u6765\u5411\u6bcf\u4e2a\u8fde\u63a5\u7684\u4ece\u673a\u53d1\u9001\u542f\u52a8\u6761\u4ef6 \uff1a \u7b2c\u4e8c\u6b65\uff1a\u53d1\u9001\u4ece\u8bbe\u5907\u5730\u5740 \u4e3b\u8bbe\u5907\u5411\u6bcf\u4e2a\u4ece\u673a\u53d1\u9001\u8981\u4e0e\u4e4b\u901a\u4fe1\u7684\u4ece\u673a\u7684 7 \u4f4d\u6216 10 \u4f4d\u5730\u5740\uff0c\u4ee5\u53ca\u76f8\u5e94\u7684 \u8bfb / \u5199\u4f4d \uff1b \u7b2c\u4e09\u6b65\uff1a\u63a5\u6536\u5e94\u7b54 \u6bcf\u4e2a\u4ece\u8bbe\u5907\u5c06\u4e3b\u8bbe\u5907\u53d1\u9001\u7684\u5730\u5740\u4e0e\u5176\u81ea\u5df1\u7684\u5730\u5740\u8fdb\u884c\u6bd4\u8f83\u3002\u5982\u679c\u5730\u5740\u5339\u914d\uff0c\u5219\u4ece\u8bbe\u5907\u901a\u8fc7 \u5c06 SDA \u7ebf\u62c9\u4f4e\u4e00\u4f4d\u4ee5\u8868\u793a\u8fd4\u56de\u4e00\u4e2a ACK \u4f4d \uff1b \u5982\u679c\u6765\u81ea\u4e3b\u8bbe\u5907\u7684\u5730\u5740\u4e0e\u4ece\u673a\u81ea\u8eab\u7684\u5730\u5740\u4e0d\u5339\u914d\uff0c\u5219 \u4ece\u8bbe\u5907\u5c06 SDA \u7ebf\u62c9\u9ad8\uff0c\u8868\u793a\u8fd4\u56de\u4e00\u4e2a NACK \u4f4d \uff1b \u7b2c\u56db\u6b65\uff1a\u6536\u53d1\u6570\u636e \u4e3b\u8bbe\u5907\u53d1\u9001\u6216\u63a5\u6536\u6570\u636e\u5230\u4ece\u8bbe\u5907\uff1b \u7b2c\u4e94\u6b65\uff1a\u63a5\u6536\u5e94\u7b54 \u5728\u4f20\u8f93\u5b8c\u6bcf\u4e2a\u6570\u636e\u5e27\u540e\uff0c\u63a5\u6536\u8bbe\u5907\u5c06\u53e6\u4e00\u4e2a ACK \u4f4d\u8fd4\u56de\u7ed9\u53d1\u9001\u65b9\uff0c\u4ee5\u786e\u8ba4\u5df2\u6210\u529f\u63a5\u6536\u5230\u8be5\u5e27\uff1a \u7b2c\u516d\u6b65\uff1a\u505c\u6b62\u901a\u4fe1 \u4e3a\u4e86\u505c\u6b62\u6570\u636e\u4f20\u8f93\uff0c\u4e3b\u8bbe\u5907\u5c06 SCL \u5207\u6362\u4e3a\u9ad8\u7535\u5e73\uff0c\u7136\u540e\u518d\u5c06 SDA \u5207\u6362\u4e3a\u9ad8\u7535\u5e73\uff0c\u4ece\u800c\u5411\u4ece\u673a\u53d1\u9001\u505c\u6b62\u6761\u4ef6\uff1b","title":"\u5b9e\u9645\u4e0a\u5982\u4f55\u5de5\u4f5c\uff1f"},{"location":"bus/I2C/#_5","text":"I2C \u603b\u7ebf\u4e0a\u7684\u4e3b\u8bbe\u5907\u4f7f\u7528 7 \u4f4d\u5730\u5740\u5bf9\u4ece\u8bbe\u5907\u8fdb\u884c\u5bfb\u5740\uff0c\u53ef\u4ee5\u4f7f\u7528 128\uff08 2 7 2^7 27\uff09\u4e2a\u4ece\u673a\u5730\u5740\u3002 \u8bf7\u4f7f\u7528 4.7K \u4e0a\u62c9\u7535\u963b\u5c06 SDA \u548c SCL \u7ebf\u8fde\u63a5\u5230 Vcc\uff1b","title":"\u5355\u4e2a\u4e3b\u8bbe\u5907\u8fde\u63a5\u591a\u4e2a\u4ece\u673a"},{"location":"bus/I2C/#_6","text":"\u591a\u4e2a\u4e3b\u8bbe\u5907\u53ef\u4ee5\u8fde\u63a5\u5230\u4e00\u4e2a\u6216\u591a\u4e2a\u4ece\u673a\uff1b \u5f53\u4e24\u4e2a\u4e3b\u8bbe\u5907\u8bd5\u56fe\u901a\u8fc7 SDA \u7ebf\u8def\u540c\u65f6\u53d1\u9001\u6216\u63a5\u6536\u6570\u636e\u65f6\uff0c\u540c\u4e00\u7cfb\u7edf\u4e2d\u7684\u591a\u4e2a\u4e3b\u8bbe\u5907\u5c31\u4f1a\u51fa\u73b0\u95ee\u9898\u3002 \u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c \u6bcf\u4e2a\u4e3b\u8bbe\u5907\u90fd\u9700\u8981\u5728\u53d1\u9001\u6d88\u606f\u4e4b\u524d\u68c0\u6d4b SDA \u7ebf\u662f\u4f4e\u7535\u5e73\u8fd8\u662f\u9ad8\u7535\u5e73 \uff1b \u5982\u679c SDA \u7ebf\u4e3a\u4f4e\u7535\u5e73\uff0c\u5219\u610f\u5473\u7740\u53e6\u4e00\u4e2a\u4e3b\u8bbe\u5907\u53ef\u4ee5\u63a7\u5236\u603b\u7ebf\uff0c\u5e76\u4e14\u4e3b\u8bbe\u5907\u5e94\u7b49\u5f85\u53d1\u9001\u6d88\u606f\u3002 \u5982\u679c SDA \u7ebf\u4e3a\u9ad8\u7535\u5e73\uff0c\u5219\u53ef\u4ee5\u5b89\u5168\u5730\u53d1\u9001\u6d88\u606f\u3002 \u8981\u5c06\u591a\u4e2a\u4e3b\u8bbe\u5907\u8fde\u63a5\u5230\u591a\u4e2a\u4ece\u673a\uff0c\u8bf7\u4f7f\u7528\u4e0b\u56fe\uff0c\u5176\u4e2d 4.7K \u4e0a\u62c9\u7535\u963b\u5c06 SDA \u548c SCL \u7ebf\u8fde\u63a5\u5230 Vcc\uff1a","title":"\u591a\u4e2a\u4e3b\u8bbe\u5907\u8fde\u63a5\u591a\u4e2a\u4ece\u673a"},{"location":"bus/I2C/#_7","text":"Talk is cheap. Show me the code. \u53c2\u8003\u4e86 STM32 \u7684 HAL \u5e93\u4e2d I2C \u9a71\u52a8\uff0c\u4e3b\u8bbe\u5907\u53d1\u9001\u51fd\u6570 HAL_I2C_Master_Transmit() \u5177\u4f53\u5982\u4e0b\uff1a /** * @brief Transmits in master mode an amount of data in blocking mode. * @param hi2c Pointer to a I2C_HandleTypeDef structure that contains * the configuration information for the specified I2C. * @param DevAddress Target device address: The device 7 bits address value * in datasheet must be shifted to the left before calling the interface * @param pData Pointer to data buffer * @param Size Amount of data to be sent * @param Timeout Timeout duration * @retval HAL status */ HAL_StatusTypeDef HAL_I2C_Master_Transmit(I2C_HandleTypeDef *hi2c, uint16_t DevAddress, uint8_t *pData, uint16_t Size, uint32_t Timeout){ uint32_t tickstart = 0x00U; /* Init tickstart for timeout management*/ tickstart = HAL_GetTick(); if(hi2c->State == HAL_I2C_STATE_READY){ /* Wait until BUSY flag is reset */ if(I2C_WaitOnFlagUntilTimeout(hi2c, I2C_FLAG_BUSY, SET, I2C_TIMEOUT_BUSY_FLAG, tickstart) != HAL_OK){ return HAL_BUSY; } /* Process Locked */ __HAL_LOCK(hi2c); /* Check if the I2C is already enabled */ if((hi2c->Instance->CR1 & I2C_CR1_PE) != I2C_CR1_PE){ /* Enable I2C peripheral */ __HAL_I2C_ENABLE(hi2c); } /* Disable Pos */ hi2c->Instance->CR1 &= ~I2C_CR1_POS; hi2c->State = HAL_I2C_STATE_BUSY_TX; hi2c->Mode = HAL_I2C_MODE_MASTER; hi2c->ErrorCode = HAL_I2C_ERROR_NONE; /* Prepare transfer parameters */ hi2c->pBuffPtr = pData; hi2c->XferCount = Size; hi2c->XferOptions = I2C_NO_OPTION_FRAME; hi2c->XferSize = hi2c->XferCount; /* Send Slave Address */ if(I2C_MasterRequestWrite(hi2c, DevAddress, Timeout, tickstart) != HAL_OK){ if(hi2c->ErrorCode == HAL_I2C_ERROR_AF){ /* Process Unlocked */ __HAL_UNLOCK(hi2c); return HAL_ERROR; }else{ /* Process Unlocked */ __HAL_UNLOCK(hi2c); return HAL_TIMEOUT; } } /* Clear ADDR flag */ __HAL_I2C_CLEAR_ADDRFLAG(hi2c); while(hi2c->XferSize > 0U){ /* Wait until TXE flag is set */ if(I2C_WaitOnTXEFlagUntilTimeout(hi2c, Timeout, tickstart) != HAL_OK){ if(hi2c->ErrorCode == HAL_I2C_ERROR_AF){ /* Generate Stop */ hi2c->Instance->CR1 |= I2C_CR1_STOP; return HAL_ERROR; }else{ return HAL_TIMEOUT; } } /* Write data to DR */ hi2c->Instance->DR = (*hi2c->pBuffPtr++); hi2c->XferCount--; hi2c->XferSize--; if((__HAL_I2C_GET_FLAG(hi2c, I2C_FLAG_BTF) == SET) && (hi2c->XferSize != 0U)){ /* Write data to DR */ hi2c->Instance->DR = (*hi2c->pBuffPtr++); hi2c->XferCount--; hi2c->XferSize--; } /* Wait until BTF flag is set */ if(I2C_WaitOnBTFFlagUntilTimeout(hi2c, Timeout, tickstart) != HAL_OK){ if(hi2c->ErrorCode == HAL_I2C_ERROR_AF){ /* Generate Stop */ hi2c->Instance->CR1 |= I2C_CR1_STOP; return HAL_ERROR; }else{ return HAL_TIMEOUT; } } } /* Generate Stop */ hi2c->Instance->CR1 |= I2C_CR1_STOP; hi2c->State = HAL_I2C_STATE_READY; hi2c->Mode = HAL_I2C_MODE_NONE; /* Process Unlocked */ __HAL_UNLOCK(hi2c); return HAL_OK; }else{ return HAL_BUSY; } }","title":"\u5982\u4f55\u7f16\u7a0b\uff1f"},{"location":"bus/I2C/#_8","text":"\u672c\u6587\u4e3b\u8981\u4ecb\u7ecd I2C \u7684\u5165\u95e8\u57fa\u7840\u77e5\u8bc6\uff0c\u4ece I2C \u534f\u8bae\u7684\u786c\u4ef6\u5c42\uff0c\u534f\u8bae\u5c42\u8fdb\u884c\u4e86\u7b80\u5355\u4ecb\u7ecd\uff1b\u4f5c\u8005\u80fd\u529b\u6709\u9650\uff0c\u96be\u514d\u5b58\u5728\u9519\u8bef\u548c\u7eb0\u6f0f\uff0c\u8bf7\u5927\u4f6c\u4e0d\u541d\u8d50\u6559\u3002","title":"\u603b\u7ed3"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E6%90%AD%E5%BB%BA%E6%80%9D%E6%BA%90%E7%AC%94%E8%AE%B0/","text":"\u4f5c\u8005: sugar \u8f6c\u8f7d\u8bf7\u8054\u7cfb\u4f5c\u8005(1144392179@qq.com),\u5e76\u8bf4\u660e\u51fa\u5904! 1. \u4ecb\u7ecd \u4f7f\u7528\u601d\u6e90\u5b98\u65b9\u7684docker\u955c\u50cf\u8fdb\u884c\u90e8\u7f72, \u53ef\u4ee5\u4f7f\u7528docker\u6216\u8005docker-compose. \u4f7f\u7528docker\u76f8\u5bf9\u6765\u8bf4\u6bd4\u8f83\u7b80\u5355, \u4f46\u662f\u4f7f\u7528docker-compose\u53ef\u4ee5\u66f4\u65b9\u4fbf\u7684\u8fdb\u884c\u66f4\u65b0\u8fed\u4ee3. \u5177\u4f53\u9009\u62e9\u54ea\u4e2a\u9700\u8981\u770b\u4e2a\u4eba\u9009\u62e9. \u4e0b\u9762\u4f1a\u4ecb\u7ecd\u5206\u522b\u4f7f\u7528\u4e24\u79cd\u65b9\u5f0f\u8fdb\u884c\u4e91\u7aef\u90e8\u7f72\u4ee5\u53ca\u8f6f\u4ef6\u66f4\u65b0. 2. \u4f7f\u7528docker\u5b89\u88c5 2.1. \u62c9\u53d6siyuan docker\u955c\u50cf[^2] docker pull b3log/siyuan 2.2. \u542f\u52a8\u670d\u52a1 siyuan \u670d\u52a1\u9ed8\u8ba4\u7684workspace\u662f ~/Documents/SiYuan . \u800c\u9ed8\u8ba4\u542f\u52a8\u5bb9\u5668\u65f6\u7684\u7528\u6237\u662f siyuan , workspace\u7684\u8def\u5f84\u5c31\u662f /home/siyuan/Documents/SiYuan . \u6b64\u4f7f, \u5982\u679c\u4f7f\u7528\u5bb9\u5668\u5377\u8fdb\u884cmount, \u5c31\u4f1a\u51fa\u73b0\u6743\u9650\u7684\u95ee\u9898, \u51fa\u73b0\u6587\u4ef6\u65e0\u6cd5\u5199\u5165\u7684\u95ee\u9898. \u5e94\u8be5docker\u91cc\u7684siyuan\u7528\u6237\u65e0\u6cd5\u5199\u5165\u6587\u4ef6\u5230\u4e3b\u673a\u7684mount\u76ee\u5f55\u4e0b. \u56e0\u6b64, \u9700\u8981\u4f7f\u7528root\u7528\u6237\u6765\u542f\u52a8\u5bb9\u5668, \u4f46\u662f\u6b64\u65f6\u7684workspace\u5c31\u4f1a\u53d8\u4e3a /root/Documents/SiYuan , \u56e0\u6b64\u9700\u8981\u624b\u52a8\u6307\u5b9aworkspace\u7684\u8def\u5f84\u4e3a /home/siyuan/Documents/SiYuan \u6b64\u65f6, \u521b\u5efa\u7684Document\u5c31\u5c5e\u4e8eroot\u7528\u6237, \u91cc\u9762\u6240\u6709\u7684\u6570\u636e\u4e5f\u90fd\u5c5e\u4e8eroot\u7528\u6237. \u65b0\u6dfb\u52a0\u7684\u7b14\u8bb0, \u56fe\u7247,\u9644\u4ef6\u7b49\u4e5f\u90fd\u5c5e\u4e8eroot. ![[Pasted image 20220120233133.png]] ![[Pasted image 20220120233254.png]] ![[Pasted image 20220120233353.png]] \u4ee5siyuan\u7528\u6237\u542f\u52a8\u5bb9\u5668\u5e76\u8fdb\u884cmount\u7684\u65b9\u6cd5\u6682\u65f6\u6ca1\u641e\u4f1a, \u9700\u8981\u8fdb\u4e00\u6b65\u7684\u4e86\u89e3docker\u7684\u7528\u6237\u6743\u9650\u673a\u5236. \u6682\u65f6\u80fd\u4f7f\u7528root\u7528\u6237\u5b8c\u6210\u529f\u80fd, \u80fd\u7528\u5373\u53ef. \u6570\u636e\u7684\u5907\u4efd\u4e5fOK. docker run --name siyuan -it -d --restart=always -v /home/siyuan/Documents/SiYuan:/root/Documents/SiYuan -p 6806:6806 b3log/siyuan # mount\u5931\u8d25 docker run --name siyuan -it --restart=always -v /root/SiYuan:/home/siyuan/Documents/SiYuan -p 6806:6806 b3log/siyuan -resident -workspace /home/siyuan/Documents/SiYuan -accessAuthCode bfd6bedb # \u6ca1\u6709\u6743\u9650 docker run --name siyuan -it --user=root --restart=always -v /home/SiYuan:/home/siyuan/Documents/SiYuan -p 6806:6806 b3log/siyuan -workspace /home/siyuan/Documents/SiYuan ## --name siyuan \u542f\u7528\u4e00\u4e2a\u5bb9\u5668\u540d\u4e3a siyuan \u7684\u5bb9\u5668 ## --restart=always \u5bb9\u5668\u81ea\u542f(\u6b63\u5e38\u5199\u7b14\u8bb0\u7684\u65f6\u5019\u601d\u6e90\u670d\u52a1\u6b63\u5e38,\u4f46\u662f\u6211\u5c06\u4e00\u5199markdown\u683c\u5f0f\u9519\u8bef\u7684\u7b14\u8bb0\u7c98\u8d34\u5230\u7b14\u8bb0\u4e2d\u4e4b\u540e,\u6574\u7406\u7b14\u8bb0\u7684\u65f6\u5019\u5076\u5c14\u4f1a\u5d29\u6e83) ## -v /usr/local/siyuan/data/SiYuan:/root/Documents/SiYuan \u5c06\u601d\u6e90\u7b14\u8bb0\u7684\u6570\u636e\u6620\u5c04\u5230\u670d\u52a1\u5668,\u5728\u670d\u52a1\u5668\u7684 /usr/local/siyuan/data/SiYuan \u4e2d\u5c31\u80fd\u770b\u5230\u6240\u6709\u7684\u7b14\u8bb0\u4e86 ## -p 6806:6806 \u7aef\u53e3\u6620\u5c04 ## \u4f7f\u7528\u7684\u5bb9\u5668 b3log/siyuan ## --user=root \u4f7f\u7528root\u7528\u6237\u5f00\u59cb\u5bb9\u5668, \u5426\u5219\u4f1a\u63d0\u793a\u6743\u9650\u95ee\u9898, \u65e0\u6cd5mount \u601d\u6e90\u7b14\u8bb0\u76ee\u524d\u5fc5\u987b\u4f7f\u75286806\u7aef\u53e3, \u5176\u4ed6\u7aef\u53e3\u4f1a\u65e0\u6cd5\u4f7f\u7528 \u542f\u52a8\u4e4b\u540e, \u9700\u8981\u68c0\u67e5\u9632\u706b\u5899\u8bbe\u7f6e, 6806\u53f7\u7aef\u53e3\u662f\u5426\u6253\u5f00, \u5982\u679c\u8bbe\u7f6e\u6b63\u5e38. \u76f4\u63a5 http://ip:6806 \u5373\u53ef\u8bbf\u95ee 2.3. \u6570\u636e\u5907\u4efd # \u8fdb\u5165docker\u67e5\u770b\u6570\u636e docker exec -it siyuan /bin/sh docker stop siyuan cd <siyuan_data_path> sudo tar -zcvf SiYuan.tar.gz ./SiYuan # \u6253\u5305\u6570\u636e\u4e3a\u538b\u7f29\u5305 docker start siyuan \u6570\u636e\u5907\u4efd\u73b0\u5728\u6709\u95ee\u9898. \u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u4e3b\u673a\u7684\u6570\u636e\u6587\u4ef6\u5939\u91cc\u9762\u6ca1\u6709\u6570\u636e. [^2] \u89e3\u51b3\u529e\u6cd5: \u53ef\u80fd\u9700\u8981\u4fee\u6539run\u7684\u547d\u4ee4, \u624b\u52a8\u8bbe\u7f6e\u601d\u6e90\u7684 workspace \u9009\u9879. 2.4. docker\u5347\u7ea7 docker pull b3log/siyuan ## \u62c9\u53d6\u65b0\u7684docker docker stop siyuan ## \u505c\u6b62\u5bb9\u5668 docker rm siyuan ## \u5220\u9664\u5bb9\u5668 ## \u91cd\u65b0\u751f\u6210\u5bb9\u5668 docker run --name siyuan -it -d --restart=always -v /usr/local/software/siyuan/data/SiYuan:/root/Documents/SiYuan -p 6806:6806 b3log/siyuan 3. \u4f7f\u7528docker-compose\u5b89\u88c5 curl -L https://get.daocloud.io/docker/compose/releases/download/1.24.1/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose chmod +x /usr/local/bin/docker-compose version: '3' services: siyuan: image: b3log/siyuan:latest container_name: siyuan restart: always volumes: - /root/SiYuan:/root/Documents/SiYuan command: [--resident=true,--workspace=/root/Documents/SiYuan,--ssl=true,--accessAuthCode=\u6388\u6743\u7801,--servePath=\u7ed1\u5b9a\u57df\u540d] network_mode: \"host\" 4. reference \u601d\u6e90\u7b14\u8bb0 docker \u642d\u5efa\u53ca\u540e\u7eed\u4f7f\u7528\u4f18\u5316\uff08\u5c0f\u767d\u5411\uff09 \u601d\u6e90\u7b14\u8bb0docker\u90e8\u7f72 \u601d\u6e90\u7b14\u8bb0\u793e\u533adocker\u4e13\u680f \u7fa4\u6656docker\u90e8\u7f72\u3001\u5347\u7ea7\u3001\u5916\u7f51\u8bbf\u95ee \u601d\u6e90\u7b14\u8bb0","title":"docker\u5b9e\u6218:\u601d\u6e90\u7b14\u8bb0"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E6%90%AD%E5%BB%BA%E6%80%9D%E6%BA%90%E7%AC%94%E8%AE%B0/#1","text":"\u4f7f\u7528\u601d\u6e90\u5b98\u65b9\u7684docker\u955c\u50cf\u8fdb\u884c\u90e8\u7f72, \u53ef\u4ee5\u4f7f\u7528docker\u6216\u8005docker-compose. \u4f7f\u7528docker\u76f8\u5bf9\u6765\u8bf4\u6bd4\u8f83\u7b80\u5355, \u4f46\u662f\u4f7f\u7528docker-compose\u53ef\u4ee5\u66f4\u65b9\u4fbf\u7684\u8fdb\u884c\u66f4\u65b0\u8fed\u4ee3. \u5177\u4f53\u9009\u62e9\u54ea\u4e2a\u9700\u8981\u770b\u4e2a\u4eba\u9009\u62e9. \u4e0b\u9762\u4f1a\u4ecb\u7ecd\u5206\u522b\u4f7f\u7528\u4e24\u79cd\u65b9\u5f0f\u8fdb\u884c\u4e91\u7aef\u90e8\u7f72\u4ee5\u53ca\u8f6f\u4ef6\u66f4\u65b0.","title":"1. \u4ecb\u7ecd"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E6%90%AD%E5%BB%BA%E6%80%9D%E6%BA%90%E7%AC%94%E8%AE%B0/#2-docker","text":"","title":"2. \u4f7f\u7528docker\u5b89\u88c5"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E6%90%AD%E5%BB%BA%E6%80%9D%E6%BA%90%E7%AC%94%E8%AE%B0/#21-siyuan-docker2","text":"docker pull b3log/siyuan","title":"2.1. \u62c9\u53d6siyuan docker\u955c\u50cf[^2]"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E6%90%AD%E5%BB%BA%E6%80%9D%E6%BA%90%E7%AC%94%E8%AE%B0/#22","text":"siyuan \u670d\u52a1\u9ed8\u8ba4\u7684workspace\u662f ~/Documents/SiYuan . \u800c\u9ed8\u8ba4\u542f\u52a8\u5bb9\u5668\u65f6\u7684\u7528\u6237\u662f siyuan , workspace\u7684\u8def\u5f84\u5c31\u662f /home/siyuan/Documents/SiYuan . \u6b64\u4f7f, \u5982\u679c\u4f7f\u7528\u5bb9\u5668\u5377\u8fdb\u884cmount, \u5c31\u4f1a\u51fa\u73b0\u6743\u9650\u7684\u95ee\u9898, \u51fa\u73b0\u6587\u4ef6\u65e0\u6cd5\u5199\u5165\u7684\u95ee\u9898. \u5e94\u8be5docker\u91cc\u7684siyuan\u7528\u6237\u65e0\u6cd5\u5199\u5165\u6587\u4ef6\u5230\u4e3b\u673a\u7684mount\u76ee\u5f55\u4e0b. \u56e0\u6b64, \u9700\u8981\u4f7f\u7528root\u7528\u6237\u6765\u542f\u52a8\u5bb9\u5668, \u4f46\u662f\u6b64\u65f6\u7684workspace\u5c31\u4f1a\u53d8\u4e3a /root/Documents/SiYuan , \u56e0\u6b64\u9700\u8981\u624b\u52a8\u6307\u5b9aworkspace\u7684\u8def\u5f84\u4e3a /home/siyuan/Documents/SiYuan \u6b64\u65f6, \u521b\u5efa\u7684Document\u5c31\u5c5e\u4e8eroot\u7528\u6237, \u91cc\u9762\u6240\u6709\u7684\u6570\u636e\u4e5f\u90fd\u5c5e\u4e8eroot\u7528\u6237. \u65b0\u6dfb\u52a0\u7684\u7b14\u8bb0, \u56fe\u7247,\u9644\u4ef6\u7b49\u4e5f\u90fd\u5c5e\u4e8eroot. ![[Pasted image 20220120233133.png]] ![[Pasted image 20220120233254.png]] ![[Pasted image 20220120233353.png]] \u4ee5siyuan\u7528\u6237\u542f\u52a8\u5bb9\u5668\u5e76\u8fdb\u884cmount\u7684\u65b9\u6cd5\u6682\u65f6\u6ca1\u641e\u4f1a, \u9700\u8981\u8fdb\u4e00\u6b65\u7684\u4e86\u89e3docker\u7684\u7528\u6237\u6743\u9650\u673a\u5236. \u6682\u65f6\u80fd\u4f7f\u7528root\u7528\u6237\u5b8c\u6210\u529f\u80fd, \u80fd\u7528\u5373\u53ef. \u6570\u636e\u7684\u5907\u4efd\u4e5fOK. docker run --name siyuan -it -d --restart=always -v /home/siyuan/Documents/SiYuan:/root/Documents/SiYuan -p 6806:6806 b3log/siyuan # mount\u5931\u8d25 docker run --name siyuan -it --restart=always -v /root/SiYuan:/home/siyuan/Documents/SiYuan -p 6806:6806 b3log/siyuan -resident -workspace /home/siyuan/Documents/SiYuan -accessAuthCode bfd6bedb # \u6ca1\u6709\u6743\u9650 docker run --name siyuan -it --user=root --restart=always -v /home/SiYuan:/home/siyuan/Documents/SiYuan -p 6806:6806 b3log/siyuan -workspace /home/siyuan/Documents/SiYuan ## --name siyuan \u542f\u7528\u4e00\u4e2a\u5bb9\u5668\u540d\u4e3a siyuan \u7684\u5bb9\u5668 ## --restart=always \u5bb9\u5668\u81ea\u542f(\u6b63\u5e38\u5199\u7b14\u8bb0\u7684\u65f6\u5019\u601d\u6e90\u670d\u52a1\u6b63\u5e38,\u4f46\u662f\u6211\u5c06\u4e00\u5199markdown\u683c\u5f0f\u9519\u8bef\u7684\u7b14\u8bb0\u7c98\u8d34\u5230\u7b14\u8bb0\u4e2d\u4e4b\u540e,\u6574\u7406\u7b14\u8bb0\u7684\u65f6\u5019\u5076\u5c14\u4f1a\u5d29\u6e83) ## -v /usr/local/siyuan/data/SiYuan:/root/Documents/SiYuan \u5c06\u601d\u6e90\u7b14\u8bb0\u7684\u6570\u636e\u6620\u5c04\u5230\u670d\u52a1\u5668,\u5728\u670d\u52a1\u5668\u7684 /usr/local/siyuan/data/SiYuan \u4e2d\u5c31\u80fd\u770b\u5230\u6240\u6709\u7684\u7b14\u8bb0\u4e86 ## -p 6806:6806 \u7aef\u53e3\u6620\u5c04 ## \u4f7f\u7528\u7684\u5bb9\u5668 b3log/siyuan ## --user=root \u4f7f\u7528root\u7528\u6237\u5f00\u59cb\u5bb9\u5668, \u5426\u5219\u4f1a\u63d0\u793a\u6743\u9650\u95ee\u9898, \u65e0\u6cd5mount \u601d\u6e90\u7b14\u8bb0\u76ee\u524d\u5fc5\u987b\u4f7f\u75286806\u7aef\u53e3, \u5176\u4ed6\u7aef\u53e3\u4f1a\u65e0\u6cd5\u4f7f\u7528 \u542f\u52a8\u4e4b\u540e, \u9700\u8981\u68c0\u67e5\u9632\u706b\u5899\u8bbe\u7f6e, 6806\u53f7\u7aef\u53e3\u662f\u5426\u6253\u5f00, \u5982\u679c\u8bbe\u7f6e\u6b63\u5e38. \u76f4\u63a5 http://ip:6806 \u5373\u53ef\u8bbf\u95ee","title":"2.2. \u542f\u52a8\u670d\u52a1"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E6%90%AD%E5%BB%BA%E6%80%9D%E6%BA%90%E7%AC%94%E8%AE%B0/#23","text":"# \u8fdb\u5165docker\u67e5\u770b\u6570\u636e docker exec -it siyuan /bin/sh docker stop siyuan cd <siyuan_data_path> sudo tar -zcvf SiYuan.tar.gz ./SiYuan # \u6253\u5305\u6570\u636e\u4e3a\u538b\u7f29\u5305 docker start siyuan \u6570\u636e\u5907\u4efd\u73b0\u5728\u6709\u95ee\u9898. \u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u4e3b\u673a\u7684\u6570\u636e\u6587\u4ef6\u5939\u91cc\u9762\u6ca1\u6709\u6570\u636e. [^2] \u89e3\u51b3\u529e\u6cd5: \u53ef\u80fd\u9700\u8981\u4fee\u6539run\u7684\u547d\u4ee4, \u624b\u52a8\u8bbe\u7f6e\u601d\u6e90\u7684 workspace \u9009\u9879.","title":"2.3. \u6570\u636e\u5907\u4efd"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E6%90%AD%E5%BB%BA%E6%80%9D%E6%BA%90%E7%AC%94%E8%AE%B0/#24-docker","text":"docker pull b3log/siyuan ## \u62c9\u53d6\u65b0\u7684docker docker stop siyuan ## \u505c\u6b62\u5bb9\u5668 docker rm siyuan ## \u5220\u9664\u5bb9\u5668 ## \u91cd\u65b0\u751f\u6210\u5bb9\u5668 docker run --name siyuan -it -d --restart=always -v /usr/local/software/siyuan/data/SiYuan:/root/Documents/SiYuan -p 6806:6806 b3log/siyuan","title":"2.4. docker\u5347\u7ea7"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E6%90%AD%E5%BB%BA%E6%80%9D%E6%BA%90%E7%AC%94%E8%AE%B0/#3-docker-compose","text":"curl -L https://get.daocloud.io/docker/compose/releases/download/1.24.1/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose chmod +x /usr/local/bin/docker-compose version: '3' services: siyuan: image: b3log/siyuan:latest container_name: siyuan restart: always volumes: - /root/SiYuan:/root/Documents/SiYuan command: [--resident=true,--workspace=/root/Documents/SiYuan,--ssl=true,--accessAuthCode=\u6388\u6743\u7801,--servePath=\u7ed1\u5b9a\u57df\u540d] network_mode: \"host\"","title":"3. \u4f7f\u7528docker-compose\u5b89\u88c5"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E6%90%AD%E5%BB%BA%E6%80%9D%E6%BA%90%E7%AC%94%E8%AE%B0/#4-reference","text":"\u601d\u6e90\u7b14\u8bb0 docker \u642d\u5efa\u53ca\u540e\u7eed\u4f7f\u7528\u4f18\u5316\uff08\u5c0f\u767d\u5411\uff09 \u601d\u6e90\u7b14\u8bb0docker\u90e8\u7f72 \u601d\u6e90\u7b14\u8bb0\u793e\u533adocker\u4e13\u680f \u7fa4\u6656docker\u90e8\u7f72\u3001\u5347\u7ea7\u3001\u5916\u7f51\u8bbf\u95ee \u601d\u6e90\u7b14\u8bb0","title":"4. reference"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/","text":"\u4f5c\u8005: sugar \u8f6c\u8f7d\u8bf7\u8054\u7cfb\u4f5c\u8005(1144392179@qq.com),\u5e76\u8bf4\u660e\u51fa\u5904! 1. docker 1.1. \u542f\u52a8docker docker\u662f\u670d\u52a1\u5668-\u5ba2\u6237\u7aef\u67b6\u6784, \u56e0\u6b64, \u5982\u679c\u9700\u8981\u4f7f\u7528 docker \u547d\u4ee4, \u9700\u8981\u672c\u673a\u542f\u52a8 docker \u670d\u52a1: systemctl start docker #systemctl\u7528\u6cd5 service docker start #service\u7528\u6cd5 \u7531\u4e8edocker\u7684\u542f\u52a8\u9700\u8981sudo\u6743\u9650, \u4e3a\u4e86\u907f\u514d\u6bcf\u6b21\u4f7f\u7528\u90fd\u8f93\u5165sudo, \u53ef\u4ee5\u5c06\u7528\u6237\u52a0\u5165docker\u7528\u6237\u7ec4 sudo usermode -aG docker $USER 2. image Docker \u628a\u5e94\u7528\u7a0b\u5e8f\u53ca\u5176\u4f9d\u8d56\uff0c\u6253\u5305\u5728 image \u6587\u4ef6\u91cc\u9762\u3002\u53ea\u6709\u901a\u8fc7\u8fd9\u4e2a\u6587\u4ef6\uff0c\u624d\u80fd\u751f\u6210 Docker \u5bb9\u5668\u3002image \u6587\u4ef6\u53ef\u4ee5\u770b\u4f5c\u662f\u5bb9\u5668\u7684\u6a21\u677f\u3002Docker \u6839\u636e image \u6587\u4ef6\u751f\u6210\u5bb9\u5668\u7684\u5b9e\u4f8b\u3002\u540c\u4e00\u4e2a image \u6587\u4ef6\uff0c\u53ef\u4ee5\u751f\u6210\u591a\u4e2a\u540c\u65f6\u8fd0\u884c\u7684\u5bb9\u5668\u5b9e\u4f8b\u3002 \u76f8\u5173\u547d\u4ee4:[^3][^1] #\u5217\u51fa\u672c\u673a\u7684\u6240\u6709image docker imags docker images -aq # \u53c2\u6570 -a, --all # \u5217\u51fa\u6240\u6709\u955c\u50cf -q, --quiet # \u53ea\u663e\u793a\u955c\u50cf\u7684ID # \u5220\u9664image docker image rm [imageName] docker rmi -f [imageID] # \u5220\u9664\u6240\u6709\u7684images docker rmi -f $(docker images -aq) [root@sugarlearn ~]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE docker.io/b3log/siyuan latest a35a2a94fc5b 16 hours ago 142 MB docker.io/zmister/mrdoc v1 1f0e4ae2440e 12 days ago 839 MB #\u89e3\u91ca\uff1a - REPOSITORY \u4ed3\u5e93\u6e90 - TAG \u955c\u50cf\u7684\u6807\u7b7e - IMAGE ID \u955c\u50cf\u7684ID - CREATED \u955c\u50cf\u521b\u5efa\u7684\u65f6\u95f4 - SIZE \u955c\u50cf\u7684\u5927\u5c0f 2.1. docler search \u641c\u7d22\u955c\u50cf docker search [imageName] [root@sugarlearn ~]# docker search siyuan INDEX NAME DESCRIPTION STARS OFFICIAL AUTOMATED docker.io docker.io/b3log/siyuan \u601d\u6e90\u7b14\u8bb0 Docker \u955c\u50cf\u3002SiYuan Docker Image. 27 docker.io docker.io/siyuanhuang95/livox_slam This docker offers you a convenient develo... 3 docker.io docker.io/hhxsy/siyuan_xie myRepository 0 docker.io docker.io/lsy643/lsy643 Docker images from Siyuan Li 0 docker.io docker.io/nn200433/siyuan \u57fa\u4e8e b3log/siyuan \uff0c\u5220\u9664\u9ed8\u8ba4siyuan\u7528\u6237 0 docker.io docker.io/siyuan0/learning 0 docker.io docker.io/siyuan0/pytorch_chensy 0 docker.io docker.io/siyuan0322/hello hello world project of docker 0 docker.io docker.io/siyuan0322/mpi 0 docker.io docker.io/siyuan0322/sshd 0 docker.io docker.io/siyuan89/app01 0 docker.io docker.io/siyuanchen726/docker101tutorial 0 docker.io docker.io/siyuangao/cni_challenge 0 docker.io docker.io/siyuangao/cni_challenge_dockerrepo 0 docker.io docker.io/siyuanli/cs503_tensorflow_jupyter 0 docker.io docker.io/siyuanli/onlinejudge 0 docker.io docker.io/siyuanwlw/cheers2019 0 docker.io docker.io/siyuanzhang0519/cheers2019 0 docker.io docker.io/siyuanzhu/friendlyhello 0 docker.io docker.io/siyuanzhu/toy-flask 0 docker.io docker.io/taosiyuan/influxdb Created by siyuan.tao on 2017-3-22 0 docker.io docker.io/xbdz/siyuan \u601d\u6e90\u7b14\u8bb0\u955c\u50cf 0 2.2. docker pull \u4e0b\u8f7d\u955c\u50cf [root@sugarlearn ~]# docker pull jonnyan404/mrdoc Using default tag: latest # \u9ed8\u8ba4\u4e0b\u8f7d\u6700\u65b0\u7248\u672c\uff0c\u5982\u679c\u4e0d\u52a0tag \u5c31\u4e0b\u8f7d\u9ed8\u8ba4\u7684\u6700\u65b0\u7248 Trying to pull repository docker.io/jonnyan404/mrdoc ... latest: Pulling from docker.io/jonnyan404/mrdoc 59bf1c3509f3: Already exists # \u5206\u5c42\u4e0b\u8f7d\uff0c\u5df2\u5b58\u5728\u7684\u5c42\uff0c\u5c31\u65e0\u9700\u91cd\u65b0\u4e0b\u8f7d\uff0c\u8054\u5408\u6587\u4ef6\u7cfb\u7edf\u601d\u60f3 8786870f2876: Pull complete 45d4696938d0: Pull complete ef84af58b2c5: Pull complete c3c9b71b9a69: Pull complete 2f08af9381b7: Pull complete 7c154285520e: Pull complete ab0cf852a137: Pull complete Digest: sha256:dcb21f432b0ba6fb44284b0efe195a3701fda2a91c7c182b05d5fbfad632e328 # \u7b7e\u540d Status: Downloaded newer image for docker.io/jonnyan404/mrdoc:latest # \u771f\u5b9e\u5730\u5740 \u6307\u5b9a\u7248\u672c\u8fdb\u884c\u4e0b\u8f7d docker pull jonnyan404/mrdoc:<version> 2.3. docker\u955c\u50cf\u539f\u7406 2.4. \u751f\u6210\u81ea\u5df1\u7684image [[#5 dockerfile]] 3. container \u6709\u4e86\u955c\u50cf\u624d\u53ef\u4ee5\u521b\u5efa\u5bb9\u5668 3.1. docker \u5bb9\u5668\u7684\u5b58\u50a8\u4f4d\u7f6e docker\u76f8\u5173\u7684\u6240\u6709\u6570\u636e\u90fd\u4fdd\u5b58\u5728\u4e3b\u673a\u7684\u8fd9\u4e2a\u76ee\u5f55: /var/lib/docker/ \u521b\u5efa\u7684\u5bb9\u5668, \u4e0b\u8f7d\u7684\u955c\u50cf\u7b49\u7b49 3.2. docker run docker run [\u53ef\u9009\u53c2\u6570] image # \u53c2\u6570\u8bf4\u660e -name=\"Name\" \u5bb9\u5668\u540d\u5b57, image1 image2\u7528\u6765\u533a\u5206\u5bb9\u5668 -d \u540e\u53f0\u8fd0\u884c -it \u4ea4\u4e92\u5f0f\u8fd0\u884c\u5bb9\u5668 -p \u6307\u5b9a\u5bb9\u5668\u7aef\u53e3 -p \u4e3b\u673a\u7aef\u53e3:\u5bb9\u5668\u7aef\u53e3(\u5e38\u7528) -p \u5bb9\u5668\u7aef\u53e3 -P \u968f\u673a\u6307\u5b9a\u7aef\u53e3 3.3. docker ps docker ps # \u5217\u51fa\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668 docker ps -q # \u53ea\u5217\u51faID 3.4. \u9000\u51fa\u5bb9\u5668 exit # \u505c\u6b62\u8fd0\u884c, \u9000\u51fa\u5bb9\u5668 ctrl + P + Q # \u9000\u51fa\u4e0d\u505c\u6b62 3.5. \u5220\u9664\u5bb9\u5668 docker rm ID docker rm -f $(docker ps -q) docker ps -aq | xargs docker rm 3.6. \u542f\u52a8\u505c\u6b62\u5bb9\u5668 docker start \u5bb9\u5668ID # \u542f\u52a8\u5bb9\u5668 docker restat ID #\u91cd\u542f\u5bb9\u5668 docker stop ID #\u505c\u6b62\u5bb9\u5668 docker kill ID #\u5f3a\u5236\u505c\u6b62 3.7. \u5176\u4ed6\u547d\u4ee4 [root@sugarlearn ~]# docker run -d centos ca6b8a3a36e6b175e1bbbea8106a2365f5f410827a3e27687d61da510b2ae662 [root@sugarlearn ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES # \u95ee\u9898: \u540e\u53f0\u542f\u52a8centos\u955c\u50cf, docker\u5e76\u6ca1\u6709\u542f\u52a8 docker\u4f7f\u7528\u540e\u53f0\u8fd0\u884c, \u5c31\u5fc5\u987b\u6709\u4e00\u4e2a\u524d\u53f0\u8fdb\u7a0b, docker\u53d1\u73b0\u6ca1\u6709\u5e94\u7528,\u5c31\u4f1a\u81ea\u52a8\u505c\u6b62 # \u67e5\u770b\u65e5\u5fd7 [root@sugarlearn ~]# docker logs --help Usage: docker logs [OPTIONS] CONTAINER Fetch the logs of a container Options: --details Show extra details provided to logs -f, --follow Follow log output --help Print usage --since string Show logs since timestamp --tail string Number of lines to show from the end of the logs (default \"all\") -t, --timestamps Show timestamps # \u5199\u4e00\u4e2a\u6301\u7eed\u8fd0\u884c\u7684\u811a\u672c,\u653e\u5165\u540e\u53f0\u8fd0\u884c, \u4f7f\u7528log\u6253\u5370\u65e5\u5fd7 [root@sugarlearn ~]# docker run -d centos /bin/bash -c \"while true; do echo sugar; sleep 1; done\" 2a780fc5f68cd62e0d0a99ece3bb4401283066587276e45de41de8c7498cb57f [root@sugarlearn ~]# docker logs -ft --tail 10 2a780fc5f68cd62e0d0a99ece3bb4401283066587276e45de41de8c7498cb57f 2022-01-19T19:09:02.938158000Z sugar 2022-01-19T19:09:03.941165000Z sugar 2022-01-19T19:09:04.944188000Z sugar 2022-01-19T19:09:05.947294000Z sugar 2022-01-19T19:09:06.950443000Z sugar 2022-01-19T19:09:07.953860000Z sugar 2022-01-19T19:09:08.957836000Z sugar 2022-01-19T19:09:09.961211000Z sugar 2022-01-19T19:09:10.963906000Z sugar 2022-01-19T19:09:11.967134000Z sugar 2022-01-19T19:09:12.971447000Z sugar 2022-01-19T19:09:13.974090000Z sugar # \u67e5\u770b\u5bb9\u5668\u7684\u8fdb\u7a0b\u4fe1\u606f docker top ID # \u67e5\u770b\u5bb9\u5668\u5143\u6570\u636e docker inspect [root@sugarlearn ~]# docker inspect 2a780fc5f68cd62e0d0a99ece3bb4401283066587276e45de41de8c7498cb57f [ { \"Id\": \"2a780fc5f68cd62e0d0a99ece3bb4401283066587276e45de41de8c7498cb57f\", \"Created\": \"2022-01-19T19:08:56.65117041Z\", \"Path\": \"/bin/bash\", \"Args\": [ \"-c\", \"while true; do echo sugar; sleep 1; done\" ], \"State\": { \"Status\": \"running\", \"Running\": true, \"Paused\": false, \"Restarting\": false, \"OOMKilled\": false, \"Dead\": false, \"Pid\": 3374, \"ExitCode\": 0, \"Error\": \"\", \"StartedAt\": \"2022-01-19T19:08:56.91832488Z\", \"FinishedAt\": \"0001-01-01T00:00:00Z\" }, \"Image\": \"sha256:5d0da3dc976460b72c77d94c8a1ad043720b0416bfc16c52c45d4847e53fadb6\", \"ResolvConfPath\": \"/var/lib/docker/containers/2a780fc5f68cd62e0d0a99ece3bb4401283066587276e45de41de8c7498cb57f/resolv.conf\", \"HostnamePath\": \"/var/lib/docker/containers/2a780fc5f68cd62e0d0a99ece3bb4401283066587276e45de41de8c7498cb57f/hostname\", \"HostsPath\": \"/var/lib/docker/containers/2a780fc5f68cd62e0d0a99ece3bb4401283066587276e45de41de8c7498cb57f/hosts\", \"LogPath\": \"\", \"Name\": \"/festive_euler\", \"RestartCount\": 0, \"Driver\": \"overlay2\", \"MountLabel\": \"\", \"ProcessLabel\": \"\", \"AppArmorProfile\": \"\", \"ExecIDs\": null, \"HostConfig\": { \"Binds\": null, \"ContainerIDFile\": \"\", \"LogConfig\": { \"Type\": \"journald\", \"Config\": {} }, \"NetworkMode\": \"default\", \"PortBindings\": {}, \"RestartPolicy\": { \"Name\": \"no\", \"MaximumRetryCount\": 0 }, \"AutoRemove\": false, \"VolumeDriver\": \"\", \"VolumesFrom\": null, \"CapAdd\": null, \"CapDrop\": null, \"Dns\": [], \"DnsOptions\": [], \"DnsSearch\": [], \"ExtraHosts\": null, \"GroupAdd\": null, \"IpcMode\": \"\", \"Cgroup\": \"\", \"Links\": null, \"OomScoreAdj\": 0, \"PidMode\": \"\", \"Privileged\": false, \"PublishAllPorts\": false, \"ReadonlyRootfs\": false, \"SecurityOpt\": null, \"UTSMode\": \"\", \"UsernsMode\": \"\", \"ShmSize\": 67108864, \"Runtime\": \"docker-runc\", \"ConsoleSize\": [ 0, 0 ], \"Isolation\": \"\", \"CpuShares\": 0, \"Memory\": 0, \"NanoCpus\": 0, \"CgroupParent\": \"\", \"BlkioWeight\": 0, \"BlkioWeightDevice\": null, \"BlkioDeviceReadBps\": null, \"BlkioDeviceWriteBps\": null, \"BlkioDeviceReadIOps\": null, \"BlkioDeviceWriteIOps\": null, \"CpuPeriod\": 0, \"CpuQuota\": 0, \"CpuRealtimePeriod\": 0, \"CpuRealtimeRuntime\": 0, \"CpusetCpus\": \"\", \"CpusetMems\": \"\", \"Devices\": [], \"DiskQuota\": 0, \"KernelMemory\": 0, \"MemoryReservation\": 0, \"MemorySwap\": 0, \"MemorySwappiness\": -1, \"OomKillDisable\": false, \"PidsLimit\": 0, \"Ulimits\": null, \"CpuCount\": 0, \"CpuPercent\": 0, \"IOMaximumIOps\": 0, \"IOMaximumBandwidth\": 0 }, \"GraphDriver\": { \"Name\": \"overlay2\", \"Data\": { \"LowerDir\": \"/var/lib/docker/overlay2/619adce5a0d2a1b8745d4f3935c9b1dc6c30c4494e46ce32e68cfaccb80b2853-init/diff:/var/lib/docker/overlay2/34e966a6c48160e1928a33a3bf332e2da80f374b51dbe603cf98e64d4b379fa2/diff\", \"MergedDir\": \"/var/lib/docker/overlay2/619adce5a0d2a1b8745d4f3935c9b1dc6c30c4494e46ce32e68cfaccb80b2853/merged\", \"UpperDir\": \"/var/lib/docker/overlay2/619adce5a0d2a1b8745d4f3935c9b1dc6c30c4494e46ce32e68cfaccb80b2853/diff\", \"WorkDir\": \"/var/lib/docker/overlay2/619adce5a0d2a1b8745d4f3935c9b1dc6c30c4494e46ce32e68cfaccb80b2853/work\" } }, \"Mounts\": [], \"Config\": { \"Hostname\": \"2a780fc5f68c\", \"Domainname\": \"\", \"User\": \"\", \"AttachStdin\": false, \"AttachStdout\": false, \"AttachStderr\": false, \"Tty\": false, \"OpenStdin\": false, \"StdinOnce\": false, \"Env\": [ \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\" ], \"Cmd\": [ \"/bin/bash\", \"-c\", \"while true; do echo sugar; sleep 1; done\" ], \"Image\": \"centos\", \"Volumes\": null, \"WorkingDir\": \"\", \"Entrypoint\": null, \"OnBuild\": null, \"Labels\": { \"org.label-schema.build-date\": \"20210915\", \"org.label-schema.license\": \"GPLv2\", \"org.label-schema.name\": \"CentOS Base Image\", \"org.label-schema.schema-version\": \"1.0\", \"org.label-schema.vendor\": \"CentOS\" } }, \"NetworkSettings\": { \"Bridge\": \"\", \"SandboxID\": \"fc0b45deead7c901e02710a67c6290a197e19d77d8e32266211c617d899c329a\", \"HairpinMode\": false, \"LinkLocalIPv6Address\": \"\", \"LinkLocalIPv6PrefixLen\": 0, \"Ports\": {}, \"SandboxKey\": \"/var/run/docker/netns/fc0b45deead7\", \"SecondaryIPAddresses\": null, \"SecondaryIPv6Addresses\": null, \"EndpointID\": \"da3db9f9ccbbbeb563c2aadfbb8938503cf9b2c82920893e9519a6365ccc3e51\", \"Gateway\": \"172.17.0.1\", \"GlobalIPv6Address\": \"\", \"GlobalIPv6PrefixLen\": 0, \"IPAddress\": \"172.17.0.2\", \"IPPrefixLen\": 16, \"IPv6Gateway\": \"\", \"MacAddress\": \"02:42:ac:11:00:02\", \"Networks\": { \"bridge\": { \"IPAMConfig\": null, \"Links\": null, \"Aliases\": null, \"NetworkID\": \"b0fba45bae2a26e0e2c33eb5cf9050d48159091e9410d031cd83721db0fe436b\", \"EndpointID\": \"da3db9f9ccbbbeb563c2aadfbb8938503cf9b2c82920893e9519a6365ccc3e51\", \"Gateway\": \"172.17.0.1\", \"IPAddress\": \"172.17.0.2\", \"IPPrefixLen\": 16, \"IPv6Gateway\": \"\", \"GlobalIPv6Address\": \"\", \"GlobalIPv6PrefixLen\": 0, \"MacAddress\": \"02:42:ac:11:00:02\" } } } } ] # \u8fdb\u5165\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668 # \u901a\u5e38\u90fd\u662f\u4f7f\u7528\u540e\u53f0\u8fd0\u884c\u7684\u5bb9\u5668, \u9700\u8981\u8fdb\u5165\u540e\u53f0\u8fd0\u884c\u7684\u5bb9\u5668, \u4fee\u6539\u4e00\u4e9b\u914d\u7f6e # method 1: \u8fdb\u5165\u5bb9\u5668, \u5f00\u542f\u65b0\u7684\u7ec8\u7aef, \u53ef\u4ee5\u5728\u91cc\u9762\u64cd\u4f5c docker exec -it containerID # method 2: \u8fdb\u5165\u6b63\u5728\u6267\u884c\u7684\u7ec8\u7aef,\u4e0d\u4f1a\u542f\u52a8\u65b0\u7684\u8fdb\u7a0b docker attach containerID [root@sugarlearn ~]# docker attach 2a780fc5f68c sugar sugar sugar sugar sugar sugar sugar sugar # \u4ece\u5bb9\u5668\u62f7\u8d1d\u6587\u4ef6\u51fa\u6765 docker cp containerID:path host_path # \u542f\u52a8\u5e76\u8fdb\u5165\u5bb9\u5668,\u4e3b\u673a\u540d\u5c31\u662fID\u540d [root@sugarlearn ~]# docker run -it centos /bin/bash [root@8ec75bda8fcd /]# [root@8ec75bda8fcd /]# ls bin dev etc home lib lib64 lost+found media mnt opt proc root run sbin srv sys tmp usr var 4. \u5b9e\u4f8b 4.1. docker\u5b89\u88c5nginx [root@sugarlearn ~]# docker run -d --name nginx01 -p 3344:80 nginx # -p \u4e3b\u673a\u7aef\u53e3:docker\u7aef\u53e3, \u5c06docker\u7684\u7aef\u53e3\u6620\u5c04\u5230\u4e3b\u673a. nginx\u7684\u9ed8\u8ba4\u7aef\u53e3\u4e3a80, \u6620\u5c04\u4e4b\u540e, \u5728\u4e3b\u673a\u76843344\u7aef\u53e3\u53ef\u4ee5\u8bbf\u95ee\u5230\u5bb9\u5668\u768480\u7aef\u53e3 e87155516f5b0c2ea566543eab6f54108ceb997b0dd2e56b78605bf18e09c465 [root@sugarlearn ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES e87155516f5b nginx \"/docker-entrypoin...\" 19 seconds ago Up 19 seconds 0.0.0.0:3344->80/tcp nginx01 [root@sugarlearn ~]# curl localhost:3344 <!DOCTYPE html> <html> <head> <title>Welcome to nginx!</title> <style> html { color-scheme: light dark; } body { width: 35em; margin: 0 auto; font-family: Tahoma, Verdana, Arial, sans-serif; } </style> </head> <body> <h1>Welcome to nginx!</h1> <p>If you see this page, the nginx web server is successfully installed and working. Further configuration is required.</p> <p>For online documentation and support please refer to <a href=\"http://nginx.org/\">nginx.org</a>.<br/> Commercial support is available at <a href=\"http://nginx.com/\">nginx.com</a>.</p> <p><em>Thank you for using nginx.</em></p> </body> </html> [root@sugarlearn ~]# 4.2. docker\u5b89\u88c5tomcat docker run -it --rm tomcat:9.0 # --rm\u8868\u793a\u7528\u5b8c\u5373\u5220, \u505c\u6b62\u5bb9\u5668\u4e4b\u540e,\u7acb\u5373\u5c31\u5220\u9664\u5bb9\u5668. # \u6b63\u5e38\u542f\u52a8tomcat, \u6620\u5c04\u7aef\u53e3\u4e3a3344 docker run -d -p 3344:8080 --name tomcat01 tomcat # \u8fdb\u5165\u5bb9\u5668 docker exrc -it tomcat01 /bin/bash # \u5c06webapp.dist\u91cc\u9762\u7684\u5185\u5bb9\u62f7\u8d1d\u5230webapps\u91cc\u9762, \u6253\u5f00ip:3344\u5373\u53ef\u8bbf\u95ee\u6210\u529f, \u5982\u4e0b\u56fe\u6240\u793a ![[Pasted image 20220120193434.png]] 4.3. docker\u90e8\u7f72es+kibana es\u66b4\u9732\u7684\u7aef\u53e3\u5f88\u591a es\u5341\u5206\u7684\u8017\u5185\u5b58 es\u7684\u6570\u636e\u4e00\u822c\u9700\u8981\u6302\u8f7d\u51fa\u53bb, \u653e\u7f6e\u5230\u5b89\u5168\u76ee\u5f55 docker run -d --name elasticsearch --net somenetwork -p 9200:9200 -p 9300:9300 -e \"discovery.type=single-node\" elasticsearch:tag # --net \u7f51\u7edc\u8bbe\u7f6e # \u53bb\u6389\u7f51\u7edc\u73af\u5883\u8bbe\u7f6e, \u4f7f\u75287.6.2\u7248\u672c docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e \"discovery.type=single-node\" elasticsearch:7.6.2 # \u542f\u52a8\u670d\u52a1\u4e4b\u540e, \u7cfb\u7edf\u8d1f\u8f7d\u5341\u5206\u5927,linux\u76f4\u63a5\u5361\u4f4f\u4e86 # \u4f7f\u7528 docker stats \u67e5\u770bcpu\u7684\u72b6\u6001 docker status # \u6d4b\u8bd5es\u662f\u5426\u6210\u529f # \u5173\u95edes, \u589e\u52a0\u5185\u5b58\u7684\u9650\u5236 docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e \"discovery.type=single-node\" -eES_JAVA_OPTS=\"-Xms64m -Xmx512m\" elasticsearch:7.6.2 5. \u5bb9\u5668\u6570\u636e\u5377 \u6570\u636e\u6301\u4e45\u5316, \u4e0d\u4fdd\u5b58\u5728\u5bb9\u5668\u4e2d \u5377\u6280\u672f: \u76ee\u5f55\u7684\u6302\u8f7d, \u5c06\u5bb9\u5668\u5185\u7684\u76ee\u5f55\u6302\u8f7d\u5230linux\u4e0a\u9762. \u53ef\u4ee5\u5c06\u5bb9\u5668\u7684\u6570\u636e\u548clinux\u5bf9\u5e94\u8def\u5f84\u8fdb\u884c\u540c\u6b65. \u5bb9\u5668\u4e4b\u95f4\u4e5f\u53ef\u4ee5\u8fdb\u884c\u6570\u636e\u5171\u4eab \u6302\u8f7d\u662f\u5c06\u4e3b\u673a\u7684\u8def\u5f84\u6302\u8f7d\u5230\u5bb9\u5668\u5185, \u56e0\u6b64\u4e3b\u673a\u662f source. \u5bb9\u5668\u662f destination 5.1. \u5bb9\u5668\u6570\u636e\u5377\u6302\u8f7d\u5230\u4e3b\u673a 5.1.1. \u65b9\u5f0f1. \u542f\u52a8\u5bb9\u5668\u65f6, \u4f7f\u7528\u547d\u4ee4\u6765\u6302\u8f7d -v docker run -it -v \u4e3b\u673a\u76ee\u5f55:\u5bb9\u5668\u5185\u76ee\u5f55 # \u4f7f\u7528docker inspect \u67e5\u770b\"Mounts\": [ { \"Type\": \"bind\", \"Source\": \"/home/ceshi\", # \u4e3b\u673a\u7684\u5730\u5740 \"Destination\": \"/home\", # \u5bb9\u5668\u7684\u5730\u5740 \"Mode\": \"\", \"RW\": true, \"Propagation\": \"rprivate\" } ], \u6ca1\u6709\u6743\u9650\u5904\u7406\u529e\u6cd5: docker run -it --privileged=true -v /home/ceshi:/home centos /bin/bash . (\u8be5\u65b9\u6cd5\u597d\u50cf\u5931\u6548\u4e86, \u53ef\u4ee5\u5728\u542f\u52a8\u5bb9\u5668\u7684\u65f6\u5019, \u6307\u5b9a\u4ee5root\u7528\u6237\u542f\u52a8, \u5c31\u4f1a\u6709\u6743\u9650\u4e86. ) 5.1.2. \u65b9\u5f0f2. \u901a\u8fc7dockerfile\u8fdb\u884c\u6302\u8f7d dockerfile \u5c31\u662f\u7528\u6765\u6784\u5efadocker\u955c\u50cf\u7684\u6784\u5efa\u6587\u4ef6. \u662f\u547d\u4ee4\u811a\u672c # \u521b\u5efadockerfile\u6587\u4ef6 # \u6587\u4ef6\u5185\u5bb9\u5982\u4e0b # \u6307\u5b9a(\u5927\u5199) \u53c2\u6570 # \u6bcf\u4e2a\u547d\u4ee4\u5c31\u662fimage\u7684\u4e00\u5c42 FROM centos VOLUME [\"volume01\",\"volume02\"] CMD echo \"---end---\" CMD /bin/bash \u8fd0\u884c\u8be5\u811a\u672c, \u751f\u6210\u4e00\u4e2a\u65b0\u7684\u955c\u50cf: \u901a\u8fc7 build \u8fdb\u884c\u955c\u50cf\u7684\u6784\u5efa, -t \u8868\u793a target , \u751f\u6210\u7684\u955c\u50cf\u540d\u548c\u7248\u672c\u53f7\u4e3a shigang/centos:1.0 , \u751f\u6210\u7684\u8def\u5f84 . \u8868\u793a\u5f53\u524d\u8def\u5f84\u4e0b docker build -f dockerfile -t shigang/cantos:1.0 . \u8fd0\u884c\u751f\u6210\u7684image, \u67e5\u770b\u662f\u5426\u6302\u8f7d. \u53ef\u4ee5\u53d1\u73b0\u5728\u6839\u76ee\u5f55\u4e0b\u5df2\u7ecf\u6709\u4e86volume01\u548cvolume02\u4e24\u4e2a\u5377. \u811a\u672c\u4e2d\u5199\u7684\u662f\u533f\u540d\u6302\u8f7d\u65b9\u5f0f. [root@sugarlearn docker-test-volume]# docker ps -a CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 82a6ceebcf8a b3log/siyuan \"/opt/siyuan/kerne...\" 4 hours ago Up 4 hours 0.0.0.0:6806->6806/tcp siyuan 04b9ad86bdb6 zmister/mrdoc:v1 \"sh docker_mrdoc.sh\" 24 hours ago Up 24 hours 0.0.0.0:10086->10086/tcp mrdoc [root@sugarlearn docker-test-volume]# docker run -it 7b064e07c425 /bin/bash [root@c1e73c7792a5 /]# ls -l total 56 lrwxrwxrwx 1 root root 7 Nov 3 2020 bin -> usr/bin drwxr-xr-x 5 root root 360 Jan 20 19:53 dev drwxr-xr-x 1 root root 4096 Jan 20 19:53 etc drwxr-xr-x 2 root root 4096 Nov 3 2020 home lrwxrwxrwx 1 root root 7 Nov 3 2020 lib -> usr/lib lrwxrwxrwx 1 root root 9 Nov 3 2020 lib64 -> usr/lib64 drwx------ 2 root root 4096 Sep 15 14:17 lost+found drwxr-xr-x 2 root root 4096 Nov 3 2020 media drwxr-xr-x 2 root root 4096 Nov 3 2020 mnt drwxr-xr-x 2 root root 4096 Nov 3 2020 opt dr-xr-xr-x 141 root root 0 Jan 20 19:53 proc dr-xr-x--- 2 root root 4096 Sep 15 14:17 root drwxr-xr-x 1 root root 4096 Jan 20 19:53 run lrwxrwxrwx 1 root root 8 Nov 3 2020 sbin -> usr/sbin drwxr-xr-x 2 root root 4096 Nov 3 2020 srv dr-xr-xr-x 13 root root 0 Jan 19 07:39 sys drwxrwxrwt 7 root root 4096 Sep 15 14:17 tmp drwxr-xr-x 12 root root 4096 Sep 15 14:17 usr drwxr-xr-x 20 root root 4096 Sep 15 14:17 var drwxr-xr-x 2 root root 4096 Jan 20 19:53 volume01 drwxr-xr-x 2 root root 4096 Jan 20 19:53 volume02 \u901a\u8fc7 docker inspect ID \u67e5\u770b\u5bb9\u5668\u4fe1\u606f, \u53ef\u4ee5\u53d1\u73b0\u4fe1\u606f\u5df2\u7ecf\u540c\u6b65. \u53ef\u4ee5\u5728\u5bb9\u5668\u4e2dvolume01\u521b\u5efa\u6587\u4ef6\u5939,, \u4e4b\u540e\u518d\u5bbf\u4e3b\u673a\u67e5\u770b\u662f\u5426\u6709\u5bf9\u5e94\u7684\u6587\u4ef6. \"Mounts\": [ { \"Type\": \"volume\", \"Name\": \"a6255c3d8111e65ef8dc62e2d8f0b951899f0c6d36455276daf384c6fc41861a\", \"Source\": \"/var/lib/docker/volumes/a6255c3d8111e65ef8dc62e2d8f0b951899f0c6d36455276daf384c6fc41861a/_data\", \"Destination\": \"volume01\", \"Driver\": \"local\", \"Mode\": \"\", \"RW\": true, \"Propagation\": \"\" }, { \"Type\": \"volume\", \"Name\": \"0ec9fb36ce7235343426da000088f63115d99e603206ee0f9af5dd1bac6b3f4a\", \"Source\": \"/var/lib/docker/volumes/0ec9fb36ce7235343426da000088f63115d99e603206ee0f9af5dd1bac6b3f4a/_data\", \"Destination\": \"volume02\", \"Driver\": \"local\", \"Mode\": \"\", \"RW\": true, \"Propagation\": \"\" } ], 5.2. \u591a\u5bb9\u5668\u4e92\u76f8\u6302\u8f7d \u591a\u4e2a\u5bb9\u5668\u4e4b\u95f4\u540c\u6b65\u6570\u636e, \u4f7f\u7528 --volimes-from \u8868\u793a\u4ece\u53e6\u4e00\u4e2adocker\u5bb9\u5668\u4e2d\u83b7\u53d6\u6302\u8f7d\u76ee\u5f55 \u901a\u8fc7\u542f\u52a8\u4e09\u4e2a\u5bb9\u5668\u6d4b\u8bd5\u5b66\u4e60 \u5728[[#\u65b9\u5f0f2 \u901a\u8fc7dockerfile\u8fdb\u884c\u6302\u8f7d]]\u7684\u65f6\u5019, \u4f7f\u7528dockerfile\u521b\u5efa\u4e86\u81ea\u5df1\u7684image, \u4f7f\u7528\u6211\u4eec\u81ea\u5df1\u521b\u5efa\u7684image\u4e3a\u4f8b, \u8fdb\u884c\u591a\u4e2a\u5bb9\u5668\u7684\u5bb9\u5668\u5377\u6302\u8f7d\u6d4b\u8bd5 \u542f\u52a8\u7b2c\u4e00\u4e2a\u5bb9\u5668 bash # \u9700\u8981\u6ce8\u610f\u7684\u662f, centos\u7cfb\u7edf\u5bb9\u5668\u76f4\u63a5\u4f7f\u7528exit\u9000\u51fa\u540e, \u7531\u4e8e\u6ca1\u6709\u524d\u53f0\u5e94\u7528, \u4f1a\u81ea\u52a8\u505c\u6b62\u8fd0\u884c # \u56e0\u6b64\u9700\u8981\u4f7f\u7528 ctrl + P + Q \u9000\u51fa\u5bb9\u5668 [root@sugarlearn home]# docker run -it --name docker01 7b064e07c425 [root@815381166fd9 /]# ls bin etc lib lost+found mnt proc run srv tmp var volume02 dev home lib64 media opt root sbin sys usr volume01 \u542f\u52a8\u7b2c\u4e8c\u4e2a\u5bb9\u5668, \u53d1\u73b0\u548c\u7b2c\u4e00\u4e2a\u5bb9\u5668\u7684\u6302\u8f7d\u76ee\u5f55\u4e00\u6837 bash [root@sugarlearn home]# docker run -it --name docker02 --volumes-from docker01 7b064e07c425 [root@9b5b20dec559 /]# ls bin etc lib lost+found mnt proc run srv tmp var volume02 dev home lib64 media opt root sbin sys usr volume01 \u5728 docker01 \u4e2d\u7684 volume01 \u4e2d\u6dfb\u52a0\u6587\u4ef6, \u67e5\u770b docker02 \u4e2d\u662f\u5426\u51fa\u73b0. \u5b9e\u9a8c\u7ed3\u679c\u53d1\u73b0, \u4e24\u4e2a\u5bb9\u5668\u7684\u5377\u662f\u4e92\u901a\u7684 ```bash [root@9b5b20dec559 /]# cd volume01 [root@9b5b20dec559 volume01]# ls [root@9b5b20dec559 volume01]# touch 123 [root@9b5b20dec559 volume01]# touch 12345 [root@9b5b20dec559 volume01]# ls 123 12345 [root@9b5b20dec559 volume01]# [root@sugarlearn home]# [root@sugarlearn home]# [root@sugarlearn home]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 9b5b20dec559 7b064e07c425 \"/bin/sh -c /bin/bash\" 4 minutes ago Up 4 minutes docker02 815381166fd9 7b064e07c425 \"/bin/sh -c /bin/bash\" 8 minutes ago Up 8 minutes docker01 82a6ceebcf8a b3log/siyuan \"/opt/siyuan/kerne...\" 5 hours ago Up 4 hours 0.0.0.0:6806->6806/tcp siyuan 04b9ad86bdb6 zmister/mrdoc:v1 \"sh docker_mrdoc.sh\" 24 hours ago Up 24 hours 0.0.0.0:10086->10086/tcp mrdoc [root@sugarlearn home]# docker attach 815381166fd9 [root@815381166fd9 /]# ls bin etc lib lost+found mnt proc run srv tmp var volume02 dev home lib64 media opt root sbin sys usr volume01 [root@815381166fd9 /]# cd volume01/ [root@815381166fd9 volume01]# ls 123 12345 ``` \u521b\u5efadocker03, \u53d1\u73b0\u4e5f\u53ef\u4ee5\u6302\u8f7d bash [root@sugarlearn home]# docker run -it --name docker03 --volumes-from docker01 shigang/centos:1.0 [root@8fbd45b8dd55 /]# ls bin etc lib lost+found mnt proc run srv tmp var volume02 dev home lib64 media opt root sbin sys usr volume01 [root@8fbd45b8dd55 /]# cd volume0 bash: cd: volume0: No such file or directory [root@8fbd45b8dd55 /]# cd volume01 [root@8fbd45b8dd55 volume01]# ls 12038120938 123 12345 aksdjhaskdjh \u5c06dicker01\u5220\u9664\u4e4b\u540e, \u53d1\u73b0\u6570\u636e\u4f9d\u7136\u662f\u5b58\u5728\u7684, docker02\u548c03\u7684\u6570\u636e\u5377\u6302\u8f7d\u4f9d\u7136\u5b58\u5728 5.3. \u5177\u540d\u6302\u8f7d\u548c\u533f\u540d\u6302\u8f7d \u4e00\u822c\u90fd\u4f7f\u7528\u5177\u540d\u6302\u8f7d, \u6b64\u6982\u5ff5\u4e86\u89e3\u5373\u53ef \u533f\u540d\u6302\u8f7d: -v \u5bb9\u5668\u5185\u8def\u5f84 6. dockerfile 6.1. \u6784\u5efa\u6b65\u9aa4: \u7f16\u5199dockerfile\u6587\u4ef6 docker build \u6784\u5efa\u6210\u4e3a\u4e00\u4e2a\u955c\u50cf docker run \u8fd0\u884c\u955c\u50cf docker push \u53d1\u5e03\u955c\u50cf Tip: \u5b98\u65b9\u540d\u5b57\u662fDockerfile, \u4f7f\u7528\u5b98\u65b9\u540d\u5b57, \u5728build\u7684\u65f6\u5019\u5c31\u4e0d\u9700\u8981\u4f7f\u7528 -f \u6307\u5b9a\u6587\u4ef6\u4e86. 6.2. \u67e5\u770b\u5b98\u65b9\u4f8b\u5b50 \u4ee5centos\u4e3a\u4f8b: \u5b98\u65b9\u955c\u50cf\u5730\u5740 \u70b9\u51fb\u5177\u4f53\u7684\u7248\u672c\u53f7\u8fdb\u53bb, \u53d1\u73b0\u662fgithub\u9875\u9762, \u91cc\u9762\u662fdockerfile\u6587\u4ef6 \u5f88\u591a\u5b98\u65b9\u7684\u955c\u50cf\u90fd\u662f\u57fa\u7840\u5305, \u5f88\u591a\u7684\u529f\u80fd\u662f\u6ca1\u6709\u7684, \u6211\u4eec\u901a\u5e38\u4f1a\u642d\u5efa\u81ea\u5df1\u7684\u955c\u50cf ![[Pasted image 20220121043052.png]] ![[Pasted image 20220121043123.png]] FROM scratch ADD centos-7-x86_64-docker.tar.xz / LABEL \\ org.label-schema.schema-version=\"1.0\" \\ org.label-schema.name=\"CentOS Base Image\" \\ org.label-schema.vendor=\"CentOS\" \\ org.label-schema.license=\"GPLv2\" \\ org.label-schema.build-date=\"20201113\" \\ org.opencontainers.image.title=\"CentOS Base Image\" \\ org.opencontainers.image.vendor=\"CentOS\" \\ org.opencontainers.image.licenses=\"GPL-2.0-only\" \\ org.opencontainers.image.created=\"2020-11-13 00:00:00+00:00\" CMD [\"/bin/bash\"] 6.3. dockerfile\u7ec4\u6210 \u57fa\u7840\u77e5\u8bc6: 1. \u6bcf\u4e2a\u5173\u952e\u5b57(\u6307\u4ee4)\u90fd\u5fc5\u987b\u662f\u5927\u5199 2. \u4ece\u4e0a\u5230\u4e0b\u7684\u6267\u884c\u987a\u5e8f 3. # \u8868\u793a\u6ce8\u91ca 4. \u6bcf\u4e2a\u6307\u4ee4\u90fd\u4f1a\u521b\u5efa\u63d0\u4ea4\u4e00\u4e2a\u65b0\u7684 \u955c\u50cf\u5c42 , \u5e76\u63d0\u4ea4. 6.4. dockerfile\u7684\u6307\u4ee4 \u6307\u4ee4\u6c47\u603b: FROM # \u57fa\u7840\u955c\u50cf, \u4e00\u5207\u4ece\u8fd9\u91cc\u6784\u5efa MAINTAINER # \u955c\u50cf\u7684\u4f5c\u8005, \u59d3\u540d+\u90ae\u7bb1 RUN # \u955c\u50cf\u6784\u5efa\u7684\u65f6\u5019 ADD # \u6b65\u9aa4 WORKDIR # \u955c\u50cf\u7684\u5de5\u4f5c\u76ee\u5f55 VOLUME # \u6302\u8f7d\u7684\u76ee\u5f55 EXPOSE # \u66b4\u9732\u7aef\u53e3 CMD # \u6307\u5b9a\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019, \u8fd0\u884c\u7684\u547d\u4ee4, \u53ea\u6709\u6700\u540e\u4e00\u4e2a\u4f1a\u751f\u6548, \u4e14\u53ef\u88ab\u66ff\u4ee3 ENTRYPOINT # \u6307\u5b9a\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019, \u8fd0\u884c\u7684\u547d\u4ee4, \u53ef\u4ee5\u8ffd\u52a0\u547d\u4ee4 ONBUILD # \u5f53\u6784\u5efa\u4e00\u4e2a\u88ab\u7ee7\u627f\u7684dockerfile\u7684\u65f6\u5019, \u5c31\u4f1a\u8fd0\u884c onbuild \u7684\u547d\u4ee4. COPY # \u7c7b\u4f3c\u4e8eadd, \u5c06\u6587\u4ef6\u62f7\u8d1d\u5230\u955c\u50cf\u4e2d ENV # \u6784\u5efa\u7684\u65f6\u5019\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf 6.5. \u4f7f\u7528dockerfile\u6784\u5efa\u81ea\u5df1\u7684centos\u7cfb\u7edf FROM scratch # dockerhub\u4e2d\u7edd\u5927\u591a\u6570\u7684\u955c\u50cf, \u90fd\u662f\u4ece\u6b64\u57fa\u7840\u955c\u50cf\u800c\u6765\u7684 \u521b\u5efa\u81ea\u5df1\u7684centos \u7f16\u5199\u914d\u7f6e\u6587\u4ef6 FROM centos MAINTAINER sugar<1144392179@qq.com> ENV MYPATH /usr/local WORKDIR $MYPATH # \u8bbe\u7f6e\u5de5\u4f5c\u76ee\u5f55, \u5373\u4e3a\u8fdb\u5165\u5bb9\u5668\u5185\u7684\u76ee\u5f55. \u5b98\u65b9\u7684centos\u542f\u52a8\u4e4b\u540e, \u8fdb\u5165\u5bb9\u5668\u5185\u90e8\u4e3a\u6839\u76ee\u5f55, \u901a\u8fc7\u6b64\u8bbe\u7f6e, \u53ef\u4ee5\u5c06\u8fdb\u5165\u5bb9\u5668\u7684\u9ed8\u8ba4\u76ee\u5f55\u8fdb\u884c\u4fee\u6539 RUN yum -y install vim RUN yum -y install net-tools EXPOSE 80 CMD echo $MYPATH CMD echo \"---end---\" CMD /bin/bash \u901a\u8fc7\u6587\u4ef6\u6784\u5efa\u955c\u50cf docker build -f dockfile -t mycentos:0.1 . \u901a\u8fc7\u4e0a\u9762\u7684\u547d\u4ee4, \u4f7f\u7528 dockerfile\u6784\u5efa\u6784\u5efa\u65b0\u7684\u955c\u50cf [root@sugarlearn docker-test-volume]# docker build -f dockerfile -t mycentos:0.1 . Sending build context to Docker daemon 2.048 kB Step 1/10 : FROM centos ---> 5d0da3dc9764 Step 2/10 : MAINTAINER sugar<1144392179@qq.com> ---> Running in b6fcc94bb8a5 ---> 74c30c1cbe48 Removing intermediate container b6fcc94bb8a5 Step 3/10 : ENV MYPATH /usr/local ---> Running in 9f870d79569c ---> 2c28d28d5fd8 Removing intermediate container 9f870d79569c Step 4/10 : WORKDIR $MYPATH ---> dfb3f984beb8 Removing intermediate container dd41b1c38380 Step 5/10 : RUN yum -y install vim ---> Running in b6c7b75645b7 CentOS Linux 8 - AppStream 4.6 MB/s | 8.4 MB 00:01 CentOS Linux 8 - BaseOS 4.0 MB/s | 4.6 MB 00:01 CentOS Linux 8 - Extras 17 kB/s | 10 kB 00:00 Dependencies resolved. ================================================================================ Package Arch Version Repository Size ================================================================================ Installing: vim-enhanced x86_64 2:8.0.1763-16.el8 appstream 1.4 M Installing dependencies: gpm-libs x86_64 1.20.7-17.el8 appstream 39 k vim-common x86_64 2:8.0.1763-16.el8 appstream 6.3 M vim-filesystem noarch 2:8.0.1763-16.el8 appstream 49 k which x86_64 2.21-16.el8 baseos 49 k Transaction Summary ================================================================================ Install 5 Packages Total download size: 7.8 M Installed size: 30 M Downloading Packages: (1/5): gpm-libs-1.20.7-17.el8.x86_64.rpm 221 kB/s | 39 kB 00:00 (2/5): vim-enhanced-8.0.1763-16.el8.x86_64.rpm 4.5 MB/s | 1.4 MB 00:00 (3/5): vim-filesystem-8.0.1763-16.el8.noarch.rp 172 kB/s | 49 kB 00:00 (4/5): which-2.21-16.el8.x86_64.rpm 309 kB/s | 49 kB 00:00 (5/5): vim-common-8.0.1763-16.el8.x86_64.rpm 12 MB/s | 6.3 MB 00:00 -------------------------------------------------------------------------------- Total 5.7 MB/s | 7.8 MB 00:01 warning: /var/cache/dnf/appstream-02e86d1c976ab532/packages/gpm-libs-1.20.7-17.el8.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID 8483c65d: NOKEY CentOS Linux 8 - AppStream 1.6 MB/s | 1.6 kB 00:00 Importing GPG key 0x8483C65D: Userid : \"CentOS (CentOS Official Signing Key) <security@centos.org>\" Fingerprint: 99DB 70FA E1D7 CE22 7FB6 4882 05B5 55B3 8483 C65D From : /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial Key imported successfully Running transaction check Transaction check succeeded. Running transaction test Transaction test succeeded. Running transaction Preparing : 1/1 Installing : which-2.21-16.el8.x86_64 1/5 Installing : vim-filesystem-2:8.0.1763-16.el8.noarch 2/5 Installing : vim-common-2:8.0.1763-16.el8.x86_64 3/5 Installing : gpm-libs-1.20.7-17.el8.x86_64 4/5 Running scriptlet: gpm-libs-1.20.7-17.el8.x86_64 4/5 Installing : vim-enhanced-2:8.0.1763-16.el8.x86_64 5/5 Running scriptlet: vim-enhanced-2:8.0.1763-16.el8.x86_64 5/5 Running scriptlet: vim-common-2:8.0.1763-16.el8.x86_64 5/5 Verifying : gpm-libs-1.20.7-17.el8.x86_64 1/5 Verifying : vim-common-2:8.0.1763-16.el8.x86_64 2/5 Verifying : vim-enhanced-2:8.0.1763-16.el8.x86_64 3/5 Verifying : vim-filesystem-2:8.0.1763-16.el8.noarch 4/5 Verifying : which-2.21-16.el8.x86_64 5/5 Installed: gpm-libs-1.20.7-17.el8.x86_64 vim-common-2:8.0.1763-16.el8.x86_64 vim-enhanced-2:8.0.1763-16.el8.x86_64 vim-filesystem-2:8.0.1763-16.el8.noarch which-2.21-16.el8.x86_64 Complete! ---> 4c7b4ce9b341 Removing intermediate container b6c7b75645b7 Step 6/10 : RUN yum -y install net-tools ---> Running in 44cf17d41b1d Last metadata expiration check: 0:00:10 ago on Mon Jan 24 09:43:16 2022. Dependencies resolved. ================================================================================ Package Architecture Version Repository Size ================================================================================ Installing: net-tools x86_64 2.0-0.52.20160912git.el8 baseos 322 k Transaction Summary ================================================================================ Install 1 Package Total download size: 322 k Installed size: 942 k Downloading Packages: net-tools-2.0-0.52.20160912git.el8.x86_64.rpm 1.2 MB/s | 322 kB 00:00 -------------------------------------------------------------------------------- Total 337 kB/s | 322 kB 00:00 Running transaction check Transaction check succeeded. Running transaction test Transaction test succeeded. Running transaction Preparing : 1/1 Installing : net-tools-2.0-0.52.20160912git.el8.x86_64 1/1 Running scriptlet: net-tools-2.0-0.52.20160912git.el8.x86_64 1/1 Verifying : net-tools-2.0-0.52.20160912git.el8.x86_64 1/1 Installed: net-tools-2.0-0.52.20160912git.el8.x86_64 Complete! ---> e2a85f441e55 Removing intermediate container 44cf17d41b1d Step 7/10 : EXPOSE 80 ---> Running in 96cbdbc3347b ---> 135f028da5a8 Removing intermediate container 96cbdbc3347b Step 8/10 : CMD echo $MYPATH ---> Running in 4d092e681f27 ---> d7877648b301 Removing intermediate container 4d092e681f27 Step 9/10 : CMD echo \"---end---\" ---> Running in 551d9ae06abe ---> c465707419b5 Removing intermediate container 551d9ae06abe Step 10/10 : CMD /bin/bash ---> Running in 3ad32c2be5fd ---> 6996698dfbc1 Removing intermediate container 3ad32c2be5fd Successfully built 6996698dfbc1 . \u6784\u5efa\u955c\u50cf\u4e4b\u540e, \u53ef\u4ee5\u8fdb\u5165\u5bb9\u5668\u67e5\u770b\u547d\u4ee4\u662f\u5426\u5b89\u88c5 [root@sugarlearn docker-test-volume]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE mycentos 0.1 6996698dfbc1 About a minute ago 326 MB [root@sugarlearn docker-test-volume]# docker run -it mycentos:0.1 [root@b22fae9e9ab5 local]# pwd /usr/local [root@b22fae9e9ab5 local]# vim # \u53ef\u4ee5\u53d1\u73b0vim\u5df2\u7ecf\u5b89\u88c5\u4e86 6.6. \u5217\u51fa\u955c\u50cf\u5386\u53f2 [root@sugarlearn docker-test-volume]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE mycentos 0.1 6996698dfbc1 12 minutes ago 326 MB [root@sugarlearn docker-test-volume]# docker history 6996698dfbc1 IMAGE CREATED CREATED BY SIZE COMMENT 6996698dfbc1 12 minutes ago /bin/sh -c #(nop) CMD [\"/bin/sh\" \"-c\" \"/b... 0 B c465707419b5 12 minutes ago /bin/sh -c #(nop) CMD [\"/bin/sh\" \"-c\" \"ec... 0 B d7877648b301 12 minutes ago /bin/sh -c #(nop) CMD [\"/bin/sh\" \"-c\" \"ec... 0 B 135f028da5a8 12 minutes ago /bin/sh -c #(nop) EXPOSE 80/tcp 0 B e2a85f441e55 12 minutes ago /bin/sh -c yum -y install net-tools 28.4 MB 4c7b4ce9b341 12 minutes ago /bin/sh -c yum -y install vim 66.3 MB dfb3f984beb8 13 minutes ago /bin/sh -c #(nop) WORKDIR /usr/local 0 B 2c28d28d5fd8 13 minutes ago /bin/sh -c #(nop) ENV MYPATH=/usr/local 0 B 74c30c1cbe48 13 minutes ago /bin/sh -c #(nop) MAINTAINER sugar<114439... 0 B 5d0da3dc9764 4 months ago /bin/sh -c #(nop) CMD [\"/bin/bash\"] 0 B <missing> 4 months ago /bin/sh -c #(nop) LABEL org.label-schema.... 0 B <missing> 4 months ago /bin/sh -c #(nop) ADD file:805cb5e15fb6e0b... 231 MB [root@sugarlearn docker-test-volume]# \u53ef\u4ee5\u67e5\u770b\u5176\u4ed6\u955c\u50cf\u7684\u6784\u5efa\u8fc7\u7a0b [root@sugarlearn docker-test-volume]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE mycentos 0.1 6996698dfbc1 14 minutes ago 326 MB docker.io/b3log/siyuan latest 68ac87c0ad39 3 days ago 142 MB docker.io/jonnyan404/mrdoc latest a187113ddd2a 7 days ago 864 MB docker.io/zmister/mrdoc v1 1f0e4ae2440e 2 weeks ago 839 MB docker.io/nginx latest 605c77e624dd 3 weeks ago 141 MB docker.io/tomcat latest fb5657adc892 4 weeks ago 680 MB docker.io/centos latest 5d0da3dc9764 4 months ago 231 MB docker.io/jellyfin/jellyfin latest 0aa773b67433 4 months ago 717 MB docker.io/elasticsearch 7.6.2 f29a1ee41030 22 months ago 791 MB [root@sugarlearn docker-test-volume]# docker history 605c77e624dd IMAGE CREATED CREATED BY SIZE COMMENT 605c77e624dd 3 weeks ago /bin/sh -c #(nop) CMD [\"nginx\" \"-g\" \"daem... 0 B <missing> 3 weeks ago /bin/sh -c #(nop) STOPSIGNAL SIGQUIT 0 B <missing> 3 weeks ago /bin/sh -c #(nop) EXPOSE 80 0 B <missing> 3 weeks ago /bin/sh -c #(nop) ENTRYPOINT [\"/docker-en... 0 B <missing> 3 weeks ago /bin/sh -c #(nop) COPY file:09a214a3e07c91... 4.61 kB <missing> 3 weeks ago /bin/sh -c #(nop) COPY file:0fd5fca330dcd6... 1.04 kB <missing> 3 weeks ago /bin/sh -c #(nop) COPY file:0b866ff3fc1ef5... 1.96 kB <missing> 3 weeks ago /bin/sh -c #(nop) COPY file:65504f71f5855c... 1.2 kB <missing> 3 weeks ago /bin/sh -c set -x && addgroup --system... 61.1 MB <missing> 3 weeks ago /bin/sh -c #(nop) ENV PKG_RELEASE=1~bullseye 0 B <missing> 3 weeks ago /bin/sh -c #(nop) ENV NJS_VERSION=0.7.1 0 B <missing> 3 weeks ago /bin/sh -c #(nop) ENV NGINX_VERSION=1.21.5 0 B <missing> 4 weeks ago /bin/sh -c #(nop) LABEL maintainer=NGINX ... 0 B <missing> 4 weeks ago /bin/sh -c #(nop) CMD [\"bash\"] 0 B <missing> 4 weeks ago /bin/sh -c #(nop) ADD file:09675d11695f65c... 80.4 MB [root@sugarlearn docker-test-volume]# 6.7. CMD\u548cENTRYPOINT\u7684\u533a\u522b dockerfile\u4e2d\u4e00\u4e0b\u4e24\u4e2a\u547d\u4ee4\u7684\u533a\u522b CMD # \u6307\u5b9a\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019, \u8fd0\u884c\u7684\u547d\u4ee4, \u53ea\u6709\u6700\u540e\u4e00\u4e2a\u4f1a\u751f\u6548, \u4e14\u53ef\u88ab\u66ff\u4ee3 ENTRYPOINT # \u6307\u5b9a\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019, \u8fd0\u884c\u7684\u547d\u4ee4, \u53ef\u4ee5\u8ffd\u52a0\u547d\u4ee4 \u6d4b\u8bd5cmd : \u53ef\u4ee5\u770b\u5230, \u542f\u52a8\u955c\u50cf\u4e4b\u540e, \u76f4\u63a5\u6267\u884c\u4e86CMD\u4e2d\u7684\u547d\u4ee4, \u5de5\u4f5c\u76ee\u5f55\u7684\u6587\u4ef6\u5217\u4e86\u51fa\u6765 \u6784\u5efadockerfile\u7528\u6765\u6d4b\u8bd5 FROM centos CMD [\"ls\",\"-a\"] \u6784\u5efa\u5e76\u542f\u52a8\u955c\u50cf [root@sugarlearn docker-test-volume]# docker build -f dockerfile_cmd -t cmdtest:1.0 . Sending build context to Docker daemon 3.072 kB Step 1/2 : FROM centos ---> 5d0da3dc9764 Step 2/2 : CMD ls -a ---> Running in 436ea9052803 ---> 9da23cd6ea1d Removing intermediate container 436ea9052803 Successfully built 9da23cd6ea1d [root@sugarlearn docker-test-volume]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE cmdtest 1.0 9da23cd6ea1d 5 seconds ago 231 MB mycentos 0.1 6996698dfbc1 17 minutes ago 326 MB docker.io/b3log/siyuan latest 68ac87c0ad39 3 days ago 142 MB docker.io/jonnyan404/mrdoc latest a187113ddd2a 7 days ago 864 MB docker.io/zmister/mrdoc v1 1f0e4ae2440e 2 weeks ago 839 MB docker.io/nginx latest 605c77e624dd 3 weeks ago 141 MB docker.io/tomcat latest fb5657adc892 4 weeks ago 680 MB docker.io/centos latest 5d0da3dc9764 4 months ago 231 MB docker.io/jellyfin/jellyfin latest 0aa773b67433 4 months ago 717 MB docker.io/elasticsearch 7.6.2 f29a1ee41030 22 months ago 791 MB [root@sugarlearn docker-test-volume]# docker run 9da23cd6ea1d . .. .dockerenv bin dev etc home lib lib64 lost+found media mnt opt proc root run sbin srv sys tmp usr var [root@sugarlearn docker-test-volume]# dockerfile\u4e2d\u6267\u884c\u7684\u547d\u4ee4\u4e3a ls -a , \u5982\u679c\u60f3\u8ffd\u52a0\u547d\u4ee4\u4e3a ls -al , \u6d4b\u8bd5\u4e00\u4e0b, \u53d1\u73b0\u4f1a\u62a5\u9519. \u4f7f\u7528CMD\u7684\u60c5\u51b5\u4e0b, -l \u4f1a\u66ff\u6362 CMD\u4e2d\u7684\u547d\u4ee4[\"ls\",\"-a\"], \u5c06 -l \u8ba4\u5b9a\u4e3a\u4e00\u4e2a\u547d\u4ee4, \u4f46\u662f\u627e\u4e0d\u5230\u6b64\u547d\u4ee4, \u6240\u4ee5\u4f1a\u62a5\u9519. \u5982\u679c\u60f3\u8981 ls -al \u5219\u5fc5\u987b\u8f93\u5165\u5b8c\u6574\u7684\u547d\u4ee4. [root@sugarlearn docker-test-volume]# docker run 9da23cd6ea1d -l container_linux.go:235: starting container process caused \"exec: \\\"-l\\\": executable file not found in $PATH\" /usr/bin/docker-current: Error response from daemon: oci runtime error: container_linux.go:235: starting container process caused \"exec: \\\"-l\\\": executable file not found in $PATH\". [root@sugarlearn docker-test-volume]# docker run 9da23cd6ea1d ls -al total 56 drwxr-xr-x 1 root root 4096 Jan 24 10:12 . drwxr-xr-x 1 root root 4096 Jan 24 10:12 .. -rwxr-xr-x 1 root root 0 Jan 24 10:12 .dockerenv lrwxrwxrwx 1 root root 7 Nov 3 2020 bin -> usr/bin drwxr-xr-x 5 root root 340 Jan 24 10:12 dev drwxr-xr-x 1 root root 4096 Jan 24 10:12 etc drwxr-xr-x 2 root root 4096 Nov 3 2020 home lrwxrwxrwx 1 root root 7 Nov 3 2020 lib -> usr/lib lrwxrwxrwx 1 root root 9 Nov 3 2020 lib64 -> usr/lib64 drwx------ 2 root root 4096 Sep 15 14:17 lost+found drwxr-xr-x 2 root root 4096 Nov 3 2020 media drwxr-xr-x 2 root root 4096 Nov 3 2020 mnt drwxr-xr-x 2 root root 4096 Nov 3 2020 opt dr-xr-xr-x 148 root root 0 Jan 24 10:12 proc dr-xr-x--- 2 root root 4096 Sep 15 14:17 root drwxr-xr-x 1 root root 4096 Jan 24 10:12 run lrwxrwxrwx 1 root root 8 Nov 3 2020 sbin -> usr/sbin drwxr-xr-x 2 root root 4096 Nov 3 2020 srv dr-xr-xr-x 13 root root 0 Jan 19 07:39 sys drwxrwxrwt 7 root root 4096 Sep 15 14:17 tmp drwxr-xr-x 12 root root 4096 Sep 15 14:17 usr drwxr-xr-x 20 root root 4096 Sep 15 14:17 var \u6d4b\u8bd5ENTRYPOINT \u4e0a\u8ff0\u4f7f\u7528CMD\u8ffd\u52a0\u547d\u4ee4\u7684\u65f6\u5019, \u4f1a\u5c06\u547d\u4ee4\u66ff\u6362\u6389, \u4f46\u662f\u4f7f\u7528ENTRYPOINT\u5219\u53ef\u4ee5\u8ffd\u52a0\u547d\u4ee4. \u6d4b\u8bd5\u4e00\u4e0b. \u9996\u5148\u7f16\u5199dockerfile FROM centos CMD [\"ls\",\"-a\"] \u6784\u5efa\u5e76\u6267\u884c\u955c\u50cf, \u53ef\u4ee5\u53d1\u73b0, \u8ffd\u52a0 -l \u53ef\u4ee5\u6b63\u786e\u7684\u6267\u884c\u547d\u4ee4, \u4e0d\u4f1a\u8986\u76d6\u539f\u6765\u7684\u547d\u4ee4 [root@sugarlearn docker-test-volume]# docker run entrypoint . .. .dockerenv bin dev etc home lib lib64 lost+found media mnt opt proc root run sbin srv sys tmp usr var [root@sugarlearn docker-test-volume]# docker run entrypoint -l total 56 drwxr-xr-x 1 root root 4096 Jan 24 10:15 . drwxr-xr-x 1 root root 4096 Jan 24 10:15 .. -rwxr-xr-x 1 root root 0 Jan 24 10:15 .dockerenv lrwxrwxrwx 1 root root 7 Nov 3 2020 bin -> usr/bin drwxr-xr-x 5 root root 340 Jan 24 10:15 dev drwxr-xr-x 1 root root 4096 Jan 24 10:15 etc drwxr-xr-x 2 root root 4096 Nov 3 2020 home lrwxrwxrwx 1 root root 7 Nov 3 2020 lib -> usr/lib lrwxrwxrwx 1 root root 9 Nov 3 2020 lib64 -> usr/lib64 drwx------ 2 root root 4096 Sep 15 14:17 lost+found drwxr-xr-x 2 root root 4096 Nov 3 2020 media drwxr-xr-x 2 root root 4096 Nov 3 2020 mnt drwxr-xr-x 2 root root 4096 Nov 3 2020 opt dr-xr-xr-x 147 root root 0 Jan 24 10:15 proc dr-xr-x--- 2 root root 4096 Sep 15 14:17 root drwxr-xr-x 1 root root 4096 Jan 24 10:15 run lrwxrwxrwx 1 root root 8 Nov 3 2020 sbin -> usr/sbin drwxr-xr-x 2 root root 4096 Nov 3 2020 srv dr-xr-xr-x 13 root root 0 Jan 19 07:39 sys drwxrwxrwt 7 root root 4096 Sep 15 14:17 tmp drwxr-xr-x 12 root root 4096 Sep 15 14:17 usr drwxr-xr-x 20 root root 4096 Sep 15 14:17 var 7. reference docker\u4f7f\u7528\u6307\u5357 docker\u5efa\u7ad9 \u6c42\u6c42\u4f60\u4e86\uff0c\u7528Docker\u5427 \u72c2\u795e\u8bf4docker\u89c6\u9891 \u5b98\u65b9\u5e2e\u52a9\u6587\u6863","title":"docker_notes"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#1-docker","text":"","title":"1. docker"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#11-docker","text":"docker\u662f\u670d\u52a1\u5668-\u5ba2\u6237\u7aef\u67b6\u6784, \u56e0\u6b64, \u5982\u679c\u9700\u8981\u4f7f\u7528 docker \u547d\u4ee4, \u9700\u8981\u672c\u673a\u542f\u52a8 docker \u670d\u52a1: systemctl start docker #systemctl\u7528\u6cd5 service docker start #service\u7528\u6cd5 \u7531\u4e8edocker\u7684\u542f\u52a8\u9700\u8981sudo\u6743\u9650, \u4e3a\u4e86\u907f\u514d\u6bcf\u6b21\u4f7f\u7528\u90fd\u8f93\u5165sudo, \u53ef\u4ee5\u5c06\u7528\u6237\u52a0\u5165docker\u7528\u6237\u7ec4 sudo usermode -aG docker $USER","title":"1.1. \u542f\u52a8docker"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#2-image","text":"Docker \u628a\u5e94\u7528\u7a0b\u5e8f\u53ca\u5176\u4f9d\u8d56\uff0c\u6253\u5305\u5728 image \u6587\u4ef6\u91cc\u9762\u3002\u53ea\u6709\u901a\u8fc7\u8fd9\u4e2a\u6587\u4ef6\uff0c\u624d\u80fd\u751f\u6210 Docker \u5bb9\u5668\u3002image \u6587\u4ef6\u53ef\u4ee5\u770b\u4f5c\u662f\u5bb9\u5668\u7684\u6a21\u677f\u3002Docker \u6839\u636e image \u6587\u4ef6\u751f\u6210\u5bb9\u5668\u7684\u5b9e\u4f8b\u3002\u540c\u4e00\u4e2a image \u6587\u4ef6\uff0c\u53ef\u4ee5\u751f\u6210\u591a\u4e2a\u540c\u65f6\u8fd0\u884c\u7684\u5bb9\u5668\u5b9e\u4f8b\u3002 \u76f8\u5173\u547d\u4ee4:[^3][^1] #\u5217\u51fa\u672c\u673a\u7684\u6240\u6709image docker imags docker images -aq # \u53c2\u6570 -a, --all # \u5217\u51fa\u6240\u6709\u955c\u50cf -q, --quiet # \u53ea\u663e\u793a\u955c\u50cf\u7684ID # \u5220\u9664image docker image rm [imageName] docker rmi -f [imageID] # \u5220\u9664\u6240\u6709\u7684images docker rmi -f $(docker images -aq) [root@sugarlearn ~]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE docker.io/b3log/siyuan latest a35a2a94fc5b 16 hours ago 142 MB docker.io/zmister/mrdoc v1 1f0e4ae2440e 12 days ago 839 MB #\u89e3\u91ca\uff1a - REPOSITORY \u4ed3\u5e93\u6e90 - TAG \u955c\u50cf\u7684\u6807\u7b7e - IMAGE ID \u955c\u50cf\u7684ID - CREATED \u955c\u50cf\u521b\u5efa\u7684\u65f6\u95f4 - SIZE \u955c\u50cf\u7684\u5927\u5c0f","title":"2. image"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#21-docler-search","text":"docker search [imageName] [root@sugarlearn ~]# docker search siyuan INDEX NAME DESCRIPTION STARS OFFICIAL AUTOMATED docker.io docker.io/b3log/siyuan \u601d\u6e90\u7b14\u8bb0 Docker \u955c\u50cf\u3002SiYuan Docker Image. 27 docker.io docker.io/siyuanhuang95/livox_slam This docker offers you a convenient develo... 3 docker.io docker.io/hhxsy/siyuan_xie myRepository 0 docker.io docker.io/lsy643/lsy643 Docker images from Siyuan Li 0 docker.io docker.io/nn200433/siyuan \u57fa\u4e8e b3log/siyuan \uff0c\u5220\u9664\u9ed8\u8ba4siyuan\u7528\u6237 0 docker.io docker.io/siyuan0/learning 0 docker.io docker.io/siyuan0/pytorch_chensy 0 docker.io docker.io/siyuan0322/hello hello world project of docker 0 docker.io docker.io/siyuan0322/mpi 0 docker.io docker.io/siyuan0322/sshd 0 docker.io docker.io/siyuan89/app01 0 docker.io docker.io/siyuanchen726/docker101tutorial 0 docker.io docker.io/siyuangao/cni_challenge 0 docker.io docker.io/siyuangao/cni_challenge_dockerrepo 0 docker.io docker.io/siyuanli/cs503_tensorflow_jupyter 0 docker.io docker.io/siyuanli/onlinejudge 0 docker.io docker.io/siyuanwlw/cheers2019 0 docker.io docker.io/siyuanzhang0519/cheers2019 0 docker.io docker.io/siyuanzhu/friendlyhello 0 docker.io docker.io/siyuanzhu/toy-flask 0 docker.io docker.io/taosiyuan/influxdb Created by siyuan.tao on 2017-3-22 0 docker.io docker.io/xbdz/siyuan \u601d\u6e90\u7b14\u8bb0\u955c\u50cf 0","title":"2.1. docler search \u641c\u7d22\u955c\u50cf"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#22-docker-pull","text":"[root@sugarlearn ~]# docker pull jonnyan404/mrdoc Using default tag: latest # \u9ed8\u8ba4\u4e0b\u8f7d\u6700\u65b0\u7248\u672c\uff0c\u5982\u679c\u4e0d\u52a0tag \u5c31\u4e0b\u8f7d\u9ed8\u8ba4\u7684\u6700\u65b0\u7248 Trying to pull repository docker.io/jonnyan404/mrdoc ... latest: Pulling from docker.io/jonnyan404/mrdoc 59bf1c3509f3: Already exists # \u5206\u5c42\u4e0b\u8f7d\uff0c\u5df2\u5b58\u5728\u7684\u5c42\uff0c\u5c31\u65e0\u9700\u91cd\u65b0\u4e0b\u8f7d\uff0c\u8054\u5408\u6587\u4ef6\u7cfb\u7edf\u601d\u60f3 8786870f2876: Pull complete 45d4696938d0: Pull complete ef84af58b2c5: Pull complete c3c9b71b9a69: Pull complete 2f08af9381b7: Pull complete 7c154285520e: Pull complete ab0cf852a137: Pull complete Digest: sha256:dcb21f432b0ba6fb44284b0efe195a3701fda2a91c7c182b05d5fbfad632e328 # \u7b7e\u540d Status: Downloaded newer image for docker.io/jonnyan404/mrdoc:latest # \u771f\u5b9e\u5730\u5740 \u6307\u5b9a\u7248\u672c\u8fdb\u884c\u4e0b\u8f7d docker pull jonnyan404/mrdoc:<version>","title":"2.2. docker pull \u4e0b\u8f7d\u955c\u50cf"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#23-docker","text":"","title":"2.3. docker\u955c\u50cf\u539f\u7406"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#24-image","text":"[[#5 dockerfile]]","title":"2.4. \u751f\u6210\u81ea\u5df1\u7684image"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#3-container","text":"\u6709\u4e86\u955c\u50cf\u624d\u53ef\u4ee5\u521b\u5efa\u5bb9\u5668","title":"3. container"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#31-docker","text":"docker\u76f8\u5173\u7684\u6240\u6709\u6570\u636e\u90fd\u4fdd\u5b58\u5728\u4e3b\u673a\u7684\u8fd9\u4e2a\u76ee\u5f55: /var/lib/docker/ \u521b\u5efa\u7684\u5bb9\u5668, \u4e0b\u8f7d\u7684\u955c\u50cf\u7b49\u7b49","title":"3.1. docker \u5bb9\u5668\u7684\u5b58\u50a8\u4f4d\u7f6e"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#32-docker-run","text":"docker run [\u53ef\u9009\u53c2\u6570] image # \u53c2\u6570\u8bf4\u660e -name=\"Name\" \u5bb9\u5668\u540d\u5b57, image1 image2\u7528\u6765\u533a\u5206\u5bb9\u5668 -d \u540e\u53f0\u8fd0\u884c -it \u4ea4\u4e92\u5f0f\u8fd0\u884c\u5bb9\u5668 -p \u6307\u5b9a\u5bb9\u5668\u7aef\u53e3 -p \u4e3b\u673a\u7aef\u53e3:\u5bb9\u5668\u7aef\u53e3(\u5e38\u7528) -p \u5bb9\u5668\u7aef\u53e3 -P \u968f\u673a\u6307\u5b9a\u7aef\u53e3","title":"3.2. docker run"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#33-docker-ps","text":"docker ps # \u5217\u51fa\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668 docker ps -q # \u53ea\u5217\u51faID","title":"3.3. docker ps"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#34","text":"exit # \u505c\u6b62\u8fd0\u884c, \u9000\u51fa\u5bb9\u5668 ctrl + P + Q # \u9000\u51fa\u4e0d\u505c\u6b62","title":"3.4. \u9000\u51fa\u5bb9\u5668"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#35","text":"docker rm ID docker rm -f $(docker ps -q) docker ps -aq | xargs docker rm","title":"3.5. \u5220\u9664\u5bb9\u5668"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#36","text":"docker start \u5bb9\u5668ID # \u542f\u52a8\u5bb9\u5668 docker restat ID #\u91cd\u542f\u5bb9\u5668 docker stop ID #\u505c\u6b62\u5bb9\u5668 docker kill ID #\u5f3a\u5236\u505c\u6b62","title":"3.6. \u542f\u52a8\u505c\u6b62\u5bb9\u5668"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#37","text":"[root@sugarlearn ~]# docker run -d centos ca6b8a3a36e6b175e1bbbea8106a2365f5f410827a3e27687d61da510b2ae662 [root@sugarlearn ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES # \u95ee\u9898: \u540e\u53f0\u542f\u52a8centos\u955c\u50cf, docker\u5e76\u6ca1\u6709\u542f\u52a8 docker\u4f7f\u7528\u540e\u53f0\u8fd0\u884c, \u5c31\u5fc5\u987b\u6709\u4e00\u4e2a\u524d\u53f0\u8fdb\u7a0b, docker\u53d1\u73b0\u6ca1\u6709\u5e94\u7528,\u5c31\u4f1a\u81ea\u52a8\u505c\u6b62 # \u67e5\u770b\u65e5\u5fd7 [root@sugarlearn ~]# docker logs --help Usage: docker logs [OPTIONS] CONTAINER Fetch the logs of a container Options: --details Show extra details provided to logs -f, --follow Follow log output --help Print usage --since string Show logs since timestamp --tail string Number of lines to show from the end of the logs (default \"all\") -t, --timestamps Show timestamps # \u5199\u4e00\u4e2a\u6301\u7eed\u8fd0\u884c\u7684\u811a\u672c,\u653e\u5165\u540e\u53f0\u8fd0\u884c, \u4f7f\u7528log\u6253\u5370\u65e5\u5fd7 [root@sugarlearn ~]# docker run -d centos /bin/bash -c \"while true; do echo sugar; sleep 1; done\" 2a780fc5f68cd62e0d0a99ece3bb4401283066587276e45de41de8c7498cb57f [root@sugarlearn ~]# docker logs -ft --tail 10 2a780fc5f68cd62e0d0a99ece3bb4401283066587276e45de41de8c7498cb57f 2022-01-19T19:09:02.938158000Z sugar 2022-01-19T19:09:03.941165000Z sugar 2022-01-19T19:09:04.944188000Z sugar 2022-01-19T19:09:05.947294000Z sugar 2022-01-19T19:09:06.950443000Z sugar 2022-01-19T19:09:07.953860000Z sugar 2022-01-19T19:09:08.957836000Z sugar 2022-01-19T19:09:09.961211000Z sugar 2022-01-19T19:09:10.963906000Z sugar 2022-01-19T19:09:11.967134000Z sugar 2022-01-19T19:09:12.971447000Z sugar 2022-01-19T19:09:13.974090000Z sugar # \u67e5\u770b\u5bb9\u5668\u7684\u8fdb\u7a0b\u4fe1\u606f docker top ID # \u67e5\u770b\u5bb9\u5668\u5143\u6570\u636e docker inspect [root@sugarlearn ~]# docker inspect 2a780fc5f68cd62e0d0a99ece3bb4401283066587276e45de41de8c7498cb57f [ { \"Id\": \"2a780fc5f68cd62e0d0a99ece3bb4401283066587276e45de41de8c7498cb57f\", \"Created\": \"2022-01-19T19:08:56.65117041Z\", \"Path\": \"/bin/bash\", \"Args\": [ \"-c\", \"while true; do echo sugar; sleep 1; done\" ], \"State\": { \"Status\": \"running\", \"Running\": true, \"Paused\": false, \"Restarting\": false, \"OOMKilled\": false, \"Dead\": false, \"Pid\": 3374, \"ExitCode\": 0, \"Error\": \"\", \"StartedAt\": \"2022-01-19T19:08:56.91832488Z\", \"FinishedAt\": \"0001-01-01T00:00:00Z\" }, \"Image\": \"sha256:5d0da3dc976460b72c77d94c8a1ad043720b0416bfc16c52c45d4847e53fadb6\", \"ResolvConfPath\": \"/var/lib/docker/containers/2a780fc5f68cd62e0d0a99ece3bb4401283066587276e45de41de8c7498cb57f/resolv.conf\", \"HostnamePath\": \"/var/lib/docker/containers/2a780fc5f68cd62e0d0a99ece3bb4401283066587276e45de41de8c7498cb57f/hostname\", \"HostsPath\": \"/var/lib/docker/containers/2a780fc5f68cd62e0d0a99ece3bb4401283066587276e45de41de8c7498cb57f/hosts\", \"LogPath\": \"\", \"Name\": \"/festive_euler\", \"RestartCount\": 0, \"Driver\": \"overlay2\", \"MountLabel\": \"\", \"ProcessLabel\": \"\", \"AppArmorProfile\": \"\", \"ExecIDs\": null, \"HostConfig\": { \"Binds\": null, \"ContainerIDFile\": \"\", \"LogConfig\": { \"Type\": \"journald\", \"Config\": {} }, \"NetworkMode\": \"default\", \"PortBindings\": {}, \"RestartPolicy\": { \"Name\": \"no\", \"MaximumRetryCount\": 0 }, \"AutoRemove\": false, \"VolumeDriver\": \"\", \"VolumesFrom\": null, \"CapAdd\": null, \"CapDrop\": null, \"Dns\": [], \"DnsOptions\": [], \"DnsSearch\": [], \"ExtraHosts\": null, \"GroupAdd\": null, \"IpcMode\": \"\", \"Cgroup\": \"\", \"Links\": null, \"OomScoreAdj\": 0, \"PidMode\": \"\", \"Privileged\": false, \"PublishAllPorts\": false, \"ReadonlyRootfs\": false, \"SecurityOpt\": null, \"UTSMode\": \"\", \"UsernsMode\": \"\", \"ShmSize\": 67108864, \"Runtime\": \"docker-runc\", \"ConsoleSize\": [ 0, 0 ], \"Isolation\": \"\", \"CpuShares\": 0, \"Memory\": 0, \"NanoCpus\": 0, \"CgroupParent\": \"\", \"BlkioWeight\": 0, \"BlkioWeightDevice\": null, \"BlkioDeviceReadBps\": null, \"BlkioDeviceWriteBps\": null, \"BlkioDeviceReadIOps\": null, \"BlkioDeviceWriteIOps\": null, \"CpuPeriod\": 0, \"CpuQuota\": 0, \"CpuRealtimePeriod\": 0, \"CpuRealtimeRuntime\": 0, \"CpusetCpus\": \"\", \"CpusetMems\": \"\", \"Devices\": [], \"DiskQuota\": 0, \"KernelMemory\": 0, \"MemoryReservation\": 0, \"MemorySwap\": 0, \"MemorySwappiness\": -1, \"OomKillDisable\": false, \"PidsLimit\": 0, \"Ulimits\": null, \"CpuCount\": 0, \"CpuPercent\": 0, \"IOMaximumIOps\": 0, \"IOMaximumBandwidth\": 0 }, \"GraphDriver\": { \"Name\": \"overlay2\", \"Data\": { \"LowerDir\": \"/var/lib/docker/overlay2/619adce5a0d2a1b8745d4f3935c9b1dc6c30c4494e46ce32e68cfaccb80b2853-init/diff:/var/lib/docker/overlay2/34e966a6c48160e1928a33a3bf332e2da80f374b51dbe603cf98e64d4b379fa2/diff\", \"MergedDir\": \"/var/lib/docker/overlay2/619adce5a0d2a1b8745d4f3935c9b1dc6c30c4494e46ce32e68cfaccb80b2853/merged\", \"UpperDir\": \"/var/lib/docker/overlay2/619adce5a0d2a1b8745d4f3935c9b1dc6c30c4494e46ce32e68cfaccb80b2853/diff\", \"WorkDir\": \"/var/lib/docker/overlay2/619adce5a0d2a1b8745d4f3935c9b1dc6c30c4494e46ce32e68cfaccb80b2853/work\" } }, \"Mounts\": [], \"Config\": { \"Hostname\": \"2a780fc5f68c\", \"Domainname\": \"\", \"User\": \"\", \"AttachStdin\": false, \"AttachStdout\": false, \"AttachStderr\": false, \"Tty\": false, \"OpenStdin\": false, \"StdinOnce\": false, \"Env\": [ \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\" ], \"Cmd\": [ \"/bin/bash\", \"-c\", \"while true; do echo sugar; sleep 1; done\" ], \"Image\": \"centos\", \"Volumes\": null, \"WorkingDir\": \"\", \"Entrypoint\": null, \"OnBuild\": null, \"Labels\": { \"org.label-schema.build-date\": \"20210915\", \"org.label-schema.license\": \"GPLv2\", \"org.label-schema.name\": \"CentOS Base Image\", \"org.label-schema.schema-version\": \"1.0\", \"org.label-schema.vendor\": \"CentOS\" } }, \"NetworkSettings\": { \"Bridge\": \"\", \"SandboxID\": \"fc0b45deead7c901e02710a67c6290a197e19d77d8e32266211c617d899c329a\", \"HairpinMode\": false, \"LinkLocalIPv6Address\": \"\", \"LinkLocalIPv6PrefixLen\": 0, \"Ports\": {}, \"SandboxKey\": \"/var/run/docker/netns/fc0b45deead7\", \"SecondaryIPAddresses\": null, \"SecondaryIPv6Addresses\": null, \"EndpointID\": \"da3db9f9ccbbbeb563c2aadfbb8938503cf9b2c82920893e9519a6365ccc3e51\", \"Gateway\": \"172.17.0.1\", \"GlobalIPv6Address\": \"\", \"GlobalIPv6PrefixLen\": 0, \"IPAddress\": \"172.17.0.2\", \"IPPrefixLen\": 16, \"IPv6Gateway\": \"\", \"MacAddress\": \"02:42:ac:11:00:02\", \"Networks\": { \"bridge\": { \"IPAMConfig\": null, \"Links\": null, \"Aliases\": null, \"NetworkID\": \"b0fba45bae2a26e0e2c33eb5cf9050d48159091e9410d031cd83721db0fe436b\", \"EndpointID\": \"da3db9f9ccbbbeb563c2aadfbb8938503cf9b2c82920893e9519a6365ccc3e51\", \"Gateway\": \"172.17.0.1\", \"IPAddress\": \"172.17.0.2\", \"IPPrefixLen\": 16, \"IPv6Gateway\": \"\", \"GlobalIPv6Address\": \"\", \"GlobalIPv6PrefixLen\": 0, \"MacAddress\": \"02:42:ac:11:00:02\" } } } } ] # \u8fdb\u5165\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668 # \u901a\u5e38\u90fd\u662f\u4f7f\u7528\u540e\u53f0\u8fd0\u884c\u7684\u5bb9\u5668, \u9700\u8981\u8fdb\u5165\u540e\u53f0\u8fd0\u884c\u7684\u5bb9\u5668, \u4fee\u6539\u4e00\u4e9b\u914d\u7f6e # method 1: \u8fdb\u5165\u5bb9\u5668, \u5f00\u542f\u65b0\u7684\u7ec8\u7aef, \u53ef\u4ee5\u5728\u91cc\u9762\u64cd\u4f5c docker exec -it containerID # method 2: \u8fdb\u5165\u6b63\u5728\u6267\u884c\u7684\u7ec8\u7aef,\u4e0d\u4f1a\u542f\u52a8\u65b0\u7684\u8fdb\u7a0b docker attach containerID [root@sugarlearn ~]# docker attach 2a780fc5f68c sugar sugar sugar sugar sugar sugar sugar sugar # \u4ece\u5bb9\u5668\u62f7\u8d1d\u6587\u4ef6\u51fa\u6765 docker cp containerID:path host_path # \u542f\u52a8\u5e76\u8fdb\u5165\u5bb9\u5668,\u4e3b\u673a\u540d\u5c31\u662fID\u540d [root@sugarlearn ~]# docker run -it centos /bin/bash [root@8ec75bda8fcd /]# [root@8ec75bda8fcd /]# ls bin dev etc home lib lib64 lost+found media mnt opt proc root run sbin srv sys tmp usr var","title":"3.7. \u5176\u4ed6\u547d\u4ee4"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#4","text":"","title":"4. \u5b9e\u4f8b"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#41-dockernginx","text":"[root@sugarlearn ~]# docker run -d --name nginx01 -p 3344:80 nginx # -p \u4e3b\u673a\u7aef\u53e3:docker\u7aef\u53e3, \u5c06docker\u7684\u7aef\u53e3\u6620\u5c04\u5230\u4e3b\u673a. nginx\u7684\u9ed8\u8ba4\u7aef\u53e3\u4e3a80, \u6620\u5c04\u4e4b\u540e, \u5728\u4e3b\u673a\u76843344\u7aef\u53e3\u53ef\u4ee5\u8bbf\u95ee\u5230\u5bb9\u5668\u768480\u7aef\u53e3 e87155516f5b0c2ea566543eab6f54108ceb997b0dd2e56b78605bf18e09c465 [root@sugarlearn ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES e87155516f5b nginx \"/docker-entrypoin...\" 19 seconds ago Up 19 seconds 0.0.0.0:3344->80/tcp nginx01 [root@sugarlearn ~]# curl localhost:3344 <!DOCTYPE html> <html> <head> <title>Welcome to nginx!</title> <style> html { color-scheme: light dark; } body { width: 35em; margin: 0 auto; font-family: Tahoma, Verdana, Arial, sans-serif; } </style> </head> <body> <h1>Welcome to nginx!</h1> <p>If you see this page, the nginx web server is successfully installed and working. Further configuration is required.</p> <p>For online documentation and support please refer to <a href=\"http://nginx.org/\">nginx.org</a>.<br/> Commercial support is available at <a href=\"http://nginx.com/\">nginx.com</a>.</p> <p><em>Thank you for using nginx.</em></p> </body> </html> [root@sugarlearn ~]#","title":"4.1. docker\u5b89\u88c5nginx"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#42-dockertomcat","text":"docker run -it --rm tomcat:9.0 # --rm\u8868\u793a\u7528\u5b8c\u5373\u5220, \u505c\u6b62\u5bb9\u5668\u4e4b\u540e,\u7acb\u5373\u5c31\u5220\u9664\u5bb9\u5668. # \u6b63\u5e38\u542f\u52a8tomcat, \u6620\u5c04\u7aef\u53e3\u4e3a3344 docker run -d -p 3344:8080 --name tomcat01 tomcat # \u8fdb\u5165\u5bb9\u5668 docker exrc -it tomcat01 /bin/bash # \u5c06webapp.dist\u91cc\u9762\u7684\u5185\u5bb9\u62f7\u8d1d\u5230webapps\u91cc\u9762, \u6253\u5f00ip:3344\u5373\u53ef\u8bbf\u95ee\u6210\u529f, \u5982\u4e0b\u56fe\u6240\u793a ![[Pasted image 20220120193434.png]]","title":"4.2. docker\u5b89\u88c5tomcat"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#43-dockereskibana","text":"es\u66b4\u9732\u7684\u7aef\u53e3\u5f88\u591a es\u5341\u5206\u7684\u8017\u5185\u5b58 es\u7684\u6570\u636e\u4e00\u822c\u9700\u8981\u6302\u8f7d\u51fa\u53bb, \u653e\u7f6e\u5230\u5b89\u5168\u76ee\u5f55 docker run -d --name elasticsearch --net somenetwork -p 9200:9200 -p 9300:9300 -e \"discovery.type=single-node\" elasticsearch:tag # --net \u7f51\u7edc\u8bbe\u7f6e # \u53bb\u6389\u7f51\u7edc\u73af\u5883\u8bbe\u7f6e, \u4f7f\u75287.6.2\u7248\u672c docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e \"discovery.type=single-node\" elasticsearch:7.6.2 # \u542f\u52a8\u670d\u52a1\u4e4b\u540e, \u7cfb\u7edf\u8d1f\u8f7d\u5341\u5206\u5927,linux\u76f4\u63a5\u5361\u4f4f\u4e86 # \u4f7f\u7528 docker stats \u67e5\u770bcpu\u7684\u72b6\u6001 docker status # \u6d4b\u8bd5es\u662f\u5426\u6210\u529f # \u5173\u95edes, \u589e\u52a0\u5185\u5b58\u7684\u9650\u5236 docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e \"discovery.type=single-node\" -eES_JAVA_OPTS=\"-Xms64m -Xmx512m\" elasticsearch:7.6.2","title":"4.3. docker\u90e8\u7f72es+kibana"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#5","text":"\u6570\u636e\u6301\u4e45\u5316, \u4e0d\u4fdd\u5b58\u5728\u5bb9\u5668\u4e2d \u5377\u6280\u672f: \u76ee\u5f55\u7684\u6302\u8f7d, \u5c06\u5bb9\u5668\u5185\u7684\u76ee\u5f55\u6302\u8f7d\u5230linux\u4e0a\u9762. \u53ef\u4ee5\u5c06\u5bb9\u5668\u7684\u6570\u636e\u548clinux\u5bf9\u5e94\u8def\u5f84\u8fdb\u884c\u540c\u6b65. \u5bb9\u5668\u4e4b\u95f4\u4e5f\u53ef\u4ee5\u8fdb\u884c\u6570\u636e\u5171\u4eab \u6302\u8f7d\u662f\u5c06\u4e3b\u673a\u7684\u8def\u5f84\u6302\u8f7d\u5230\u5bb9\u5668\u5185, \u56e0\u6b64\u4e3b\u673a\u662f source. \u5bb9\u5668\u662f destination","title":"5. \u5bb9\u5668\u6570\u636e\u5377"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#51","text":"","title":"5.1. \u5bb9\u5668\u6570\u636e\u5377\u6302\u8f7d\u5230\u4e3b\u673a"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#511-1-v","text":"docker run -it -v \u4e3b\u673a\u76ee\u5f55:\u5bb9\u5668\u5185\u76ee\u5f55 # \u4f7f\u7528docker inspect \u67e5\u770b\"Mounts\": [ { \"Type\": \"bind\", \"Source\": \"/home/ceshi\", # \u4e3b\u673a\u7684\u5730\u5740 \"Destination\": \"/home\", # \u5bb9\u5668\u7684\u5730\u5740 \"Mode\": \"\", \"RW\": true, \"Propagation\": \"rprivate\" } ], \u6ca1\u6709\u6743\u9650\u5904\u7406\u529e\u6cd5: docker run -it --privileged=true -v /home/ceshi:/home centos /bin/bash . (\u8be5\u65b9\u6cd5\u597d\u50cf\u5931\u6548\u4e86, \u53ef\u4ee5\u5728\u542f\u52a8\u5bb9\u5668\u7684\u65f6\u5019, \u6307\u5b9a\u4ee5root\u7528\u6237\u542f\u52a8, \u5c31\u4f1a\u6709\u6743\u9650\u4e86. )","title":"5.1.1. \u65b9\u5f0f1. \u542f\u52a8\u5bb9\u5668\u65f6, \u4f7f\u7528\u547d\u4ee4\u6765\u6302\u8f7d -v"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#512-2-dockerfile","text":"dockerfile \u5c31\u662f\u7528\u6765\u6784\u5efadocker\u955c\u50cf\u7684\u6784\u5efa\u6587\u4ef6. \u662f\u547d\u4ee4\u811a\u672c # \u521b\u5efadockerfile\u6587\u4ef6 # \u6587\u4ef6\u5185\u5bb9\u5982\u4e0b # \u6307\u5b9a(\u5927\u5199) \u53c2\u6570 # \u6bcf\u4e2a\u547d\u4ee4\u5c31\u662fimage\u7684\u4e00\u5c42 FROM centos VOLUME [\"volume01\",\"volume02\"] CMD echo \"---end---\" CMD /bin/bash \u8fd0\u884c\u8be5\u811a\u672c, \u751f\u6210\u4e00\u4e2a\u65b0\u7684\u955c\u50cf: \u901a\u8fc7 build \u8fdb\u884c\u955c\u50cf\u7684\u6784\u5efa, -t \u8868\u793a target , \u751f\u6210\u7684\u955c\u50cf\u540d\u548c\u7248\u672c\u53f7\u4e3a shigang/centos:1.0 , \u751f\u6210\u7684\u8def\u5f84 . \u8868\u793a\u5f53\u524d\u8def\u5f84\u4e0b docker build -f dockerfile -t shigang/cantos:1.0 . \u8fd0\u884c\u751f\u6210\u7684image, \u67e5\u770b\u662f\u5426\u6302\u8f7d. \u53ef\u4ee5\u53d1\u73b0\u5728\u6839\u76ee\u5f55\u4e0b\u5df2\u7ecf\u6709\u4e86volume01\u548cvolume02\u4e24\u4e2a\u5377. \u811a\u672c\u4e2d\u5199\u7684\u662f\u533f\u540d\u6302\u8f7d\u65b9\u5f0f. [root@sugarlearn docker-test-volume]# docker ps -a CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 82a6ceebcf8a b3log/siyuan \"/opt/siyuan/kerne...\" 4 hours ago Up 4 hours 0.0.0.0:6806->6806/tcp siyuan 04b9ad86bdb6 zmister/mrdoc:v1 \"sh docker_mrdoc.sh\" 24 hours ago Up 24 hours 0.0.0.0:10086->10086/tcp mrdoc [root@sugarlearn docker-test-volume]# docker run -it 7b064e07c425 /bin/bash [root@c1e73c7792a5 /]# ls -l total 56 lrwxrwxrwx 1 root root 7 Nov 3 2020 bin -> usr/bin drwxr-xr-x 5 root root 360 Jan 20 19:53 dev drwxr-xr-x 1 root root 4096 Jan 20 19:53 etc drwxr-xr-x 2 root root 4096 Nov 3 2020 home lrwxrwxrwx 1 root root 7 Nov 3 2020 lib -> usr/lib lrwxrwxrwx 1 root root 9 Nov 3 2020 lib64 -> usr/lib64 drwx------ 2 root root 4096 Sep 15 14:17 lost+found drwxr-xr-x 2 root root 4096 Nov 3 2020 media drwxr-xr-x 2 root root 4096 Nov 3 2020 mnt drwxr-xr-x 2 root root 4096 Nov 3 2020 opt dr-xr-xr-x 141 root root 0 Jan 20 19:53 proc dr-xr-x--- 2 root root 4096 Sep 15 14:17 root drwxr-xr-x 1 root root 4096 Jan 20 19:53 run lrwxrwxrwx 1 root root 8 Nov 3 2020 sbin -> usr/sbin drwxr-xr-x 2 root root 4096 Nov 3 2020 srv dr-xr-xr-x 13 root root 0 Jan 19 07:39 sys drwxrwxrwt 7 root root 4096 Sep 15 14:17 tmp drwxr-xr-x 12 root root 4096 Sep 15 14:17 usr drwxr-xr-x 20 root root 4096 Sep 15 14:17 var drwxr-xr-x 2 root root 4096 Jan 20 19:53 volume01 drwxr-xr-x 2 root root 4096 Jan 20 19:53 volume02 \u901a\u8fc7 docker inspect ID \u67e5\u770b\u5bb9\u5668\u4fe1\u606f, \u53ef\u4ee5\u53d1\u73b0\u4fe1\u606f\u5df2\u7ecf\u540c\u6b65. \u53ef\u4ee5\u5728\u5bb9\u5668\u4e2dvolume01\u521b\u5efa\u6587\u4ef6\u5939,, \u4e4b\u540e\u518d\u5bbf\u4e3b\u673a\u67e5\u770b\u662f\u5426\u6709\u5bf9\u5e94\u7684\u6587\u4ef6. \"Mounts\": [ { \"Type\": \"volume\", \"Name\": \"a6255c3d8111e65ef8dc62e2d8f0b951899f0c6d36455276daf384c6fc41861a\", \"Source\": \"/var/lib/docker/volumes/a6255c3d8111e65ef8dc62e2d8f0b951899f0c6d36455276daf384c6fc41861a/_data\", \"Destination\": \"volume01\", \"Driver\": \"local\", \"Mode\": \"\", \"RW\": true, \"Propagation\": \"\" }, { \"Type\": \"volume\", \"Name\": \"0ec9fb36ce7235343426da000088f63115d99e603206ee0f9af5dd1bac6b3f4a\", \"Source\": \"/var/lib/docker/volumes/0ec9fb36ce7235343426da000088f63115d99e603206ee0f9af5dd1bac6b3f4a/_data\", \"Destination\": \"volume02\", \"Driver\": \"local\", \"Mode\": \"\", \"RW\": true, \"Propagation\": \"\" } ],","title":"5.1.2. \u65b9\u5f0f2. \u901a\u8fc7dockerfile\u8fdb\u884c\u6302\u8f7d"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#52","text":"\u591a\u4e2a\u5bb9\u5668\u4e4b\u95f4\u540c\u6b65\u6570\u636e, \u4f7f\u7528 --volimes-from \u8868\u793a\u4ece\u53e6\u4e00\u4e2adocker\u5bb9\u5668\u4e2d\u83b7\u53d6\u6302\u8f7d\u76ee\u5f55 \u901a\u8fc7\u542f\u52a8\u4e09\u4e2a\u5bb9\u5668\u6d4b\u8bd5\u5b66\u4e60 \u5728[[#\u65b9\u5f0f2 \u901a\u8fc7dockerfile\u8fdb\u884c\u6302\u8f7d]]\u7684\u65f6\u5019, \u4f7f\u7528dockerfile\u521b\u5efa\u4e86\u81ea\u5df1\u7684image, \u4f7f\u7528\u6211\u4eec\u81ea\u5df1\u521b\u5efa\u7684image\u4e3a\u4f8b, \u8fdb\u884c\u591a\u4e2a\u5bb9\u5668\u7684\u5bb9\u5668\u5377\u6302\u8f7d\u6d4b\u8bd5 \u542f\u52a8\u7b2c\u4e00\u4e2a\u5bb9\u5668 bash # \u9700\u8981\u6ce8\u610f\u7684\u662f, centos\u7cfb\u7edf\u5bb9\u5668\u76f4\u63a5\u4f7f\u7528exit\u9000\u51fa\u540e, \u7531\u4e8e\u6ca1\u6709\u524d\u53f0\u5e94\u7528, \u4f1a\u81ea\u52a8\u505c\u6b62\u8fd0\u884c # \u56e0\u6b64\u9700\u8981\u4f7f\u7528 ctrl + P + Q \u9000\u51fa\u5bb9\u5668 [root@sugarlearn home]# docker run -it --name docker01 7b064e07c425 [root@815381166fd9 /]# ls bin etc lib lost+found mnt proc run srv tmp var volume02 dev home lib64 media opt root sbin sys usr volume01 \u542f\u52a8\u7b2c\u4e8c\u4e2a\u5bb9\u5668, \u53d1\u73b0\u548c\u7b2c\u4e00\u4e2a\u5bb9\u5668\u7684\u6302\u8f7d\u76ee\u5f55\u4e00\u6837 bash [root@sugarlearn home]# docker run -it --name docker02 --volumes-from docker01 7b064e07c425 [root@9b5b20dec559 /]# ls bin etc lib lost+found mnt proc run srv tmp var volume02 dev home lib64 media opt root sbin sys usr volume01 \u5728 docker01 \u4e2d\u7684 volume01 \u4e2d\u6dfb\u52a0\u6587\u4ef6, \u67e5\u770b docker02 \u4e2d\u662f\u5426\u51fa\u73b0. \u5b9e\u9a8c\u7ed3\u679c\u53d1\u73b0, \u4e24\u4e2a\u5bb9\u5668\u7684\u5377\u662f\u4e92\u901a\u7684 ```bash [root@9b5b20dec559 /]# cd volume01 [root@9b5b20dec559 volume01]# ls [root@9b5b20dec559 volume01]# touch 123 [root@9b5b20dec559 volume01]# touch 12345 [root@9b5b20dec559 volume01]# ls 123 12345 [root@9b5b20dec559 volume01]# [root@sugarlearn home]# [root@sugarlearn home]# [root@sugarlearn home]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 9b5b20dec559 7b064e07c425 \"/bin/sh -c /bin/bash\" 4 minutes ago Up 4 minutes docker02 815381166fd9 7b064e07c425 \"/bin/sh -c /bin/bash\" 8 minutes ago Up 8 minutes docker01 82a6ceebcf8a b3log/siyuan \"/opt/siyuan/kerne...\" 5 hours ago Up 4 hours 0.0.0.0:6806->6806/tcp siyuan 04b9ad86bdb6 zmister/mrdoc:v1 \"sh docker_mrdoc.sh\" 24 hours ago Up 24 hours 0.0.0.0:10086->10086/tcp mrdoc [root@sugarlearn home]# docker attach 815381166fd9 [root@815381166fd9 /]# ls bin etc lib lost+found mnt proc run srv tmp var volume02 dev home lib64 media opt root sbin sys usr volume01 [root@815381166fd9 /]# cd volume01/ [root@815381166fd9 volume01]# ls 123 12345 ``` \u521b\u5efadocker03, \u53d1\u73b0\u4e5f\u53ef\u4ee5\u6302\u8f7d bash [root@sugarlearn home]# docker run -it --name docker03 --volumes-from docker01 shigang/centos:1.0 [root@8fbd45b8dd55 /]# ls bin etc lib lost+found mnt proc run srv tmp var volume02 dev home lib64 media opt root sbin sys usr volume01 [root@8fbd45b8dd55 /]# cd volume0 bash: cd: volume0: No such file or directory [root@8fbd45b8dd55 /]# cd volume01 [root@8fbd45b8dd55 volume01]# ls 12038120938 123 12345 aksdjhaskdjh \u5c06dicker01\u5220\u9664\u4e4b\u540e, \u53d1\u73b0\u6570\u636e\u4f9d\u7136\u662f\u5b58\u5728\u7684, docker02\u548c03\u7684\u6570\u636e\u5377\u6302\u8f7d\u4f9d\u7136\u5b58\u5728","title":"5.2. \u591a\u5bb9\u5668\u4e92\u76f8\u6302\u8f7d"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#53","text":"\u4e00\u822c\u90fd\u4f7f\u7528\u5177\u540d\u6302\u8f7d, \u6b64\u6982\u5ff5\u4e86\u89e3\u5373\u53ef \u533f\u540d\u6302\u8f7d: -v \u5bb9\u5668\u5185\u8def\u5f84","title":"5.3. \u5177\u540d\u6302\u8f7d\u548c\u533f\u540d\u6302\u8f7d"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#6-dockerfile","text":"","title":"6. dockerfile"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#61","text":"\u7f16\u5199dockerfile\u6587\u4ef6 docker build \u6784\u5efa\u6210\u4e3a\u4e00\u4e2a\u955c\u50cf docker run \u8fd0\u884c\u955c\u50cf docker push \u53d1\u5e03\u955c\u50cf Tip: \u5b98\u65b9\u540d\u5b57\u662fDockerfile, \u4f7f\u7528\u5b98\u65b9\u540d\u5b57, \u5728build\u7684\u65f6\u5019\u5c31\u4e0d\u9700\u8981\u4f7f\u7528 -f \u6307\u5b9a\u6587\u4ef6\u4e86.","title":"6.1. \u6784\u5efa\u6b65\u9aa4:"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#62","text":"\u4ee5centos\u4e3a\u4f8b: \u5b98\u65b9\u955c\u50cf\u5730\u5740 \u70b9\u51fb\u5177\u4f53\u7684\u7248\u672c\u53f7\u8fdb\u53bb, \u53d1\u73b0\u662fgithub\u9875\u9762, \u91cc\u9762\u662fdockerfile\u6587\u4ef6 \u5f88\u591a\u5b98\u65b9\u7684\u955c\u50cf\u90fd\u662f\u57fa\u7840\u5305, \u5f88\u591a\u7684\u529f\u80fd\u662f\u6ca1\u6709\u7684, \u6211\u4eec\u901a\u5e38\u4f1a\u642d\u5efa\u81ea\u5df1\u7684\u955c\u50cf ![[Pasted image 20220121043052.png]] ![[Pasted image 20220121043123.png]] FROM scratch ADD centos-7-x86_64-docker.tar.xz / LABEL \\ org.label-schema.schema-version=\"1.0\" \\ org.label-schema.name=\"CentOS Base Image\" \\ org.label-schema.vendor=\"CentOS\" \\ org.label-schema.license=\"GPLv2\" \\ org.label-schema.build-date=\"20201113\" \\ org.opencontainers.image.title=\"CentOS Base Image\" \\ org.opencontainers.image.vendor=\"CentOS\" \\ org.opencontainers.image.licenses=\"GPL-2.0-only\" \\ org.opencontainers.image.created=\"2020-11-13 00:00:00+00:00\" CMD [\"/bin/bash\"]","title":"6.2. \u67e5\u770b\u5b98\u65b9\u4f8b\u5b50"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#63-dockerfile","text":"\u57fa\u7840\u77e5\u8bc6: 1. \u6bcf\u4e2a\u5173\u952e\u5b57(\u6307\u4ee4)\u90fd\u5fc5\u987b\u662f\u5927\u5199 2. \u4ece\u4e0a\u5230\u4e0b\u7684\u6267\u884c\u987a\u5e8f 3. # \u8868\u793a\u6ce8\u91ca 4. \u6bcf\u4e2a\u6307\u4ee4\u90fd\u4f1a\u521b\u5efa\u63d0\u4ea4\u4e00\u4e2a\u65b0\u7684 \u955c\u50cf\u5c42 , \u5e76\u63d0\u4ea4.","title":"6.3. dockerfile\u7ec4\u6210"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#64-dockerfile","text":"\u6307\u4ee4\u6c47\u603b: FROM # \u57fa\u7840\u955c\u50cf, \u4e00\u5207\u4ece\u8fd9\u91cc\u6784\u5efa MAINTAINER # \u955c\u50cf\u7684\u4f5c\u8005, \u59d3\u540d+\u90ae\u7bb1 RUN # \u955c\u50cf\u6784\u5efa\u7684\u65f6\u5019 ADD # \u6b65\u9aa4 WORKDIR # \u955c\u50cf\u7684\u5de5\u4f5c\u76ee\u5f55 VOLUME # \u6302\u8f7d\u7684\u76ee\u5f55 EXPOSE # \u66b4\u9732\u7aef\u53e3 CMD # \u6307\u5b9a\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019, \u8fd0\u884c\u7684\u547d\u4ee4, \u53ea\u6709\u6700\u540e\u4e00\u4e2a\u4f1a\u751f\u6548, \u4e14\u53ef\u88ab\u66ff\u4ee3 ENTRYPOINT # \u6307\u5b9a\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019, \u8fd0\u884c\u7684\u547d\u4ee4, \u53ef\u4ee5\u8ffd\u52a0\u547d\u4ee4 ONBUILD # \u5f53\u6784\u5efa\u4e00\u4e2a\u88ab\u7ee7\u627f\u7684dockerfile\u7684\u65f6\u5019, \u5c31\u4f1a\u8fd0\u884c onbuild \u7684\u547d\u4ee4. COPY # \u7c7b\u4f3c\u4e8eadd, \u5c06\u6587\u4ef6\u62f7\u8d1d\u5230\u955c\u50cf\u4e2d ENV # \u6784\u5efa\u7684\u65f6\u5019\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf","title":"6.4. dockerfile\u7684\u6307\u4ee4"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#65-dockerfilecentos","text":"FROM scratch # dockerhub\u4e2d\u7edd\u5927\u591a\u6570\u7684\u955c\u50cf, \u90fd\u662f\u4ece\u6b64\u57fa\u7840\u955c\u50cf\u800c\u6765\u7684 \u521b\u5efa\u81ea\u5df1\u7684centos \u7f16\u5199\u914d\u7f6e\u6587\u4ef6 FROM centos MAINTAINER sugar<1144392179@qq.com> ENV MYPATH /usr/local WORKDIR $MYPATH # \u8bbe\u7f6e\u5de5\u4f5c\u76ee\u5f55, \u5373\u4e3a\u8fdb\u5165\u5bb9\u5668\u5185\u7684\u76ee\u5f55. \u5b98\u65b9\u7684centos\u542f\u52a8\u4e4b\u540e, \u8fdb\u5165\u5bb9\u5668\u5185\u90e8\u4e3a\u6839\u76ee\u5f55, \u901a\u8fc7\u6b64\u8bbe\u7f6e, \u53ef\u4ee5\u5c06\u8fdb\u5165\u5bb9\u5668\u7684\u9ed8\u8ba4\u76ee\u5f55\u8fdb\u884c\u4fee\u6539 RUN yum -y install vim RUN yum -y install net-tools EXPOSE 80 CMD echo $MYPATH CMD echo \"---end---\" CMD /bin/bash \u901a\u8fc7\u6587\u4ef6\u6784\u5efa\u955c\u50cf docker build -f dockfile -t mycentos:0.1 . \u901a\u8fc7\u4e0a\u9762\u7684\u547d\u4ee4, \u4f7f\u7528 dockerfile\u6784\u5efa\u6784\u5efa\u65b0\u7684\u955c\u50cf [root@sugarlearn docker-test-volume]# docker build -f dockerfile -t mycentos:0.1 . Sending build context to Docker daemon 2.048 kB Step 1/10 : FROM centos ---> 5d0da3dc9764 Step 2/10 : MAINTAINER sugar<1144392179@qq.com> ---> Running in b6fcc94bb8a5 ---> 74c30c1cbe48 Removing intermediate container b6fcc94bb8a5 Step 3/10 : ENV MYPATH /usr/local ---> Running in 9f870d79569c ---> 2c28d28d5fd8 Removing intermediate container 9f870d79569c Step 4/10 : WORKDIR $MYPATH ---> dfb3f984beb8 Removing intermediate container dd41b1c38380 Step 5/10 : RUN yum -y install vim ---> Running in b6c7b75645b7 CentOS Linux 8 - AppStream 4.6 MB/s | 8.4 MB 00:01 CentOS Linux 8 - BaseOS 4.0 MB/s | 4.6 MB 00:01 CentOS Linux 8 - Extras 17 kB/s | 10 kB 00:00 Dependencies resolved. ================================================================================ Package Arch Version Repository Size ================================================================================ Installing: vim-enhanced x86_64 2:8.0.1763-16.el8 appstream 1.4 M Installing dependencies: gpm-libs x86_64 1.20.7-17.el8 appstream 39 k vim-common x86_64 2:8.0.1763-16.el8 appstream 6.3 M vim-filesystem noarch 2:8.0.1763-16.el8 appstream 49 k which x86_64 2.21-16.el8 baseos 49 k Transaction Summary ================================================================================ Install 5 Packages Total download size: 7.8 M Installed size: 30 M Downloading Packages: (1/5): gpm-libs-1.20.7-17.el8.x86_64.rpm 221 kB/s | 39 kB 00:00 (2/5): vim-enhanced-8.0.1763-16.el8.x86_64.rpm 4.5 MB/s | 1.4 MB 00:00 (3/5): vim-filesystem-8.0.1763-16.el8.noarch.rp 172 kB/s | 49 kB 00:00 (4/5): which-2.21-16.el8.x86_64.rpm 309 kB/s | 49 kB 00:00 (5/5): vim-common-8.0.1763-16.el8.x86_64.rpm 12 MB/s | 6.3 MB 00:00 -------------------------------------------------------------------------------- Total 5.7 MB/s | 7.8 MB 00:01 warning: /var/cache/dnf/appstream-02e86d1c976ab532/packages/gpm-libs-1.20.7-17.el8.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID 8483c65d: NOKEY CentOS Linux 8 - AppStream 1.6 MB/s | 1.6 kB 00:00 Importing GPG key 0x8483C65D: Userid : \"CentOS (CentOS Official Signing Key) <security@centos.org>\" Fingerprint: 99DB 70FA E1D7 CE22 7FB6 4882 05B5 55B3 8483 C65D From : /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial Key imported successfully Running transaction check Transaction check succeeded. Running transaction test Transaction test succeeded. Running transaction Preparing : 1/1 Installing : which-2.21-16.el8.x86_64 1/5 Installing : vim-filesystem-2:8.0.1763-16.el8.noarch 2/5 Installing : vim-common-2:8.0.1763-16.el8.x86_64 3/5 Installing : gpm-libs-1.20.7-17.el8.x86_64 4/5 Running scriptlet: gpm-libs-1.20.7-17.el8.x86_64 4/5 Installing : vim-enhanced-2:8.0.1763-16.el8.x86_64 5/5 Running scriptlet: vim-enhanced-2:8.0.1763-16.el8.x86_64 5/5 Running scriptlet: vim-common-2:8.0.1763-16.el8.x86_64 5/5 Verifying : gpm-libs-1.20.7-17.el8.x86_64 1/5 Verifying : vim-common-2:8.0.1763-16.el8.x86_64 2/5 Verifying : vim-enhanced-2:8.0.1763-16.el8.x86_64 3/5 Verifying : vim-filesystem-2:8.0.1763-16.el8.noarch 4/5 Verifying : which-2.21-16.el8.x86_64 5/5 Installed: gpm-libs-1.20.7-17.el8.x86_64 vim-common-2:8.0.1763-16.el8.x86_64 vim-enhanced-2:8.0.1763-16.el8.x86_64 vim-filesystem-2:8.0.1763-16.el8.noarch which-2.21-16.el8.x86_64 Complete! ---> 4c7b4ce9b341 Removing intermediate container b6c7b75645b7 Step 6/10 : RUN yum -y install net-tools ---> Running in 44cf17d41b1d Last metadata expiration check: 0:00:10 ago on Mon Jan 24 09:43:16 2022. Dependencies resolved. ================================================================================ Package Architecture Version Repository Size ================================================================================ Installing: net-tools x86_64 2.0-0.52.20160912git.el8 baseos 322 k Transaction Summary ================================================================================ Install 1 Package Total download size: 322 k Installed size: 942 k Downloading Packages: net-tools-2.0-0.52.20160912git.el8.x86_64.rpm 1.2 MB/s | 322 kB 00:00 -------------------------------------------------------------------------------- Total 337 kB/s | 322 kB 00:00 Running transaction check Transaction check succeeded. Running transaction test Transaction test succeeded. Running transaction Preparing : 1/1 Installing : net-tools-2.0-0.52.20160912git.el8.x86_64 1/1 Running scriptlet: net-tools-2.0-0.52.20160912git.el8.x86_64 1/1 Verifying : net-tools-2.0-0.52.20160912git.el8.x86_64 1/1 Installed: net-tools-2.0-0.52.20160912git.el8.x86_64 Complete! ---> e2a85f441e55 Removing intermediate container 44cf17d41b1d Step 7/10 : EXPOSE 80 ---> Running in 96cbdbc3347b ---> 135f028da5a8 Removing intermediate container 96cbdbc3347b Step 8/10 : CMD echo $MYPATH ---> Running in 4d092e681f27 ---> d7877648b301 Removing intermediate container 4d092e681f27 Step 9/10 : CMD echo \"---end---\" ---> Running in 551d9ae06abe ---> c465707419b5 Removing intermediate container 551d9ae06abe Step 10/10 : CMD /bin/bash ---> Running in 3ad32c2be5fd ---> 6996698dfbc1 Removing intermediate container 3ad32c2be5fd Successfully built 6996698dfbc1 . \u6784\u5efa\u955c\u50cf\u4e4b\u540e, \u53ef\u4ee5\u8fdb\u5165\u5bb9\u5668\u67e5\u770b\u547d\u4ee4\u662f\u5426\u5b89\u88c5 [root@sugarlearn docker-test-volume]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE mycentos 0.1 6996698dfbc1 About a minute ago 326 MB [root@sugarlearn docker-test-volume]# docker run -it mycentos:0.1 [root@b22fae9e9ab5 local]# pwd /usr/local [root@b22fae9e9ab5 local]# vim # \u53ef\u4ee5\u53d1\u73b0vim\u5df2\u7ecf\u5b89\u88c5\u4e86","title":"6.5. \u4f7f\u7528dockerfile\u6784\u5efa\u81ea\u5df1\u7684centos\u7cfb\u7edf"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#66","text":"[root@sugarlearn docker-test-volume]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE mycentos 0.1 6996698dfbc1 12 minutes ago 326 MB [root@sugarlearn docker-test-volume]# docker history 6996698dfbc1 IMAGE CREATED CREATED BY SIZE COMMENT 6996698dfbc1 12 minutes ago /bin/sh -c #(nop) CMD [\"/bin/sh\" \"-c\" \"/b... 0 B c465707419b5 12 minutes ago /bin/sh -c #(nop) CMD [\"/bin/sh\" \"-c\" \"ec... 0 B d7877648b301 12 minutes ago /bin/sh -c #(nop) CMD [\"/bin/sh\" \"-c\" \"ec... 0 B 135f028da5a8 12 minutes ago /bin/sh -c #(nop) EXPOSE 80/tcp 0 B e2a85f441e55 12 minutes ago /bin/sh -c yum -y install net-tools 28.4 MB 4c7b4ce9b341 12 minutes ago /bin/sh -c yum -y install vim 66.3 MB dfb3f984beb8 13 minutes ago /bin/sh -c #(nop) WORKDIR /usr/local 0 B 2c28d28d5fd8 13 minutes ago /bin/sh -c #(nop) ENV MYPATH=/usr/local 0 B 74c30c1cbe48 13 minutes ago /bin/sh -c #(nop) MAINTAINER sugar<114439... 0 B 5d0da3dc9764 4 months ago /bin/sh -c #(nop) CMD [\"/bin/bash\"] 0 B <missing> 4 months ago /bin/sh -c #(nop) LABEL org.label-schema.... 0 B <missing> 4 months ago /bin/sh -c #(nop) ADD file:805cb5e15fb6e0b... 231 MB [root@sugarlearn docker-test-volume]# \u53ef\u4ee5\u67e5\u770b\u5176\u4ed6\u955c\u50cf\u7684\u6784\u5efa\u8fc7\u7a0b [root@sugarlearn docker-test-volume]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE mycentos 0.1 6996698dfbc1 14 minutes ago 326 MB docker.io/b3log/siyuan latest 68ac87c0ad39 3 days ago 142 MB docker.io/jonnyan404/mrdoc latest a187113ddd2a 7 days ago 864 MB docker.io/zmister/mrdoc v1 1f0e4ae2440e 2 weeks ago 839 MB docker.io/nginx latest 605c77e624dd 3 weeks ago 141 MB docker.io/tomcat latest fb5657adc892 4 weeks ago 680 MB docker.io/centos latest 5d0da3dc9764 4 months ago 231 MB docker.io/jellyfin/jellyfin latest 0aa773b67433 4 months ago 717 MB docker.io/elasticsearch 7.6.2 f29a1ee41030 22 months ago 791 MB [root@sugarlearn docker-test-volume]# docker history 605c77e624dd IMAGE CREATED CREATED BY SIZE COMMENT 605c77e624dd 3 weeks ago /bin/sh -c #(nop) CMD [\"nginx\" \"-g\" \"daem... 0 B <missing> 3 weeks ago /bin/sh -c #(nop) STOPSIGNAL SIGQUIT 0 B <missing> 3 weeks ago /bin/sh -c #(nop) EXPOSE 80 0 B <missing> 3 weeks ago /bin/sh -c #(nop) ENTRYPOINT [\"/docker-en... 0 B <missing> 3 weeks ago /bin/sh -c #(nop) COPY file:09a214a3e07c91... 4.61 kB <missing> 3 weeks ago /bin/sh -c #(nop) COPY file:0fd5fca330dcd6... 1.04 kB <missing> 3 weeks ago /bin/sh -c #(nop) COPY file:0b866ff3fc1ef5... 1.96 kB <missing> 3 weeks ago /bin/sh -c #(nop) COPY file:65504f71f5855c... 1.2 kB <missing> 3 weeks ago /bin/sh -c set -x && addgroup --system... 61.1 MB <missing> 3 weeks ago /bin/sh -c #(nop) ENV PKG_RELEASE=1~bullseye 0 B <missing> 3 weeks ago /bin/sh -c #(nop) ENV NJS_VERSION=0.7.1 0 B <missing> 3 weeks ago /bin/sh -c #(nop) ENV NGINX_VERSION=1.21.5 0 B <missing> 4 weeks ago /bin/sh -c #(nop) LABEL maintainer=NGINX ... 0 B <missing> 4 weeks ago /bin/sh -c #(nop) CMD [\"bash\"] 0 B <missing> 4 weeks ago /bin/sh -c #(nop) ADD file:09675d11695f65c... 80.4 MB [root@sugarlearn docker-test-volume]#","title":"6.6. \u5217\u51fa\u955c\u50cf\u5386\u53f2"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#67-cmdentrypoint","text":"dockerfile\u4e2d\u4e00\u4e0b\u4e24\u4e2a\u547d\u4ee4\u7684\u533a\u522b CMD # \u6307\u5b9a\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019, \u8fd0\u884c\u7684\u547d\u4ee4, \u53ea\u6709\u6700\u540e\u4e00\u4e2a\u4f1a\u751f\u6548, \u4e14\u53ef\u88ab\u66ff\u4ee3 ENTRYPOINT # \u6307\u5b9a\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019, \u8fd0\u884c\u7684\u547d\u4ee4, \u53ef\u4ee5\u8ffd\u52a0\u547d\u4ee4 \u6d4b\u8bd5cmd : \u53ef\u4ee5\u770b\u5230, \u542f\u52a8\u955c\u50cf\u4e4b\u540e, \u76f4\u63a5\u6267\u884c\u4e86CMD\u4e2d\u7684\u547d\u4ee4, \u5de5\u4f5c\u76ee\u5f55\u7684\u6587\u4ef6\u5217\u4e86\u51fa\u6765 \u6784\u5efadockerfile\u7528\u6765\u6d4b\u8bd5 FROM centos CMD [\"ls\",\"-a\"] \u6784\u5efa\u5e76\u542f\u52a8\u955c\u50cf [root@sugarlearn docker-test-volume]# docker build -f dockerfile_cmd -t cmdtest:1.0 . Sending build context to Docker daemon 3.072 kB Step 1/2 : FROM centos ---> 5d0da3dc9764 Step 2/2 : CMD ls -a ---> Running in 436ea9052803 ---> 9da23cd6ea1d Removing intermediate container 436ea9052803 Successfully built 9da23cd6ea1d [root@sugarlearn docker-test-volume]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE cmdtest 1.0 9da23cd6ea1d 5 seconds ago 231 MB mycentos 0.1 6996698dfbc1 17 minutes ago 326 MB docker.io/b3log/siyuan latest 68ac87c0ad39 3 days ago 142 MB docker.io/jonnyan404/mrdoc latest a187113ddd2a 7 days ago 864 MB docker.io/zmister/mrdoc v1 1f0e4ae2440e 2 weeks ago 839 MB docker.io/nginx latest 605c77e624dd 3 weeks ago 141 MB docker.io/tomcat latest fb5657adc892 4 weeks ago 680 MB docker.io/centos latest 5d0da3dc9764 4 months ago 231 MB docker.io/jellyfin/jellyfin latest 0aa773b67433 4 months ago 717 MB docker.io/elasticsearch 7.6.2 f29a1ee41030 22 months ago 791 MB [root@sugarlearn docker-test-volume]# docker run 9da23cd6ea1d . .. .dockerenv bin dev etc home lib lib64 lost+found media mnt opt proc root run sbin srv sys tmp usr var [root@sugarlearn docker-test-volume]# dockerfile\u4e2d\u6267\u884c\u7684\u547d\u4ee4\u4e3a ls -a , \u5982\u679c\u60f3\u8ffd\u52a0\u547d\u4ee4\u4e3a ls -al , \u6d4b\u8bd5\u4e00\u4e0b, \u53d1\u73b0\u4f1a\u62a5\u9519. \u4f7f\u7528CMD\u7684\u60c5\u51b5\u4e0b, -l \u4f1a\u66ff\u6362 CMD\u4e2d\u7684\u547d\u4ee4[\"ls\",\"-a\"], \u5c06 -l \u8ba4\u5b9a\u4e3a\u4e00\u4e2a\u547d\u4ee4, \u4f46\u662f\u627e\u4e0d\u5230\u6b64\u547d\u4ee4, \u6240\u4ee5\u4f1a\u62a5\u9519. \u5982\u679c\u60f3\u8981 ls -al \u5219\u5fc5\u987b\u8f93\u5165\u5b8c\u6574\u7684\u547d\u4ee4. [root@sugarlearn docker-test-volume]# docker run 9da23cd6ea1d -l container_linux.go:235: starting container process caused \"exec: \\\"-l\\\": executable file not found in $PATH\" /usr/bin/docker-current: Error response from daemon: oci runtime error: container_linux.go:235: starting container process caused \"exec: \\\"-l\\\": executable file not found in $PATH\". [root@sugarlearn docker-test-volume]# docker run 9da23cd6ea1d ls -al total 56 drwxr-xr-x 1 root root 4096 Jan 24 10:12 . drwxr-xr-x 1 root root 4096 Jan 24 10:12 .. -rwxr-xr-x 1 root root 0 Jan 24 10:12 .dockerenv lrwxrwxrwx 1 root root 7 Nov 3 2020 bin -> usr/bin drwxr-xr-x 5 root root 340 Jan 24 10:12 dev drwxr-xr-x 1 root root 4096 Jan 24 10:12 etc drwxr-xr-x 2 root root 4096 Nov 3 2020 home lrwxrwxrwx 1 root root 7 Nov 3 2020 lib -> usr/lib lrwxrwxrwx 1 root root 9 Nov 3 2020 lib64 -> usr/lib64 drwx------ 2 root root 4096 Sep 15 14:17 lost+found drwxr-xr-x 2 root root 4096 Nov 3 2020 media drwxr-xr-x 2 root root 4096 Nov 3 2020 mnt drwxr-xr-x 2 root root 4096 Nov 3 2020 opt dr-xr-xr-x 148 root root 0 Jan 24 10:12 proc dr-xr-x--- 2 root root 4096 Sep 15 14:17 root drwxr-xr-x 1 root root 4096 Jan 24 10:12 run lrwxrwxrwx 1 root root 8 Nov 3 2020 sbin -> usr/sbin drwxr-xr-x 2 root root 4096 Nov 3 2020 srv dr-xr-xr-x 13 root root 0 Jan 19 07:39 sys drwxrwxrwt 7 root root 4096 Sep 15 14:17 tmp drwxr-xr-x 12 root root 4096 Sep 15 14:17 usr drwxr-xr-x 20 root root 4096 Sep 15 14:17 var \u6d4b\u8bd5ENTRYPOINT \u4e0a\u8ff0\u4f7f\u7528CMD\u8ffd\u52a0\u547d\u4ee4\u7684\u65f6\u5019, \u4f1a\u5c06\u547d\u4ee4\u66ff\u6362\u6389, \u4f46\u662f\u4f7f\u7528ENTRYPOINT\u5219\u53ef\u4ee5\u8ffd\u52a0\u547d\u4ee4. \u6d4b\u8bd5\u4e00\u4e0b. \u9996\u5148\u7f16\u5199dockerfile FROM centos CMD [\"ls\",\"-a\"] \u6784\u5efa\u5e76\u6267\u884c\u955c\u50cf, \u53ef\u4ee5\u53d1\u73b0, \u8ffd\u52a0 -l \u53ef\u4ee5\u6b63\u786e\u7684\u6267\u884c\u547d\u4ee4, \u4e0d\u4f1a\u8986\u76d6\u539f\u6765\u7684\u547d\u4ee4 [root@sugarlearn docker-test-volume]# docker run entrypoint . .. .dockerenv bin dev etc home lib lib64 lost+found media mnt opt proc root run sbin srv sys tmp usr var [root@sugarlearn docker-test-volume]# docker run entrypoint -l total 56 drwxr-xr-x 1 root root 4096 Jan 24 10:15 . drwxr-xr-x 1 root root 4096 Jan 24 10:15 .. -rwxr-xr-x 1 root root 0 Jan 24 10:15 .dockerenv lrwxrwxrwx 1 root root 7 Nov 3 2020 bin -> usr/bin drwxr-xr-x 5 root root 340 Jan 24 10:15 dev drwxr-xr-x 1 root root 4096 Jan 24 10:15 etc drwxr-xr-x 2 root root 4096 Nov 3 2020 home lrwxrwxrwx 1 root root 7 Nov 3 2020 lib -> usr/lib lrwxrwxrwx 1 root root 9 Nov 3 2020 lib64 -> usr/lib64 drwx------ 2 root root 4096 Sep 15 14:17 lost+found drwxr-xr-x 2 root root 4096 Nov 3 2020 media drwxr-xr-x 2 root root 4096 Nov 3 2020 mnt drwxr-xr-x 2 root root 4096 Nov 3 2020 opt dr-xr-xr-x 147 root root 0 Jan 24 10:15 proc dr-xr-x--- 2 root root 4096 Sep 15 14:17 root drwxr-xr-x 1 root root 4096 Jan 24 10:15 run lrwxrwxrwx 1 root root 8 Nov 3 2020 sbin -> usr/sbin drwxr-xr-x 2 root root 4096 Nov 3 2020 srv dr-xr-xr-x 13 root root 0 Jan 19 07:39 sys drwxrwxrwt 7 root root 4096 Sep 15 14:17 tmp drwxr-xr-x 12 root root 4096 Sep 15 14:17 usr drwxr-xr-x 20 root root 4096 Sep 15 14:17 var","title":"6.7. CMD\u548cENTRYPOINT\u7684\u533a\u522b"},{"location":"docker%E5%AD%A6%E4%B9%A0/docker%E7%AC%94%E8%AE%B0/#7-reference","text":"docker\u4f7f\u7528\u6307\u5357 docker\u5efa\u7ad9 \u6c42\u6c42\u4f60\u4e86\uff0c\u7528Docker\u5427 \u72c2\u795e\u8bf4docker\u89c6\u9891 \u5b98\u65b9\u5e2e\u52a9\u6587\u6863","title":"7. reference"},{"location":"docker%E5%AD%A6%E4%B9%A0/docsify%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/","text":"\u4f5c\u8005: sugar \u8f6c\u8f7d\u8bf7\u8054\u7cfb\u4f5c\u8005(1144392179@qq.com),\u5e76\u8bf4\u660e\u51fa\u5904! 1. Introduction docsify\u662f\u57fa\u4e8enodejs\u7684, \u9700\u8981\u4f7f\u7528npm\u5de5\u5177\u8fdb\u884c\u5b89\u88c5. 2. \u5b89\u88c5 nodejs\u4ee5\u53canpm\u7684\u5b89\u88c5\u4f7f\u7528, \u5728\u5b89\u88c5node\u4ee5\u53canpm\u7684\u524d\u63d0\u4e0b, \u5b89\u88c5 docfisy. npm install -g docsify-cli # \u5b89\u88c5\u5b8c\u6210\u4e4b\u540e \u67e5\u770b\u7248\u672c [root@sugarlearn /]# docsify -v docsify-cli version: 4.4.3 3. \u4f7f\u7528 docsify\u7684\u4f7f\u7528\u5f88\u7b80\u5355, \u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939, \u4f7f\u7528docsify\u5c06\u5176\u521d\u59cb\u5316\u5373\u53ef. \u7c7b\u4f3c\u4e8egit\u7684\u521d\u59cb\u5316. \u521d\u59cb\u5316\u4e4b\u540e, \u4f1a\u5728\u4ed3\u5e93\u4e2d\u65b0\u5efa\u4e00\u4e2aREADME.md\u4ee5\u53caindex.html, \u8fd9\u4e24\u4e2a\u5c31\u662f\u6211\u4eec\u7684\u7f51\u9875\u5185\u5bb9. docsify\u4f1a\u5c06\u8fd9\u4e2aREADME.md\u6587\u4ef6\u6e32\u67d3\u6210\u4e00\u4e2a\u7f51\u9875, index.html\u5c31\u662f\u7f51\u7ad9\u7684\u5165\u53e3\u6587\u4ef6. # docsify\u521d\u59cb\u5316 [root@sugarlearn docsify_repo]# docsify init . already exists. \u2714 Are you sure you want to rewrite it? (y/N) true Initialization succeeded! Please run docsify serve [root@sugarlearn docsify_repo]# [root@sugarlearn docsify_repo]# ls index.html README.md \u521d\u59cb\u5316\u4e4b\u540e, \u542f\u52a8\u7f51\u7ad9: docsify serve 4. \u914d\u7f6e \u7f51\u9875\u6240\u6709\u76f8\u5173\u7684\u914d\u7f6e, \u90fd\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539 index.html \u6587\u4ef6\u6765\u5b9e\u73b0. <!DOCTYPE html> <html lang=\"en\"> <head> <meta charset=\"UTF-8\"> <title>Document</title> <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" /> <meta name=\"description\" content=\"Description\"> <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, minimum-scale=1.0\"> <link rel=\"stylesheet\" href=\"//cdn.jsdelivr.net/npm/docsify@4/lib/themes/vue.css\"> </head> <body> <div id=\"app\"></div> <script> window.$docsify = { name: '', repo: '' coverpage: true loadNavbar: true } </script> <!-- Docsify v4 --> <script src=\"//cdn.jsdelivr.net/npm/docsify@4\"></script> </body> </html> 4.1. \u4e3b\u9898 \u76ee\u524d\u652f\u6301\u4ee5\u4e0b\u51e0\u4e2a\u4e3b\u9898,\u4fee\u6539 vue.vss \u4e3a\u5176\u4ed6\u4e3b\u9898\u540d\u5373\u53ef. <link rel=\"stylesheet\" href=\"//cdn.jsdelivr.net/npm/docsify/themes/vue.css\"> <link rel=\"stylesheet\" href=\"//cdn.jsdelivr.net/npm/docsify/themes/buble.css\"> <link rel=\"stylesheet\" href=\"//cdn.jsdelivr.net/npm/docsify/themes/dark.css\"> <link rel=\"stylesheet\" href=\"//cdn.jsdelivr.net/npm/docsify/themes/pure.css\"> <link rel=\"stylesheet\" href=\"//cdn.jsdelivr.net/npm/docsify/themes/dolphin.css\"> 4.2. \u5c01\u9762 coverpage\u8bbe\u7f6e\u4e3atrue, \u5c31\u53ef\u4ee5\u6253\u5f00\u5c01\u9762\u529f\u80fd \u7136\u540e\u5728\u9879\u76ee\u6587\u4ef6\u5939, \u65b0\u5efa\u6587\u4ef6 _coverpage.md \u5373\u4e3a\u5c01\u9762. \u6587\u4ef6\u5185\u5bb9\u5982\u4e0b: # Sugar\u7684\u77e5\u8bc6\u5e93 **Author**: Sugar [**Start**](README.md) 4.3. \u5bfc\u822a\u680f loadNavbar\u8bbe\u7f6e\u4e3atrue, \u5728\u9879\u76ee\u6587\u4ef6\u5939\u4e2d\u6dfb\u52a0 _navbar.md \u6587\u4ef6, \u5373\u4e3a\u5bfc\u822a\u680f, \u6587\u4ef6\u5185\u5bb9\u5982\u4e0b: - \u5b66\u4e60\u7b14\u8bb0 - \u6b63\u5728\u6574\u7406\u4e2d - \u6b63\u5728\u6574\u7406\u4e2d - \u6b63\u5728\u6574\u7406\u4e2d - \u6b63\u5728\u6574\u7406\u4e2d - \u4e91\u7aef\u90e8\u7f72 - [docker\u642d\u5efa\u601d\u6e90\u7b14\u8bb0](docker\u642d\u5efa\u601d\u6e90\u7b14\u8bb0.md) - [docsify\u642d\u5efa\u8bb0\u5f55](docsify\u642d\u5efa\u8bb0\u5f55.md) - [docker\u7b14\u8bb0](docker\u7b14\u8bb0.md) - \u5de5\u5177\u7f51\u7ad9 - [\u6b63\u5219\u8868\u8fbe\u5f0f30\u5206\u949f\u5165\u95e8](https://deerchao.cn/tutorials/regex/regex.htm) - [Hex\u5b57\u7b26\u8f6c\u6362](https://the-x.cn/encodings/Hex.aspx) - [MathSolver](https://mathsolver.microsoft.com/zh) - [TextTools](https://mytexttools.com/) 4.4. \u4fa7\u8fb9\u680f \u9ed8\u8ba4\u60c5\u51b5\u4e0b, \u4f1a\u6839\u636e\u4f46\u94b1\u6587\u6863\u7684\u6807\u9898\u751f\u6210\u4fa7\u8fb9\u680f\u76ee\u5f55. \u4e5f\u53ef\u4ee5\u81ea\u5df1\u5b9a\u5236\u5316\u4fa7\u8fb9\u680f\u7684\u5185\u5bb9, \u4fee\u6539index.html\u6587\u4ef6 <script> window.$docsify = { loadSidebar: true } </script> <script src=\"//unpkg.com/docsify\"></script> \u8bbe\u7f6eloadSidebar: true\u4e4b\u540e, \u5728\u9879\u76ee\u7684\u6839\u76ee\u5f55\u521b\u5efa _sidebar.md \u6587\u4ef6, \u5185\u5bb9\u683c\u5f0f\u5982\u4e0b: * [home1](home1) * [home2](home2) * [bar](bar/) * [bar/a](bar/a) \u663e\u793a\u9875\u9762\u76ee\u5f55 \u5b9a\u5236\u7684\u4fa7\u8fb9\u680f, \u53ea\u4f1a\u663e\u793a\u9875\u9762\u8fde\u63a5, \u5982\u679c\u60f3\u540c\u65f6\u663e\u793a\u9875\u9762\u8fde\u63a5\u548c\u5f53\u524d\u6587\u6863\u7684\u76ee\u5f55, \u5c31\u9700\u8981\u6dfb\u52a0 subMaxLevel \u5b57\u6bb5. <script> window.$docsify = { loadSidebar: true, subMaxLevel: 3 } </script> <script src=\"//unpkg.com/docsify\"></script> 5. \u90e8\u7f72 \u4f7f\u7528docker\u955c\u50cf\u4e3a\u6700\u4f18\u9009\u62e9, \u4f7f\u7528nginx\u662f\u5728\u4e0d\u4e86\u89e3docsify\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u7684\u5c1d\u8bd5 \u4f7f\u7528nginx\u6709\u70b9\u81c3\u80bf, \u9700\u8981\u81ea\u5df1\u642d\u5efaweb\u670d\u52a1 \u4f7f\u7528docsify\u81ea\u5e26\u7684serve\u670d\u52a1\u66f4\u4e3a\u7b80\u5355\u4fbf\u6377 \u53ef\u9009\u4e0b\u5217\u4e09\u79cd\u65b9\u5f0f\u8fdb\u884c\u90e8\u7f72: 1. \u4f7f\u7528 nginx 2. \u4f7f\u7528 github pages 3. \u5236\u4f5c docker \u955c\u50cf 5.1. \u4f7f\u7528docker\u955c\u50cf\u8fdb\u884c\u90e8\u7f72 \u9009\u7528 docker \u955c\u50cf\u90e8\u7f72\u6bd4\u8f83\u65b9\u4fbf, \u8fd9\u91cc\u53ea\u8bb2\u89e3\u6b64\u79cd\u65b9\u5f0f docsify\u6ca1\u6709\u5b98\u65b9\u7684\u955c\u50cf, \u9700\u8981\u4f7f\u7528Dockfile\u81ea\u5df1\u5236\u4f5c\u955c\u50cf\u5e76\u8fd0\u884c. \u9996\u5148\u51c6\u5907\u597d\u521d\u59cb\u6587\u4ef6 index.html README.md \u521b\u5efa Dockfile FROM node:latest MAINTAINER sugar<1144392179@qq.com> WORKDIR /docs RUN npm install -g docsify-cli@latest EXPOSE 3344/tcp # \u6b64\u5904\u66b4\u9732\u7684\u662f\u4e3b\u673a\u7aef\u53e3 ENTRYPOINT docsify serve . \u6784\u5efa\u955c\u50cf docker build -f Dockfile -t sugar/docsify . \u8fd0\u884cdocker\u955c\u50cf docker run -it -p 3344:3000 --name=docsify -v $(pwd):/docs sugar/docsify 6. reference docsify\u5b98\u65b9\u6587\u6863 \u601d\u5426-docsify\u6559\u7a0b","title":"docker\u5b9e\u6218:docsify"},{"location":"docker%E5%AD%A6%E4%B9%A0/docsify%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/#1-introduction","text":"docsify\u662f\u57fa\u4e8enodejs\u7684, \u9700\u8981\u4f7f\u7528npm\u5de5\u5177\u8fdb\u884c\u5b89\u88c5.","title":"1. Introduction"},{"location":"docker%E5%AD%A6%E4%B9%A0/docsify%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/#2","text":"nodejs\u4ee5\u53canpm\u7684\u5b89\u88c5\u4f7f\u7528, \u5728\u5b89\u88c5node\u4ee5\u53canpm\u7684\u524d\u63d0\u4e0b, \u5b89\u88c5 docfisy. npm install -g docsify-cli # \u5b89\u88c5\u5b8c\u6210\u4e4b\u540e \u67e5\u770b\u7248\u672c [root@sugarlearn /]# docsify -v docsify-cli version: 4.4.3","title":"2. \u5b89\u88c5"},{"location":"docker%E5%AD%A6%E4%B9%A0/docsify%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/#3","text":"docsify\u7684\u4f7f\u7528\u5f88\u7b80\u5355, \u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939, \u4f7f\u7528docsify\u5c06\u5176\u521d\u59cb\u5316\u5373\u53ef. \u7c7b\u4f3c\u4e8egit\u7684\u521d\u59cb\u5316. \u521d\u59cb\u5316\u4e4b\u540e, \u4f1a\u5728\u4ed3\u5e93\u4e2d\u65b0\u5efa\u4e00\u4e2aREADME.md\u4ee5\u53caindex.html, \u8fd9\u4e24\u4e2a\u5c31\u662f\u6211\u4eec\u7684\u7f51\u9875\u5185\u5bb9. docsify\u4f1a\u5c06\u8fd9\u4e2aREADME.md\u6587\u4ef6\u6e32\u67d3\u6210\u4e00\u4e2a\u7f51\u9875, index.html\u5c31\u662f\u7f51\u7ad9\u7684\u5165\u53e3\u6587\u4ef6. # docsify\u521d\u59cb\u5316 [root@sugarlearn docsify_repo]# docsify init . already exists. \u2714 Are you sure you want to rewrite it? (y/N) true Initialization succeeded! Please run docsify serve [root@sugarlearn docsify_repo]# [root@sugarlearn docsify_repo]# ls index.html README.md \u521d\u59cb\u5316\u4e4b\u540e, \u542f\u52a8\u7f51\u7ad9: docsify serve","title":"3. \u4f7f\u7528"},{"location":"docker%E5%AD%A6%E4%B9%A0/docsify%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/#4","text":"\u7f51\u9875\u6240\u6709\u76f8\u5173\u7684\u914d\u7f6e, \u90fd\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539 index.html \u6587\u4ef6\u6765\u5b9e\u73b0. <!DOCTYPE html> <html lang=\"en\"> <head> <meta charset=\"UTF-8\"> <title>Document</title> <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" /> <meta name=\"description\" content=\"Description\"> <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, minimum-scale=1.0\"> <link rel=\"stylesheet\" href=\"//cdn.jsdelivr.net/npm/docsify@4/lib/themes/vue.css\"> </head> <body> <div id=\"app\"></div> <script> window.$docsify = { name: '', repo: '' coverpage: true loadNavbar: true } </script> <!-- Docsify v4 --> <script src=\"//cdn.jsdelivr.net/npm/docsify@4\"></script> </body> </html>","title":"4. \u914d\u7f6e"},{"location":"docker%E5%AD%A6%E4%B9%A0/docsify%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/#41","text":"\u76ee\u524d\u652f\u6301\u4ee5\u4e0b\u51e0\u4e2a\u4e3b\u9898,\u4fee\u6539 vue.vss \u4e3a\u5176\u4ed6\u4e3b\u9898\u540d\u5373\u53ef. <link rel=\"stylesheet\" href=\"//cdn.jsdelivr.net/npm/docsify/themes/vue.css\"> <link rel=\"stylesheet\" href=\"//cdn.jsdelivr.net/npm/docsify/themes/buble.css\"> <link rel=\"stylesheet\" href=\"//cdn.jsdelivr.net/npm/docsify/themes/dark.css\"> <link rel=\"stylesheet\" href=\"//cdn.jsdelivr.net/npm/docsify/themes/pure.css\"> <link rel=\"stylesheet\" href=\"//cdn.jsdelivr.net/npm/docsify/themes/dolphin.css\">","title":"4.1. \u4e3b\u9898"},{"location":"docker%E5%AD%A6%E4%B9%A0/docsify%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/#42","text":"coverpage\u8bbe\u7f6e\u4e3atrue, \u5c31\u53ef\u4ee5\u6253\u5f00\u5c01\u9762\u529f\u80fd \u7136\u540e\u5728\u9879\u76ee\u6587\u4ef6\u5939, \u65b0\u5efa\u6587\u4ef6 _coverpage.md \u5373\u4e3a\u5c01\u9762. \u6587\u4ef6\u5185\u5bb9\u5982\u4e0b: # Sugar\u7684\u77e5\u8bc6\u5e93 **Author**: Sugar [**Start**](README.md)","title":"4.2. \u5c01\u9762"},{"location":"docker%E5%AD%A6%E4%B9%A0/docsify%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/#43","text":"loadNavbar\u8bbe\u7f6e\u4e3atrue, \u5728\u9879\u76ee\u6587\u4ef6\u5939\u4e2d\u6dfb\u52a0 _navbar.md \u6587\u4ef6, \u5373\u4e3a\u5bfc\u822a\u680f, \u6587\u4ef6\u5185\u5bb9\u5982\u4e0b: - \u5b66\u4e60\u7b14\u8bb0 - \u6b63\u5728\u6574\u7406\u4e2d - \u6b63\u5728\u6574\u7406\u4e2d - \u6b63\u5728\u6574\u7406\u4e2d - \u6b63\u5728\u6574\u7406\u4e2d - \u4e91\u7aef\u90e8\u7f72 - [docker\u642d\u5efa\u601d\u6e90\u7b14\u8bb0](docker\u642d\u5efa\u601d\u6e90\u7b14\u8bb0.md) - [docsify\u642d\u5efa\u8bb0\u5f55](docsify\u642d\u5efa\u8bb0\u5f55.md) - [docker\u7b14\u8bb0](docker\u7b14\u8bb0.md) - \u5de5\u5177\u7f51\u7ad9 - [\u6b63\u5219\u8868\u8fbe\u5f0f30\u5206\u949f\u5165\u95e8](https://deerchao.cn/tutorials/regex/regex.htm) - [Hex\u5b57\u7b26\u8f6c\u6362](https://the-x.cn/encodings/Hex.aspx) - [MathSolver](https://mathsolver.microsoft.com/zh) - [TextTools](https://mytexttools.com/)","title":"4.3. \u5bfc\u822a\u680f"},{"location":"docker%E5%AD%A6%E4%B9%A0/docsify%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/#44","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b, \u4f1a\u6839\u636e\u4f46\u94b1\u6587\u6863\u7684\u6807\u9898\u751f\u6210\u4fa7\u8fb9\u680f\u76ee\u5f55. \u4e5f\u53ef\u4ee5\u81ea\u5df1\u5b9a\u5236\u5316\u4fa7\u8fb9\u680f\u7684\u5185\u5bb9, \u4fee\u6539index.html\u6587\u4ef6 <script> window.$docsify = { loadSidebar: true } </script> <script src=\"//unpkg.com/docsify\"></script> \u8bbe\u7f6eloadSidebar: true\u4e4b\u540e, \u5728\u9879\u76ee\u7684\u6839\u76ee\u5f55\u521b\u5efa _sidebar.md \u6587\u4ef6, \u5185\u5bb9\u683c\u5f0f\u5982\u4e0b: * [home1](home1) * [home2](home2) * [bar](bar/) * [bar/a](bar/a) \u663e\u793a\u9875\u9762\u76ee\u5f55 \u5b9a\u5236\u7684\u4fa7\u8fb9\u680f, \u53ea\u4f1a\u663e\u793a\u9875\u9762\u8fde\u63a5, \u5982\u679c\u60f3\u540c\u65f6\u663e\u793a\u9875\u9762\u8fde\u63a5\u548c\u5f53\u524d\u6587\u6863\u7684\u76ee\u5f55, \u5c31\u9700\u8981\u6dfb\u52a0 subMaxLevel \u5b57\u6bb5. <script> window.$docsify = { loadSidebar: true, subMaxLevel: 3 } </script> <script src=\"//unpkg.com/docsify\"></script>","title":"4.4. \u4fa7\u8fb9\u680f"},{"location":"docker%E5%AD%A6%E4%B9%A0/docsify%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/#5","text":"\u4f7f\u7528docker\u955c\u50cf\u4e3a\u6700\u4f18\u9009\u62e9, \u4f7f\u7528nginx\u662f\u5728\u4e0d\u4e86\u89e3docsify\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u7684\u5c1d\u8bd5 \u4f7f\u7528nginx\u6709\u70b9\u81c3\u80bf, \u9700\u8981\u81ea\u5df1\u642d\u5efaweb\u670d\u52a1 \u4f7f\u7528docsify\u81ea\u5e26\u7684serve\u670d\u52a1\u66f4\u4e3a\u7b80\u5355\u4fbf\u6377 \u53ef\u9009\u4e0b\u5217\u4e09\u79cd\u65b9\u5f0f\u8fdb\u884c\u90e8\u7f72: 1. \u4f7f\u7528 nginx 2. \u4f7f\u7528 github pages 3. \u5236\u4f5c docker \u955c\u50cf","title":"5. \u90e8\u7f72"},{"location":"docker%E5%AD%A6%E4%B9%A0/docsify%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/#51-docker","text":"\u9009\u7528 docker \u955c\u50cf\u90e8\u7f72\u6bd4\u8f83\u65b9\u4fbf, \u8fd9\u91cc\u53ea\u8bb2\u89e3\u6b64\u79cd\u65b9\u5f0f docsify\u6ca1\u6709\u5b98\u65b9\u7684\u955c\u50cf, \u9700\u8981\u4f7f\u7528Dockfile\u81ea\u5df1\u5236\u4f5c\u955c\u50cf\u5e76\u8fd0\u884c. \u9996\u5148\u51c6\u5907\u597d\u521d\u59cb\u6587\u4ef6 index.html README.md \u521b\u5efa Dockfile FROM node:latest MAINTAINER sugar<1144392179@qq.com> WORKDIR /docs RUN npm install -g docsify-cli@latest EXPOSE 3344/tcp # \u6b64\u5904\u66b4\u9732\u7684\u662f\u4e3b\u673a\u7aef\u53e3 ENTRYPOINT docsify serve . \u6784\u5efa\u955c\u50cf docker build -f Dockfile -t sugar/docsify . \u8fd0\u884cdocker\u955c\u50cf docker run -it -p 3344:3000 --name=docsify -v $(pwd):/docs sugar/docsify","title":"5.1. \u4f7f\u7528docker\u955c\u50cf\u8fdb\u884c\u90e8\u7f72"},{"location":"docker%E5%AD%A6%E4%B9%A0/docsify%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/#6-reference","text":"docsify\u5b98\u65b9\u6587\u6863 \u601d\u5426-docsify\u6559\u7a0b","title":"6. reference"},{"location":"docker%E5%AD%A6%E4%B9%A0/yuedu_web/","text":"\u4f5c\u8005: sugar \u8f6c\u8f7d\u8bf7\u8054\u7cfb\u4f5c\u8005(1144392179@qq.com),\u5e76\u8bf4\u660e\u51fa\u5904! \u53c2\u8003 \u3010\u597d\u73a9\u513f\u7684Docker\u9879\u76ee\u3011 10\u5206\u949f\u642d\u5efa\u4e00\u4e2a\u81ea\u5df1\u7684\u7f51\u6587\u9605\u8bfb\u5668 \u5b89\u5353\u7684\u201c\u9605\u8bfb\u201dAPP\u7f51\u9875\u7248 \u9644\u5e26\u4e66\u6e90\uff01 \u5148\u5360\u4e2a\u5751\uff0c\u5177\u4f53\u7684\u642d\u5efa\u6d41\u7a0b\u4e4b\u540e\u603b\u7ed3\u3002 \u6548\u679c\u53ef\u4ee5\u770b \u5bfc\u822a\u680f \uff1a\u6478\u9c7c\u5fc5\u5907\u3002","title":"docker\u5b9e\u6218:\u9605\u8bfbweb\u7aef"},{"location":"docker%E5%AD%A6%E4%B9%A0/yuedu_web/#_1","text":"\u3010\u597d\u73a9\u513f\u7684Docker\u9879\u76ee\u3011 10\u5206\u949f\u642d\u5efa\u4e00\u4e2a\u81ea\u5df1\u7684\u7f51\u6587\u9605\u8bfb\u5668 \u5b89\u5353\u7684\u201c\u9605\u8bfb\u201dAPP\u7f51\u9875\u7248 \u9644\u5e26\u4e66\u6e90\uff01 \u5148\u5360\u4e2a\u5751\uff0c\u5177\u4f53\u7684\u642d\u5efa\u6d41\u7a0b\u4e4b\u540e\u603b\u7ed3\u3002 \u6548\u679c\u53ef\u4ee5\u770b \u5bfc\u822a\u680f \uff1a\u6478\u9c7c\u5fc5\u5907\u3002","title":"\u53c2\u8003"}]}